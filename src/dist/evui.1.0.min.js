/**Copyright (c) 2025 Richard H Stannard

This source code is licensed under the MIT license found in the
LICENSE file in the root directory of this source tree.*/
EVUI={};EVUI.Modules={};EVUI.Constructors={};$evui={};EVUI.Modules.Binding={};EVUI.Modules.Binding.Dependencies={Core:Object.freeze({required:!0}),DomTree:Object.freeze({required:!0}),Diff:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0}),Dom:Object.freeze({required:!0}),Observers:Object.freeze({required:!0}),Http:Object.freeze({required:!1})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Binding.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumerable:!0})}();Object.freeze(EVUI.Modules.Binding.Dependencies);EVUI.Modules.Binding.Constants={};EVUI.Modules.Binding.Constants.Attr_HtmlContentKey="evui-binder-html-key";EVUI.Modules.Binding.Constants.Attr_HtmlContentUrl="evui-binder-html-src";EVUI.Modules.Binding.Constants.Attr_BoundObj="evui-binder-source";EVUI.Modules.Binding.Constants.Attr_Mode="evui-binder-mode";EVUI.Modules.Binding.Constants.Attr_BindingTemplate="evui-binder-template";EVUI.Modules.Binding.Constants.Attr_ElementBindingTemplate="evui-binder-element-template";EVUI.Modules.Binding.Constants.Event_OnBind="bind";EVUI.Modules.Binding.Constants.Event_OnSetHtmlContent="sethtmlcontent";EVUI.Modules.Binding.Constants.Event_OnSetBindings="setbindings";EVUI.Modules.Binding.Constants.Event_OnBindHtmlContent="bindhtmlcontent";EVUI.Modules.Binding.Constants.Event_OnBindChildren="bindchildren";EVUI.Modules.Binding.Constants.Event_OnBoundChildren="boundchildren";EVUI.Modules.Binding.Constants.Event_OnBound="bound";EVUI.Modules.Binding.Constants.Job_BeginBind="job.beginbind";EVUI.Modules.Binding.Constants.Job_GetHtmlContent="job.gethtmlcontent";EVUI.Modules.Binding.Constants.Job_GetBindings="job.getbindings";EVUI.Modules.Binding.Constants.Job_BindHtmlContent="job.bindhtmlcontent";EVUI.Modules.Binding.Constants.Job_BindChildren="job.bindchildren";EVUI.Modules.Binding.Constants.Job_ProcessChildren="job.processchildren";EVUI.Modules.Binding.Constants.Job_Inject="job.inject";EVUI.Modules.Binding.Constants.Job_FinishBinding="job.finishbinding";EVUI.Modules.Binding.Constants.StepPrefix="evui.binder";EVUI.Modules.Binding.Constants.Fn_BindingCallback=function(){};EVUI.Modules.Binding.Constants.Fn_SearchBindings=function(){};EVUI.Modules.Binding.Constants.Fn_SearchHtmlContent=function(){};EVUI.Modules.Binding.Constants.Fn_SearchBindingTemplates=function(){};EVUI.Modules.Binding.Constants.Fn_BindingEventHandler=function(){};Object.freeze(EVUI.Modules.Binding.Constants);EVUI.Modules.Binding.BindingController=function(n){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Binding.Dependencies);var t=this,oi=0,si=/[+^?.*$(){}|\[\]\\]/g,iu=0,ru=0,uu=0,fu=0,eu=0,et={},ou=25,su="@eventui&"+EVUI.Modules.Core.Utils.makeGuid()+"&",e=EVUI.Modules.Core.Utils.getHashCode(EVUI.Modules.Core.Utils.makeGuid()).toString(36).replace(".",""),pt=e.length,wt=new EVUI.Modules.EventStream.BubblingEventManager,bt=[],o=[],a=[],u=n,hi=null,k={};this.getHtmlContent=function(n,t){var r=typeof n,u,i;if(r!=="string"&&r!=="function")throw Error("String or function expected.");var e=o.length,s=o.slice(),f=[];for(u=0;u<e;u++)if(i=s[u],r==="string"){if(i.item.key===n)return i.item}else if(n(i.item)===!0){if(t===!0)return i.item;f.push(i.item)}return r==="function"&&t!==!0?f:null};this.addHtmlContent=function(n,t,i){var r=pe(n,t,i);return r.item};this.removeHtmlContent=function(n){return typeof n=="object"&&(n=n.key),we(n)};this.bind=function(n,t,i){if(n==null)throw Error("String or Object expected.");typeof t=="function"&&typeof i!="function"&&(i=t,t=null);typeof i!="function"&&(i=function(){});var r=ut(n);if(r==null)throw Error("Failed to resolve binding.");t==null&&(t=n);dt(r,t,null,i)};this.bindAsync=function(n,i){return new Promise(function(r){t.bind(n,i,function(n){r(n)})})};this.addBindingTemplate=function(n){var i,t,n;if(n==null||typeof n!="object")throw Error("Object expected.");if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.templateName)===!0)throw Error("BindingTemplate name must be a non-whitespace string.");if(i=tt(n.templateName),i!=null)throw Error('A BindingTemplate with the name "'+n.templateName+'" already exists.');return t=new ko,t.templateName=n.templateName,n=b(n,null,t),a.push(n),n};this.removeBindingTemplate=function(n){var t,i;return n==null?!1:(typeof n=="object"&&(n=n.templateName),t=tt(n),t!=null&&(i=a.indexOf(t),i!==-1))?(a.splice(x,1),!0):!1};this.getBindingTemplate=function(n,t){var r=typeof n,u,i;if(r!=="string"&&r!=="function")throw Error("String or function expected.");var e=a.length,o=a.slice(),f=[];for(u=0;u<e;u++)if(i=o[u],r==="string"){if(i.templateName===n)return i}else if(n(i)===!0){if(t===!0)return i;f.push(i)}return r==="function"&&t!==!0?f:null};this.addEventListener=function(n,t,i){return EVUI.Modules.Core.Utils.isObject(i)===!1&&(i=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),i.eventType=EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent,wt.addEventListener(n,t,i)};this.removeEventListener=function(n,t){return wt.removeEventListener(n,t)};this.onBind=null;this.onSetHtmlContent=null;this.onSetBindings=null;this.onBindHtmlContent=null;this.onBindChildren=null;this.onChildrenBound=null;this.onBound=null;var hu=function(){hi=new ei;(u==null||typeof u!="object")&&(u=new EVUI.Modules.Binding.BindingControllerServices);(u.diffController==null||typeof u.diffController!="object")&&(u.diffController=EVUI.Modules.Diff.Comparer);(u.domTreeConverter==null||typeof u.domTreeConverter!="object")&&(u.domTreeConverter=EVUI.Modules.DomTree.Converter);(u.httpManager==null||typeof u.httpManager!="object")&&Object.defineProperty(u,"httpManager",{get:function(){return EVUI.Modules.Http.Http},configurable:!1,enumerable:!0})},v=function(n){var i,r,t;if(n.disposing===!0)return!1;for(n.disposing=!0,n.completionState=EVUI.Modules.Binding.BindingCompletionState.Disposed,i=n.currentState.childBindingHandles.length,r=0;i>0;)t=n.currentState.childBindingHandles[r],(t.disposing===!0||v(t)===!0)&&(i--,t.disposing===!0&&r++);return n.progressState===EVUI.Modules.Binding.BindingProgressStateFlags.Idle?(kt(n),!0):!1},kt=function(n){var u,t,i,r;if(n.disposing!==!1){for(n.oldState=null,n.pendingState=null,u=n.currentState.boundContent!=null?n.currentState.boundContent.length:0,t=0;t<u;t++)i=n.currentState.boundContent[t],i.isConnected===!0&&i.remove();n.currentState.parentBindingHandle!=null&&(r=n.currentState.parentBindingHandle.currentState.childBindingHandles.indexOf(n),r!==-1&&n.currentState.parentBindingHandle.currentState.childBindingHandles.splice(r,1),EVUI.Modules.Core.Utils.isArray(n.currentState.parentBindingHandle.currentState.source)===!1&&n.currentState.element.remove());cu(n);n.dispatchHandles=[];n.newStateBound=!1;n.oldStateBound=!1;n.progressState=EVUI.Modules.Binding.BindingProgressStateFlags.Idle;n.templateName=null;n.currentState=new l;n.disposing=!1}},cu=function(n){for(var i=n.dispatchHandles.length,t=0;t<i;t++)n.dispatchHandles[t].dispose()},dt=function(n,t,i,r){var a=typeof t,y=typeof r,f=new EVUI.Modules.Binding.BindArgs,e=n.currentState,s=n.currentState,l,u,o;if(a==="function")typeof r!="function"&&(r=t);else if(a==="object"&&t!=null)if(EVUI.Modules.Core.Utils.instanceOf(t,EVUI.Modules.Binding.BindArgs)===!1){var h=t.source!=null?t.source:t.bindingSource,v=t.element!=null?t.element:t.bindingTarget,c=t.bindingContext;v===undefined&&h===undefined&&c===undefined?f.bindingSource=t:(h!==undefined&&(f.bindingSource=h),l=at(v),l!=null&&(f.bindingTarget=l),c!==undefined&&(f.bindingContext=c));f.bindingContext=t.bindingContext}else f=EVUI.Modules.Core.Utils.shallowExtend(f,t);n.pendingState!=null&&n.pendingState.elementSet===!0&&(e=n.pendingState);n.pendingState!=null&&n.pendingState.sourceSet===!0&&(s=n.pendingState);f.bindingTarget==null&&(e===n.currentState&&e.element==null&&e.elementSet===!1?n.oldState!=null&&n.oldState.elementSet===!0&&(f.bindingTarget=n.oldState.element):f.bindingTarget=e.element);f.bindingSource==null&&(s===n.currentState&&e.source==null&&e.sourceSet===!1?n.oldState!=null&&n.oldState.sourceSet===!0&&(f.bindingSource=n.oldState.source):f.bindingSource=s.source);y!=="function"&&(r=function(){});u=new wr;u.bindingArgs=f;u.bindingHandle=n;u.parentSession=i;u.sessionMode=ft.Bind;i!=null?(i.childSessions.push(u),i.bindingHandle.oldStateBound===!1&&(u.maintainCurrentState=!0),i.context!=null&&(i.bindingHandle.binding.options.shareContextMode===EVUI.Modules.Binding.ShareContextMode.Clone?u.context=typeof i.context=="object"?EVUI.Modules.Core.Utils.deepExtend(u.context,i.context):i.context:i.bindingHandle.binding.options.shareContextMode===EVUI.Modules.Binding.ShareContextMode.ShareReference&&(u.context=i.context))):u.context=u.bindingArgs.bindingContext;o=new br;o.session=u;o.callback=r;o.id=oi++;u.callbacks.push(o);wi(u);li(u)},ci=function(n,t,i,r){var u,f;typeof t=="function"&&r==null&&(r=t,t=null);typeof r!="function"&&(r=function(){});u=new wr;u.bindingArgs=new EVUI.Modules.Binding.BindArgs;u.bindingArgs.bindingSource=n.pendingState!=null&&n.pendingState.sourceSet===!0?n.pendingState.source:n.currentState.source;u.bindingArgs.bindingTarget=n.pendingState!=null&&n.pendingState.elementSet===!0?n.pendingState.element:n.currentState.element;t!=null&&typeof t=="object"&&(t.bindingSource===undefined&&t.bindingContext===undefined?u.bindingArgs.bindingSource=t:(t.bindingSource!==undefined&&(u.bindingArgs.bindingSource=t.bindingSource),t.bindingContext!==undefined&&(u.bindingArgs.bindingContext=t.bindingContext)));u.bindingHandle=n;u.parentSession=i;u.sessionMode=ft.Update;u.bindingHandle.canceledDuringReBind===!0&&(u.sessionMode=ft.Bind);i!=null?(i.childSessions.push(u),i.bindingHandle.oldStateBound===!1&&(u.maintainCurrentState=!0),i.context!=null&&(i.bindingHandle.binding.options.shareContextMode===EVUI.Modules.Binding.ShareContextMode.Clone?u.context=typeof i.context=="object"?EVUI.Modules.Core.Utils.deepExtend(u.context,i.context):i.context:i.bindingHandle.binding.options.shareContextMode===EVUI.Modules.Binding.ShareContextMode.ShareReference&&(u.context=i.context))):u.context=u.bindingArgs.bindingContext;f=new br;f.session=u;f.callback=r;f.id=oi++;u.callbacks.push(f);wi(u);li(u)},li=function(n){var i=null,h=!1,t=hi,c,u,e,o,s,r,f;n.parentSession!=null&&(c=k[n.parentSession.batchId],t=c.batchContainer);t.numChildContainers===0?(r=new ei,r.parentContainer=t,t.childContainers=[],t.numChildContainers=t.childContainers.push(r),t=r):(u=t.childContainers[t.numChildContainers-1],e=u.batches[u.numBatches-1],e!=null?(o=e.sessions[e.numSessions-1],s=o==null?1:n.sessionId-o.sessionId,o!=null&&s!==1&&s!==-1?(r=new ei,r.parentContainer=t,t.numChildContainers=t.childContainers.push(r),t=r):t=u):t=u==null?t.childContainers[0]:u);t.numBatches===0?(i=new tu,i.batchContainer=t,k[i.id]=i,t.currentBatch=i,t.numBatches=t.batches.push(i)):i=t.currentBatch;n.batchId=i.id;i.numSessions=i.sessions.push(n);h=t.numBatches<=1;i.numSessions>=ou&&(f=new tu,f.batchContainer=t,k[f.id]=f,t.currentBatch=f,t.numBatches=t.batches.push(f));h===!0&&pi(n)},ai=function(n){var t,i,u,r;for(delete k[n.id],t=n.batchContainer,i=t.batches.shift();i!=null&&i.id===n.id;)i=t.batches.shift();if(t.numBatches=t.batches.length,i==null)t.currentBatch=null,t.parentContainer!=null&&(u=t.parentContainer.childContainers.indexOf(t),u>-1&&(t.parentContainer.childContainers.splice(u,1),t.parentContainer.numChildContainers--));else if(i.numSessions===0)ai(i);else for(r=0;r<i.numSessions;r++)pi(i.sessions[r])},lu=function(n){for(var i,r,u=[],f=k[n.batchId].sessions,e=f.length,t=0;t<e;t++)i=f[t],i.sessionId!==n.sessionId&&(r=au(n,i),r!=null&&u.push(r));return u},au=function(n,t){var i=null,r=yt.None;return(t.bindingHandle.id===n.bindingHandle.id&&(r|=yt.SameBinding),n.bindingArgs.bindingTarget!=null&&n.bindingArgs.bindingTarget===t.bindingArgs.bindingTarget&&vi(n,t)===!1&&vi(t,n)===!1&&(r|=yt.SameElement),r>0)?(i=new co,i.session=t,i.flags=r,i):null},vi=function(n,t){if(n.parentSession!=null){if(n.parentSession.isArray===!1||n.parentSession.bindingHandle.oldStateBound===!1||n.parentSession.bindingHandle.oldState.childBindingHandles.length===0)return!1;if(n.parentSession.bindingHandle.oldState.childBindingHandles[0].element===t.bindingHandle.element)return!0}else if(n.isArray===!0){if(n.bindingHandle.oldStateBound===!1||n.bindingHandle.oldState.childBindingHandles.length===0)return!1;if(n.bindingHandle.oldState.childBindingHandles[0].element===t.bindingHandle.element)return!0}return!1},vu=function(n){var t,i;if(n.maintainCurrentState===!0){n.isArray=EVUI.Modules.Core.Utils.isArray(n.bindingHandle.currentState.source);n.maintainCurrentState=!1;return}t=new l;n.bindingHandle.pendingState!=null?(i=n.bindingHandle.pendingState,i.normalizedPath!=null&&(t.normalizedPath=i.normalizedPath),i.parentBindingHandle!=null&&(t.parentBindingHandle=i.parentBindingHandle),i.parentBindingKey!=null&&(t.parentBindingKey=i.parentBindingKey),i.parentBindingPath!=null&&(t.parentBindingPath=i.parentBindingPath)):n.bindingHandle.currentState!=null&&n.bindingHandle.newStateBound===!0&&(EVUI.Modules.Core.Utils.shallowExtend(t,n.bindingHandle.currentState,["stateId","boundContent","boundProperties","childBindingHandles","sourceSet","htmlContentSet","elementSet","sourceObserver","element"]),n.bindingHandle.currentState.boundContent!=null&&(t.boundContent=n.bindingHandle.currentState.boundContent.slice()),n.bindingHandle.currentState.boundProperties!=null&&(t.boundProperties=n.bindingHandle.currentState.boundProperties.slice()));t.element=n.bindingArgs.bindingTarget;t.source=n.bindingArgs.bindingSource;t.htmlContent=n.bindingHandle.pendingState!=null&&n.bindingHandle.pendingState.htmlContentSet===!0?n.bindingHandle.pendingState.htmlContent:n.bindingHandle.currentState.htmlContentSet===!0?n.bindingHandle.currentState.htmlContent:n.bindingHandle.oldState!=null&&n.bindingHandle.oldState.htmlContentSet===!0?n.bindingHandle.oldState.htmlContent:n.bindingHandle.currentState.htmlContent;n.rollbackState=n.bindingHandle.oldState;n.rollbackPendingState=n.bindingHandle.pendingState;n.rollbackStateBound=n.bindingHandle.oldStateBound;n.bindingHandle.oldState=n.bindingHandle.currentState;n.bindingHandle.currentState=t;n.bindingHandle.pendingState=null;n.bindingHandle.oldStateBound=n.bindingHandle.newStateBound;n.bindingHandle.newStateBound=!1;n.isArray=EVUI.Modules.Core.Utils.isArray(t.source);n.parentSession!=null&&(n.bindingHandle.currentState.parentBindingHandle=n.parentSession.bindingHandle);n.bindingHandle.completionState=EVUI.Modules.Binding.BindingCompletionState.Executing},yi=function(n){var u,f,r,t,i,e;if(EVUI.Modules.Core.Utils.hasFlag(n.bindingHandle.progressState,EVUI.Modules.Binding.BindingProgressStateFlags.Injected)!==!0&&n.cancel!==!0&&(n.bindingHandle.oldState!=null&&(n.bindingHandle.currentState=n.bindingHandle.oldState,n.bindingHandle.newStateBound=n.bindingHandle.oldStateBound),n.rollbackState!=null&&(n.bindingHandle.oldState=n.rollbackState,n.bindingHandle.oldStateBound=!0),n.bindingHandle.pendingState=n.rollbackPendingState,EVUI.Modules.Core.Utils.hasFlag(n.bindingHandle.progressState,EVUI.Modules.Binding.BindingProgressStateFlags.GotHtmlContent)===!0&&n.shouldReBind===!0&&(n.bindingHandle.canceledDuringReBind=!0),EVUI.Modules.Core.Utils.hasFlag(n.bindingHandle.progressState,EVUI.Modules.Binding.BindingProgressStateFlags.GotBoundProperties)===!0))for(u=n.bindingHandle.dispatchHandles.length,f=n.rollbackDispatchHandles.length,r=0;r<f;r++)for(t=n.rollbackDispatchHandles[r],EVUI.Modules.Binding.BindingController.BoundEvents[t.hashKey]=t,i=0;i<u;i++)if(e=n.bindingHandle.dispatchHandles[i],e.hashKey===t.hashKey){n.bindingHandle.dispatchHandles[i]=t;break}},pi=function(n){var r,u,f,i,t;for(n.bindingHandle.progressState=EVUI.Modules.Binding.BindingProgressStateFlags.Queued,n.bindingHandle.completionState=EVUI.Modules.Binding.BindingCompletionState.Queued,n.bindingArgs.bindingTarget=at(n.bindingArgs.bindingTarget),typeof n.bindingArgs.bindingTarget=="string"&&(r=null,r=n.bindingHandle.binding.parentBinding!=null&&n.bindingHandle.options.scopedCSSSelectors!==!1?new EVUI.Modules.Dom.DomHelper(n.bindingArgs.bindingTarget,n.bindingHandle.binding.parentBinding.element):new EVUI.Modules.Dom.DomHelper(n.bindingArgs.bindingTarget),n.bindingArgs.bindingTarget=r.elements[0]),u=lu(n),f=u.length,i=0;i<f;i++)t=u[i],t.session.cancel===!1&&(n.callbacks=t.session.callbacks.concat(n.callbacks),t.session.cancel=!0,t.session.callbacks=[]);n.eventStream.execute()},wi=function(n){n.eventStream=new EVUI.Modules.EventStream.EventStream;n.eventStream.eventState=n.context;n.eventStream.bubblingEvents=[n.bindingHandle.wrapper.bubblingEvents,wt];n.eventStream.context=n.bindingHandle.binding;n.eventStream.extendSteps=!1;n.eventStream.processInjectedEventArgs=function(t){var i=new EVUI.Modules.Binding.BinderEventArgs(n);return i.cancel=t.cancel,i.context=t.state,i.eventType=t.key,i.eventName=t.name,i.pause=t.pause,i.resume=t.resume,i.stopPropagation=t.stopPropagation,i};n.eventStream.processReturnedEventArgs=function(t){n.eventStream.eventState=t.context};n.eventStream.onCancel=function(){n.bindingHandle.completionState=EVUI.Modules.Binding.BindingCompletionState.Canceled;yi(n);gt(n);n.eventStream.seek(EVUI.Modules.Binding.Constants.Job_FinishBinding)};n.eventStream.onError=function(){n.bindingHandle.completionState=EVUI.Modules.Binding.BindingCompletionState.Failed;yi(n);gt(n);n.eventStream.seek(EVUI.Modules.Binding.Constants.Job_FinishBinding)};n.eventStream.onComplete=function(){var t=k[n.batchId];t.numComplete++;t.numComplete>=t.numSessions&&ai(t)};yu(n);pu(n);bu(n);du(n);nf(n);rf(n);ff(n);ef(n);hf(n)},c=function(n){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw Error("Missing jobName");return EVUI.Modules.Binding.Constants.StepPrefix+"."+n},y=function(n){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw Error("Missing eventName");return EVUI.Modules.Binding.Constants.StepPrefix+"."+n},yu=function(n){var i=c(EVUI.Modules.Binding.Constants.Job_BeginBind),r=y(EVUI.Modules.Binding.Constants.Event_OnBind);n.bindingHandle.currentState.parentBindingHandle!=null&&n.bindingHandle.currentState.parentBindingHandle.options.suppressChildEvents===!0?n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Job_BeginBind,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){bi(n,!0,t)}}):(n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Job_BeginBind,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){bi(n,!0,t)}}),n.eventStream.addStep({name:r,key:EVUI.Modules.Binding.Constants.Event_OnBind,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(f(n,t)!==!1)return typeof n.bindingHandle.binding.onBind=="function"?(t.reBinding=n.bindingHandle.oldStateBound,n.bindingHandle.binding.onBind.call(this,t)):void 0}}),n.eventStream.addStep({name:r,key:EVUI.Modules.Binding.Constants.Event_OnBind,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(i){if(f(n,i)!==!1)return typeof t.onBind=="function"?(i.reBinding=n.bindingHandle.oldStateBound,t.onBind.call(t,i)):void 0}}))},bi=function(n,t,i){if(n.cancel===!0||n.bindingHandle.disposing===!0)return i.cancel();if(f(n,i)==!1)return i.resolve();if(n.bindingArgs.bindingSource==null)return v(n.bindingHandle),i.cancel();t===!0&&vu(n);i.resolve()},pu=function(n){var r=c(EVUI.Modules.Binding.Constants.Job_GetHtmlContent),i=y(EVUI.Modules.Binding.Constants.Event_OnSetHtmlContent);(n.eventStream.addStep({name:r,key:EVUI.Modules.Binding.Constants.Job_GetHtmlContent,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){wu(n,t)}}),n.bindingHandle.currentState.parentBindingHandle==null||n.bindingHandle.currentState.parentBindingHandle.options.suppressChildEvents!==!0)&&(n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnSetHtmlContent,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(f(n,t)!==!1)return typeof n.bindingHandle.binding.onSetHtmlContent=="function"?n.bindingHandle.binding.onSetHtmlContent.call(this,t):void 0}}),n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnSetHtmlContent,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(i){if(f(n,i)!==!1)return typeof t.onSetHtmlContent=="function"?t.onSetHtmlContent.call(t,i):void 0}}))},wu=function(n,t){if(f(n,t)==!1)return t.resolve();rr(n,function(i){EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i)===!1&&(n.bindingHandle.currentState.htmlContent=i);t.resolve()})},bu=function(n){var r=c(EVUI.Modules.Binding.Constants.Job_GetBindings),i=y(EVUI.Modules.Binding.Constants.Event_OnSetBindings);(n.eventStream.addStep({name:r,key:EVUI.Modules.Binding.Constants.Job_GetBindings,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){ku(n,t)}}),n.bindingHandle.currentState.parentBindingHandle==null||n.bindingHandle.currentState.parentBindingHandle.options.suppressChildEvents!==!0)&&(n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnSetBindings,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(f(n,t)!==!1)return typeof n.bindingHandle.binding.onSetBindings=="function"?n.bindingHandle.binding.onSetBindings.call(this,t):void 0}}),n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnSetBindings,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(i){if(f(n,i)!==!1)return typeof t.onSetBindings=="function"?t.onSetBindings.call(t,i):void 0}}))},ku=function(n,t){if(f(n,t)==!1)return t.resolve();if(n.bindingHandle.progressState|=EVUI.Modules.Binding.BindingProgressStateFlags.GotHtmlContent,n.bindingHandle.oldStateBound===!0&&(n.shouldReBind=re(n),n.shouldReBind===!1))return n.bindingHandle.oldState.source===n.bindingHandle.currentState.source&&n.bindingHandle.oldStateBound===!1?n.bindingHandle.currentState.sourceObserver=d(n):n.bindingHandle.oldState.source===n.bindingHandle.currentState.source?(n.bindingHandle.currentState.sourceObserver=n.bindingHandle.oldState.sourceObserver,n.bindingHandle.currentState.arrayObserver=n.bindingHandle.oldState.arrayObserver):n.bindingHandle.currentState.sourceObserver=d(n),n.bindingHandle.oldState.boundProperties!=null&&(n.bindingHandle.currentState.boundProperties=n.bindingHandle.oldState.boundProperties.map(function(n){var t=new EVUI.Modules.Binding.BoundProperty(n.path);return t.value=n.value,t}),n.originalBoundProps=n.bindingHandle.oldState.boundProperties),t.resolve();ie(n,function(i){i==null?t.reject("Failed to get boundProperties due to a failure to get valid htmlContent."):(n.originalBoundProps=i,n.bindingHandle.currentState.boundProperties=i.map(function(n){var t=new EVUI.Modules.Binding.BoundProperty(n.path);return t.value=n.value,t}),t.resolve())})},du=function(n){var r=c(EVUI.Modules.Binding.Constants.Job_BindHtmlContent),i=y(EVUI.Modules.Binding.Constants.Event_OnBindHtmlContent);(n.eventStream.addStep({name:r,key:EVUI.Modules.Binding.Constants.Job_BindHtmlContent,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){gu(n,t)}}),n.bindingHandle.currentState.parentBindingHandle==null||n.bindingHandle.currentState.parentBindingHandle.options.suppressChildEvents!==!0)&&(n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBindHtmlContent,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(f(n,t)!==!1)return typeof n.bindingHandle.binding.onBindHtmlContent=="function"?n.bindingHandle.binding.onBindHtmlContent.call(this,t):void 0}}),n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBindHtmlContent,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(i){if(f(n,i)!==!1)return typeof t.onBindHtmlContent=="function"?t.onBindHtmlContent.call(t,i):void 0}}))},gu=function(n,t){var r,i,e,o;if(f(n,t)==!1)return t.resolve();n.bindingHandle.progressState|=EVUI.Modules.Binding.BindingProgressStateFlags.GotBoundProperties;r=ht(n);n.bindingHandle.currentState.boundProperties=ue(n,r);r===!1?n.bindingHandle.oldStateBound===!0&&n.shouldReBind===!1?(n.bindingHandle.currentState.mergedHtmlContent=n.bindingHandle.oldState.mergedHtmlContent,n.bindingHandle.currentState.boundContentTree=n.bindingHandle.oldState.boundContentTree):(i=n.bindingHandle.htmlContent,i==null&&(i=n.bindingHandle.currentState.htmlContent),e=de(i,n),o=io(n,n.bindingHandle.currentState.htmlContent,n.bindingHandle.currentState.boundProperties,e),n.bindingHandle.currentState.mergedHtmlContent=o,n.bindingHandle.currentState.boundContentTree=te(n,o,e)):n.bindingHandle.oldStateBound===!0&&n.shouldReBind===!1?(n.bindingHandle.currentState.mergedHtmlContent=n.bindingHandle.oldState.htmlContent,n.bindingHandle.currentState.boundContentTree=n.bindingHandle.oldState.boundContentTree):(n.bindingHandle.currentState.mergedHtmlContent=n.bindingHandle.currentState.htmlContent,n.bindingHandle.currentState.boundContentTree=u.domTreeConverter.toDomTreeElement(document.createDocumentFragment(),nt(n.bindingHandle)));t.resolve()},nf=function(n){var r=c(EVUI.Modules.Binding.Constants.Job_BindChildren),i=y(EVUI.Modules.Binding.Constants.Event_OnBindChildren);(n.eventStream.addStep({name:r,key:EVUI.Modules.Binding.Constants.Job_BindChildren,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){tf(n,t)}}),(n.bindingHandle.currentState.parentBindingHandle==null||n.bindingHandle.currentState.parentBindingHandle.options.suppressChildEvents!==!0)&&n.bindingHandle.options.recursive===!0)&&(n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBindChildren,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(f(n,t)!==!1)return typeof n.bindingHandle.binding.onBindChildren=="function"?n.bindingHandle.binding.onBindChildren.call(this,t):void 0}}),n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBindChildren,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(i){if(f(n,i)!==!1)return typeof t.onBindChildren=="function"?t.onBindChildren.call(t,i):void 0}}))},tf=function(n,t){var i,r;if(f(n,t)==!1||(n.bindingHandle.progressState|=EVUI.Modules.Binding.BindingProgressStateFlags.BoundHtmlContent,n.bindingHandle.options.recursive!==!0))return t.resolve();i=ht(n);n.bindingHandle.oldStateBound===!0&&i===!1?oe(n):i===!0?n.bindingHandle.oldStateBound===!1?n.bindingHandle.currentState.childBindingHandles=ee(n):se(n):(r=ri(n),n.bindingHandle.currentState.childBindingHandles=he(n,r));t.resolve()},rf=function(n){n.eventStream.addStep({name:c(EVUI.Modules.Binding.Constants.Job_ProcessChildren),key:EVUI.Modules.Binding.Constants.Job_ProcessChildren,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){uf(n,t)}})},uf=function(n,t){var u,e,o,r,s,h,i;if(f(n,t)==!1||(n.bindingHandle.progressState|=EVUI.Modules.Binding.BindingProgressStateFlags.GotChildren|EVUI.Modules.Binding.BindingProgressStateFlags.BindingChildren,u=ce(n),e=u.length,n.bindingHandle.currentState.childBindingHandles=u,e===0))return t.resolve();if(n.sessionMode===ft.Update){if(o=ae(n),r=o.length,r===0)return t.resolve();for(s=[],h=function(n){var i=s.push(n);if(i===r)return t.resolve()},i=0;i<r;i++)ci(o[i],null,n,function(n){h(n)})}else{var s=[],h=function(n){var i=s.push(n);if(i===e)return t.resolve()},c=n.bindingHandle.currentState.childBindingHandles.length;for(i=0;i<c;i++)dt(n.bindingHandle.currentState.childBindingHandles[i],null,n,function(n){h(n)})}},ff=function(n){var i=y(EVUI.Modules.Binding.Constants.Event_OnBoundChildren);n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBindChildren,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(n.bindingHandle.progressState|=EVUI.Modules.Binding.BindingProgressStateFlags.BoundChildren,f(n,t)!==!1)return n.bindingHandle.currentState.childBindingHandles.length===0?void 0:n.bindingHandle.currentState.parentBindingHandle!=null&&n.bindingHandle.currentState.parentBindingHandle.options.suppressChildEvents===!0||n.bindingHandle.options.recursive!==!0?void 0:typeof n.bindingHandle.binding.onChildrenBound=="function"?n.bindingHandle.binding.onChildrenBound.call(this,t):void 0}});n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBindChildren,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(i){if(f(n,i)!==!1)return n.bindingHandle.currentState.childBindingHandles.length===0?void 0:typeof t.onChildrenBound=="function"?t.onChildrenBound.call(t,i):void 0}})},ef=function(n){if(n.eventStream.addStep({name:c(EVUI.Modules.Binding.Constants.Job_Inject),key:EVUI.Modules.Binding.Constants.Job_Inject,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){sf(n,t)}}),n.bindingHandle.currentState.parentBindingHandle==null||n.bindingHandle.currentState.parentBindingHandle.options.suppressChildEvents!==!0){var i=y(EVUI.Modules.Binding.Constants.Event_OnBound);n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBound,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){return n.cancel===!0||n.bindingHandle.disposing===!0?t.cancel():typeof n.bindingHandle.binding.onBound=="function"?n.bindingHandle.binding.onBound.call(this,t):void 0}});n.eventStream.addStep({name:i,key:EVUI.Modules.Binding.Constants.Event_OnBound,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(i){return n.cancel===!0||n.bindingHandle.disposing===!0?i.cancel():typeof t.onBound=="function"?t.onBound.call(t,i):void 0}})}},sf=function(n,t){if(f(n,t)==!1)return t.resolve();lf(n);tr(n.bindingHandle.currentState.boundContentTree);n.bindingHandle.progressState|=EVUI.Modules.Binding.BindingProgressStateFlags.Injected;n.bindingHandle.newStateBound=!0;t.resolve()},hf=function(n){n.eventStream.addStep({name:c(EVUI.Modules.Binding.Constants.Job_FinishBinding),key:EVUI.Modules.Binding.Constants.Job_FinishBinding,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){cf(n,t)}})},cf=function(n,t){var u=[],e=function(n){var t=function(){return n.session.bindingHandle.progressState=EVUI.Modules.Binding.BindingProgressStateFlags.Idle,n.session.bindingHandle.completionState===EVUI.Modules.Binding.BindingCompletionState.Executing&&(n.session.bindingHandle.completionState=EVUI.Modules.Binding.BindingCompletionState.Success),n.session.bindingHandle.disposing===!0&&kt(n.session.bindingHandle),n.callback(n.session.bindingHandle.binding)};u.push(t)},f,i,r;for(n.callbacks.sort(function(n,t){return n.id-t.id}),f=n.callbacks.length,i=0;i<f;i++)e(n.callbacks[i]);if(u.length===0)return n.bindingHandle.progressState=EVUI.Modules.Binding.BindingProgressStateFlags.Idle,n.bindingHandle.completionState===EVUI.Modules.Binding.BindingCompletionState.Executing&&(n.bindingHandle.completionState=EVUI.Modules.Binding.BindingCompletionState.Success),n.bindingHandle.disposing===!0&&kt(n.bindingHandle),ki(n),t.resolve();r=new EVUI.Modules.Core.AsyncSequenceExecutionArgs;r.forceCompletion=!0;r.functions=u;EVUI.Modules.Core.AsyncSequenceExecutor.execute(r,function(){ki(n);t.resolve()})},f=function(n,t){var i=n.eventStream.isWorking();if(n.cancel===!0||n.bindingHandle.disposing===!0)return n.bindingHandle.disposing===!0&&(n.cancel=!0),i===!0&&(t!=null?t.cancel():n.eventStream.cancel()),!1;if(n.bindingHandle.currentState.parentBindingHandle!=null&&ye(n)&&i===!0)throw Error("Child Binding's source was a circular reference to one of its parent Binding's sources.");return!0},gt=function(n){for(var t,r=n.childSessions,i=0;i<r;i++)t=n.childSessions[i],t.cancel=!0,t.childSessions.length>0&&gt(t)},ki=function(n){n.cancel!==!0&&(n.bindingHandle.oldState=null,n.bindingHandle.pendingState=null,n.bindingHandle.currentState.boundContentFragment=null)},lf=function(n){var u=n.bindingHandle.binding.insertionMode,i=n.bindingHandle.binding.bindingMode,t;if(i===EVUI.Modules.Binding.BindingMode.Merge)n.bindingHandle.oldStateBound===!0?n.shouldReBind===!0?(di(n),EVUI.Modules.Core.Utils.isOrphanedNode(n.bindingHandle.oldState.element)===!1&&(n.bindingHandle.currentState.element=n.bindingHandle.oldState.element)):(n.bindingHandle.currentState.boundContent=n.bindingHandle.currentState.childBindingHandles.length===0?n.bindingHandle.oldState.boundContent.slice():n.isArray===!0?rt(n):n.bindingHandle.oldState.boundContent.slice(),EVUI.Modules.Core.Utils.isOrphanedNode(n.bindingHandle.oldState.element)===!1&&(n.bindingHandle.currentState.element=n.bindingHandle.oldState.element)):n.isArray===!0?n.bindingHandle.currentState.boundContent=rt(n):(n.bindingHandle.currentState.boundContentFragment==null&&(n.bindingHandle.currentState.boundContentFragment=s(n.bindingHandle.currentState.boundContentTree,n.bindingHandle)),t=nr(n.bindingHandle.currentState.boundContentFragment),n.bindingHandle.currentState.element==null?st(n,n.bindingHandle.currentState.boundContentFragment):r(n,u,n.bindingHandle.currentState.element,n.bindingHandle.currentState.boundContentFragment),n.bindingHandle.currentState.boundContent=n.isArray===!0?rt(n):t);else if(i===EVUI.Modules.Binding.BindingMode.Overwrite)n.isArray===!0?n.bindingHandle.currentState.boundContent=rt(n):n.bindingHandle.oldStateBound===!0&&n.bindingHandle.currentState.childBindingHandles.length>0?di(n):(n.bindingHandle.currentState.boundContentFragment==null&&(n.bindingHandle.currentState.boundContentFragment=n.bindingHandle.currentState.boundContentTree.toNode()),t=nr(n.bindingHandle.currentState.boundContentFragment),n.bindingHandle.currentState.element==null?st(n,n.bindingHandle.currentState.boundContentFragment):r(n,u,n.bindingHandle.currentState.element,n.bindingHandle.currentState.boundContentFragment),n.bindingHandle.currentState.boundContent=t);else throw Error('Unrecognized bindingMode: "'+i+'".');vf(n)},r=function(n,t,i,r){var f=r.childNodes.length>0?r.lastChild:r,u;n.lastInsertedNode=f;switch(t){case EVUI.Modules.Binding.BindingInsertionMode.Append:case EVUI.Modules.Binding.BindingInsertionMode.Default:i.append(r);break;case EVUI.Modules.Binding.BindingInsertionMode.Prepend:i.prepend(r);break;case EVUI.Modules.Binding.BindingInsertionMode.Fragment:i.append(r);return;case EVUI.Modules.Binding.BindingInsertionMode.InsertAfter:i.after(r);break;case EVUI.Modules.Binding.BindingInsertionMode.InsertBefore:i.before(r);break;case EVUI.Modules.Binding.BindingInsertionMode.ReplaceChildren:i.innerHTML=null;i.append(r);break;case EVUI.Modules.Binding.BindingInsertionMode.Shadow:u=sparentNode.shadowRoot;u==null&&(u=sparentNode.attachShadow({mode:"open"}));u.append(r);break;default:throw Error('Invalid insertionMode: "'+t+'"');}},di=function(n){var f,c,e,t,l,s,a,h,o,i,r;if(n.isArray===!1){if(f=null,n.bindingHandle.currentState.boundContentFragment!=null){for(c=n.bindingHandle.currentState.boundContentFragment.childNodes.length,f=[],t=nt(n.bindingHandle),t==null&&(t={}),t.includeNodeReferences=!0,i=0;i<c;i++)f.push(u.domTreeConverter.toDomTreeElement(n.bindingHandle.currentState.boundContentFragment.childNodes[i],t));t.includeNodeReferences=!1}else f=n.bindingHandle.currentState.boundContentTree.content.slice();if(e=[],n.bindingHandle.oldState!=null&&n.bindingHandle.oldState.boundContent!=null&&n.bindingHandle.oldState.source===n.bindingHandle.currentState.source){for(t=nt(n.bindingHandle),t==null&&(t={}),t.includeNodeReferences=!0,l=n.bindingHandle.oldState.boundContent.length,i=0;i<l;i++)(s=n.bindingHandle.oldState.boundContent[i],EVUI.Modules.Core.Utils.isOrphanedNode(s)!==!0)&&e.push(u.domTreeConverter.toDomTreeElement(s,t));t.includeNodeReferences=!1;n.bindingHandle.oldState.childBindingHandles.length>0&&af(n,e,f)}for(a=f.length,EVUI.Modules.DomTree.DomTreeElement[EVUI.Modules.Core.Constants.Symbol_ObjectProperties]==null&&(EVUI.Modules.Core.Utils.cacheProperties(new EVUI.Modules.DomTree.DomTreeElement),EVUI.Modules.Core.Utils.cacheProperties(new EVUI.Modules.DomTree.DomTreeElementAttribute)),h=u.diffController.compare(e,f,{compareValuesOnly:!0}),yf(n,h),o=[],i=0;i<a;i++)r=h.rootComparison.childComparisons[i],r.a!=null&&r.a.node!=null&&EVUI.Modules.Core.Utils.isOrphanedNode(r.a.node)===!1?o.push(r.a.node):(r.b!=null&&r.b.node!=null&&EVUI.Modules.Core.Utils.isOrphanedNode(r.b.node)===!1||r.a==null)&&o.push(r.b.node);n.bindingHandle.currentState.boundContent=o}else n.bindingHandle.currentState.boundContent=rt(n)},af=function(n,t,i){var h=new EVUI.Modules.DomTree.DomTreeElement,c,l,f,u,e,tt,o,v,it,rt,r,y,p;h.content=t;c=new EVUI.Modules.DomTree.DomTreeElement;c.content=i;var w=[],b=[],k={},s=[],l=n.bindingHandle.oldState.childBindingHandles.length;for(u=0;u<l;u++)f=n.bindingHandle.oldState.childBindingHandles[u],w.push(f.currentState.parentBindingPath),(f.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.InsertAfter||f.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.InsertBefore)&&f.oldState!=null&&(k[f.currentState.parentBindingPath]=!0,s.push(f));for(l=n.bindingHandle.currentState.childBindingHandles.length,u=0;u<l;u++)f=n.bindingHandle.currentState.childBindingHandles[u],b.push(f.currentState.parentBindingPath);var d=gi(n,h,w),a=gi(n,c,b),g=s.length,ut=d.length,nt=a.length;for(u=0;u<ut;u++)if(e=d[u],tt=k[e.path],tt===!0){for(o=null,r=0;r<g;r++)if(v=s[r],v.oldState.parentBindingPath===e.path){o=v;s.splice(r,1);g--;break}if(o==null||o.oldState.boundContent==null)continue;for(it=o.oldState.boundContent.length,r=0;r<it;r++)rt=o.oldState.boundContent[r],h.search(function(n){var i,t,r;if(EVUI.Modules.Core.Utils.isArray(n.content)===!0)for(i=n.content,t=0;t<i;t++)if(r=n.content[t],r.node===rt)return n.content.splice(t,1),!0},!0)}else for(r=0;r<nt;r++)if(y=a[r],y.path===e.path){found=!0;p=y.tree.clone();e.tree.content=p.content;e.tree.shadow=p.shadow;a.splice(r,1);nt--;break}},gi=function(n,t,i){var r=[],u=t.search(function(n){var f,t,u;if(n.attrs!=null)for(f=n.attrs.length,t=0;t<f;t++)if(u=n.attrs[t],u.key===EVUI.Modules.Binding.Constants.Attr_BoundObj)return i.indexOf(u.val)!==-1?(r.push({path:u.val,tree:n}),!0):!1});return r},rt=function(n){for(var t,r,o,a,u,s,h=[],c=!1,f=null,e=null,l=n.bindingHandle.currentState.childBindingHandles.length,i=0;i<l;i++){if(t=n.bindingHandle.currentState.childBindingHandles[i],r=t.currentState.element==null||t.currentState.element.isConnected===!1||t.currentState.element===n.bindingHandle.currentState.element,i===0&&r===!0?(t.currentState.element=n.bindingHandle.currentState.element,r=!1):c===!0&&f!=null?f.currentState.element=e:r===!1&&i>0&&(o=n.bindingHandle.currentState.childBindingHandles[i-1],t.currentState.element!==o.currentState.boundContent[o.currentState.boundContent.length-1]&&(r=!0)),t.currentState.boundContent!=null){for(a=t.currentState.boundContent.length,u=0;u<a;u++)s=t.currentState.boundContent[u],h.push(s);e=s}i===l-1&&r===!0&&(t.element=e);c=r;f=t}return h},nr=function(n){var i=[],r,t;if(n==null)return i;for(r=n.childNodes.length,t=0;t<r;t++)i.push(n.childNodes[t]);return i},go=function(n){var e,u,h,o,s,c,l,t,i,r,f;if(n.bindingHandle.oldStateBound!==!1&&(e=n.bindingHandle.oldState.childBindingHandles.slice(),u=e.length,n.observedDifferences!=null))if(EVUI.Modules.Core.Utils.isArray(n.observedDifferences)===!0){if(u===0)return;for(h=n.observedDifferences.length,t=0;t<h;t++)if(i=n.observedDifferences[t],i.type===EVUI.Modules.Observers.ObservedObjectChangeType.Removed)for(r=0;r<u;r++)if((f=e[r],f.currentState.source===i.originalValue)&&f.currentState.parentBindingKey===i.name){e.splice(r,1);u--;v(f);break}}else{if(o=n.observedDifferences.rootComparison.differences.length,u===0){for(s=!1,t=0;t<o;t++)if(i=n.observedDifferences.rootComparison.differences[t],EVUI.Modules.Core.Utils.hasFlag(i.flags,EVUI.Modules.Diff.DiffFlags.AOnly)===!1&&EVUI.Modules.Core.Utils.hasFlag(i.flags,EVUI.Modules.Diff.DiffFlags.BOnly)===!1){s=!0;break}if(s===!1)for(c=n.bindingHandle.oldState.boundContent.length,t=0;t<c;t++)l=n.bindingHandle.oldState.boundContent[t],l.remove();return}for(t=0;t<o;t++)if((i=n.observedDifferences.rootComparison.differences[t],i.a!=null||i.b==null||typeof i.b=="object")&&EVUI.Modules.Core.Utils.hasFlag(i.flags,EVUI.Modules.Diff.DiffFlags.AOnly)!==!0)for(r=0;r<u;r++)if(f=e[r],f.currentState.source===i.b){e.splice(r,1);u--;v(f);break}}},vf=function(n){var r,u,e,i,t;if(n.bindingHandle.oldState!=null){if(n.bindingHandle.oldStateBound===!1){if(n.bindingHandle.oldState.source!==n.bindingHandle.currentState.source&&n.bindingHandle.oldState.boundContent!=null)for(r=n.bindingHandle.oldState.boundContent.length,t=0;t<r;t++)n.bindingHandle.oldState.boundContent[t].remove();return}var s=n.bindingHandle.oldState.childBindingHandles.slice(),h=w(n,n.bindingHandle.currentState.childBindingHandles),c=n.bindingHandle.oldState.childBindingHandles.length;for(t=0;t<c;t++)if(u=s[t],e=h[u.currentState.normalizedPath],e==null){v(u);continue}if((n.observedDifferences==null||n.observedDifferences.length!==0&&(n.observedDifferences.allDifferences==null||n.observedDifferences.allDifferences.length!==0))&&(n.parentSession!=null&&n.parentSession.isArray===!0,i=n.bindingHandle.oldState.boundContent,i!=null&&i.length!==0)){var o=n.bindingHandle.currentState.boundContent.length,r=i.length,f=Math.random();for(t=0;t<o;t++)n.bindingHandle.currentState.boundContent[t][f]=!0;for(t=0;t<r;t++)i[t][f]!==!0&&i[t].remove();for(t=0;t<o;t++)delete n.bindingHandle.currentState.boundContent[t][f];return}}},yf=function(n,t){for(var s=t.rootComparison.differences.length,r=0;r<s;r++){var i=t.rootComparison.differences[r],u=g(i.a),f=g(i.b),e=u===!1?EVUI.Modules.Core.Utils.isArray(i.a):!1,o=f===!1?EVUI.Modules.Core.Utils.isArray(i.b):!1;(u!==!1||f!==!1||e!==!1||o!==!1)&&(u===!0||f===!0?ot(n,t,i):(e===!0||o===!0)&&ni(n,t,i,0))}},d=function(n){if(pf(n),n.bindingHandle.currentState.parentBindingHandle!=null&&n.bindingHandle.currentState.parentBindingHandle.currentState.sourceObserver!=null){var t=n.bindingHandle.currentState.parentBindingHandle.currentState.sourceObserver.getChildObserver(n.bindingHandle.currentState.parentBindingKey,!0);if(t!=null)return t}return new EVUI.Modules.Observers.ObjectObserver(n.bindingHandle.currentState.source)},pf=function(n){n.isArray===!0&&(n.bindingHandle.currentState.arrayObserver=n.bindingHandle.oldState!=null?n.bindingHandle.oldState.source===n.bindingHandle.currentState.source?n.bindingHandle.oldState.arrayObserver==null?new EVUI.Modules.Observers.ArrayObserver(n.bindingHandle.currentState.source):n.bindingHandle.oldState.arrayObserver:new EVUI.Modules.Observers.ArrayObserver(n.bindingHandle.currentState.source):new EVUI.Modules.Observers.ArrayObserver(n.bindingHandle.currentState.source))},ni=function(n,t,i){for(var r,f=i.differences.length,u=0;u<f;u++)(r=i.differences[u],r.diffType===EVUI.Modules.Diff.DiffType.String||r.parentComparison==null||r.parentComparison.propName==="content")&&ot(n,t,r)},ot=function(n,t,i){var it=i.differences.length,b=null,e=null,p=null,nt=null,k=i.a,d=i.b,h=k==null?null:typeof k,c=d==null?null:typeof d,u,tt,v,y,a,w,l,o,f;if(h==="string"&&c==="string")u=ii(n,i),n.bindingHandle.binding.bindingMode===EVUI.Modules.Binding.BindingMode.Overwrite?parent.a.node.replaceWith(s(u.b,n.bindingHandle)):u.a.node.textContent=u.b.content;else if(h==="string"||c==="string"){var u=ii(n,i),o=u.a.node,f=u.b.node;h==="string"?c==="object"?(f==null&&(f=s(u.b,n.bindingHandle)),g(d)===!0?o.replaceWith(f):f.replaceWith(o)):c==null&&o.remove():c==="string"&&(h==="object"?(f==null&&(f=s(u.b,n.bindingHandle)),g(k)===!0?f.replaceWith(o):o.replaceWith(f)):h==null&&f!=null&&f.remove())}else if((h==="object"||c==="object")&&h!==c)if(u=ii(n,i),u==null)for(u=i.parentComparison,tt=Math.max(u.a.length,u.b.length),v=0;v<tt;v++)y=u.a[v],a=u.b[v],y!=null&&a!=null?(s(a,n.bindingHandle),y.node.replaceWith(a.node)):a==null?y.node.remove():y==null&&(s(a,n.bindingHandle),st(n,a.node));else o=u.a.node,f=s(u.b,n.bindingHandle),h==="object"?i.a.node.remove():c==="object"&&(o.lastChild==null?o.replaceWith(f):r(n,EVUI.Modules.Binding.BindingInsertionMode.InsertAfter,o.lastChild,s(i.b,n.bindingHandle)));else if(h==="object"&&c==="object"){for(w=0;w<it;w++)if(l=i.differences[w],l.propName==="tagName"?b=l:l.propName==="content"?e=l:l.propName==="attrs"?p=l:l.propName==="shadow"&&(nt=l),b!=null&&e!=null&&p!=null&&nt!=null)break;b!=null||n.bindingHandle.binding.insertionMode===EVUI.Modules.Binding.BindingMode.Overwrite?(o=i.a.node,f=s(i.b,n.bindingHandle),o.replaceWith(f),n.bindingHandle.binding.insertionMode===EVUI.Modules.Binding.BindingMode.Overwrite&&e!=null&&n.bindingHandle.currentState.childBindingHandles.length>0&&(e.differences.length===0||e.diffType===EVUI.Modules.Diff.DiffType.String?ot(n,t,e,0):ni(n,t,e,0))):(e!=null&&(e.differences.length===0||e.diffType===EVUI.Modules.Diff.DiffType.String?ot(n,t,e,0):ni(n,t,e,0)),p!=null&&wf(n,t,p,i.a.node))}},wf=function(n,t,i,r){for(var e=bf(i),c=ar(i.parentComparison.a.node),l=ar(s(i.parentComparison.b,n.bindingHandle)),a=e.keys.length,o=0;o<a;o++){var f=e.keys[o],h=e.dictionary[f],u=kf(n,f,h.currentValue,h.newValue,c,l);u!=null&&(c.attributes[f]=u,u!=null&&u.value!==h.currentValue)&&r.setAttribute(f,u.value)}},bf=function(n){for(var t,i,r={},u=[],e=n.differences.length,f=0;f<e;f++)t=n.differences[f],t.a!=null&&(i=r[t.a.key],i==null&&(i={},r[t.a.key]=i,u.push(t.a.key)),i.currentValue=t.a.val),t.b!=null&&(i=r[t.b.key],i==null&&(i={},r[t.b.key]=i,u.push(t.b.key)),i.newValue=t.b.val);return{dictionary:r,keys:u}},kf=function(n,t,i,r,u,f){var ot=i,y=u!=null?u.getAttributeMetadata(t):null,k=f!=null?f.getAttributeMetadata(t):null,it,c,d,s,o;if(y==null||k==null||i===r||(i=i!=null?i.replace(/\s+/g," ").trim():"",r=r!=null?r.replace(/\s+/g," ").trim():"",i===r))return y;if(it=i===y.value,it===!0)return k;c=new gr;c.name=t;var g=gf(i,y.value,r),nt=ne(y,k),ft=g.keys.length,et=EVUI.Modules.Core.Utils.toDictionary(y.values,function(n){return n.value}),w=EVUI.Modules.Core.Utils.toDictionary(k.values,function(n){return n.value}),rt="",ut="",b={};for(d=0;d<ft;d++)if(s=g.keys[d],b[s]!==!0){b[s]=!0;var tt=g.dictionary[s],l=EVUI.Modules.Core.Utils.hasFlag(tt.flags,p.InCurrent),a=EVUI.Modules.Core.Utils.hasFlag(tt.flags,p.InOld),v=EVUI.Modules.Core.Utils.hasFlag(tt.flags,p.InNew),h=null,e=null;if(l===!0&&a===!0&&v===!0)h=s,e=w[s];else if(l===!0&&a===!0&&v===!1)if(o=nt[s],o!=null)c.containsBoundValues=!0,h=o.value,e=w[o.value],b[o.value]=!0;else continue;else if(l===!0&&a===!1&&v===!0)h=s,e=w[s];else if(l===!0&&a===!1&&v===!1)o=nt[s],o!=null?(c.containsBoundValues=!0,h=o.value,e=w[o.value],b[o.value]=!0):(h=s,e=et[s],e==null&&(e=new fi,e.tokenizedString=h,e.value=h,e.wasBound=!1));else if(l===!1&&a===!0&&v===!0)continue;else if(l===!1&&a===!0&v===!1)continue;else if(l===!1&&a===!1&&v===!0)o=nt[s],o!=null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(o.value)===!1&&(c.containsBoundValues=!0,h=o.value,e=w[o.value],b[o.value]=!0);else continue;h!=null&&(rt+=h+" ");e!=null&&(ut+=e.tokenizedString+" ",e=df(e),c.values.push(e))}return c.tokenizedValue=ut.trim(),c.value=rt.trim(),c},df=function(n){var t=new fi,f,i,u,r;for(t.tokenizedString=n.tokenizedString,t.value=n.value,t.wasBound=n.wasBound,f=n.boundValues.length,i=0;i<f;i++)u=n.boundValues[i],r=new nu,r.boundContent=u.boundContent,r.boundPath=u.boundPath,t.boundValues.push(r);return t},gf=function(n,t,i){for(var l,a,r,u,s=n.split(/\s+/),h=t.split(/\s+/),c=i.split(/\s+/),e={},o=[],v=s.length,f=0;f<v;f++)(r=s[f],EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r)!==!0)&&(u=e[r],u==null&&(u=new ti,o.push(r),e[r]=u),u.flags|=p.InCurrent);for(l=h.length,f=0;f<l;f++)(r=h[f],EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r)!==!0)&&(u=e[r],u==null&&(u=new ti,o.push(r),e[r]=u),u.flags|=p.InOld);for(a=c.length,f=0;f<a;f++)(r=c[f],EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r)!==!0)&&(u=e[r],u==null&&(u=new ti,o.push(r),e[r]=u),u.flags|=p.InNew);return{dictionary:e,keys:o}},ne=function(n,t){var f={},h,i,r,u,e;if(n.containsBoundValues===!1||t.containsBoundValues===!1)return f;var o=EVUI.Modules.Core.Utils.toDictionary(n.values,function(n){if(n.wasBound!==!1)return n.tokenizedString}),s=EVUI.Modules.Core.Utils.toDictionary(t.values,function(n){if(n.wasBound!==!1)return n.tokenizedString}),c=n.values.length;for(i=0;i<c;i++)(r=n.values[i],r.wasBound!==!1)&&(u=o[r.tokenizedString],u!=null)&&f[u.value]==null&&(e=o[r.tokenizedString],f[u.value]=e);for(h=t.values.length,i=0;i<h;i++)(r=t.values[i],r.wasBound!==!1)&&(u=s[r.tokenizedString],u!=null)&&f[u.value]==null&&(e=s[r.tokenizedString],f[u.value]=e);return f},ti=function(){this.flags=p.None},p={None:0,InCurrent:1,InOld:2,InNew:4},ns=function(n,t){var i=n.bindingHandle.currentState.element,e;if(i!=null&&i.isConnected===!1&&n.bindingHandle.oldState!=null&&(i=n.bindingHandle.oldState.element),(i==null||i.isConnected===!1)&&n.parentSession!=null)if(e=n.parentSession.bindingHandle.currentState.childBindingHandles.length,e>0)if(i!=null)r(n,n.parentSession.bindingHandle.binding.insertionMode,n.parentSession.bindingHandle.currentState.element,i),r(n,n.bindingHandle.binding.insertionMode,i,t);else{for(var u=null,o=n.parentSession.isArray?parseInt(n.bindingHandle.currentState.parentBindingKey)-1:e-1,f=null;u==null&&o>=0;)f=n.parentSession.bindingHandle.currentState.childBindingHandles[o],u=f.currentState.boundContent==null?null:f.currentState.boundContent[f.currentState.boundContent.length-1],o--;u!=null?(u.after(t),(n.bindingHandle.currentState.element==null||n.bindingHandle.currentState.element.isConnected===!1)&&(n.bindingHandle.currentState.element=u)):(n.bindingHandle.currentState.element=n.parentSession.bindingHandle.currentState.element,r(n,n.bindingHandle.binding.insertionMode,n.bindingHandle.currentState.element,t))}else i!=null?r(n,n.parentSession.bindingHandle.binding.insertionMode,n.parentSession.bindingHandle.currentState.element,i):n.bindingHandle.currentState.element=n.parentSession.bindingHandle.currentState.element,r(n,n.bindingHandle.binding.insertionMode,i,t);else{if(n.lastInsertedNode!=null&&t.contains(n.lastInsertedNode))return;n.bindingHandle.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.InsertAfter||n.bindingHandle.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.InsertBefore?r(n,n.bindingHandle.binding.insertionMode,n.lastInsertedNode==null?n.bindingHandle.currentState.element:n.lastInsertedNode,t):n.bindingHandle.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.ReplaceChildren||n.bindingHandle.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.Shadow?n.lastInsertedNode!=null?r(n,n.bindingHandle.binding.insertionMode,i,t):n.bindingHandle.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.Shadow?r(n,EVUI.Modules.Binding.BindingInsertionMode.Append,i.shadowRoot,t):r(n,EVUI.Modules.Binding.BindingInsertionMode.Append,i,t):r(n,n.bindingHandle.binding.insertionMode,i,t)}},st=function(n,t){var l=n.bindingHandle.currentState.element,o,c,i,u;if(l==null)if(n.bindingHandle.currentState.parentBindingHandle!=null)if(i=n.bindingHandle.currentState.parentBindingHandle,o=i.currentState.childBindingHandles.length,o>0){for(var f=null,h=EVUI.Modules.Core.Utils.isArray(i.currentState.source)===!0?parseInt(n.bindingHandle.currentState.parentBindingKey)-1:o-1,e=null;f==null&&h>=0;)e=i.currentState.childBindingHandles[h],f=e.currentState.boundContent==null?null:e.currentState.boundContent[e.currentState.boundContent.length-1],h--;if(f!=null)f.after(t),(n.bindingHandle.currentState.element==null||n.bindingHandle.currentState.element.isConnected===!1)&&(n.bindingHandle.currentState.element=f);else{if(c=i.currentState.element,c==null)if(n.parentSession!=null)n.parentSession.bindingHandle.currentState.boundContentFragment==null&&(n.parentSession.bindingHandle.currentState.boundContentFragment=s(n.parentSession.bindingHandle.currentState.boundContentTree,n.parentSession.bindingHandle)),st(n.parentSession,n.parentSession.bindingHandle.currentState.boundContentFragment);else throw Error("Unresolvable parent element target in binding "+n.bindingHandle.id+".");else n.bindingHandle.currentState.element=c.isConnected===!1&&i.oldStateBound===!0&&i.oldState.element!=null&&i.oldState.element.isConnected===!0?i.oldState.element:i.currentState.element;n.bindingHandle.currentState.element!=null&&(n.parentSession.isArray===!0&&n.bindingHandle.currentState.parentBindingKey==="0"?r(n,EVUI.Modules.Binding.BindingInsertionMode.Prepend,n.bindingHandle.currentState.element,t):r(n,n.bindingHandle.binding.insertionMode,n.bindingHandle.currentState.element,t))}}else n.lastInsertedNode!=null?(n.bindingHandle.currentState.element=n.lastInsertedNode,r(n,n.bindingHandle.binding.insertionMode,n.bindingHandle.currentState.element,t)):(u=i.currentState.boundContent.length,u>0?(n.bindingHandle.currentState.element=i.currentState.boundContent[u-1],r(n,EVUI.Modules.Binding.BindingInsertionMode.InsertAfter,n.bindingHandle.currentState.element,t)):(n.bindingHandle.currentState.element=i.currentState.element,r(n,i.binding.insertionMode,n.bindingHandle.currentState.element,t)));else n.lastInsertedNode!=null?(n.bindingHandle.currentState.element=n.lastInsertedNode,r(n,n.bindingHandle.binding.insertionMode,n.bindingHandle.currentState.element,t)):(i=n.bindingHandle.currentState.parentBindingHandle,i!=null?(u=n.bindingHandle.currentState.boundContent.length,u>0?(n.bindingHandle.currentState.element=i.currentState.boundContent[u-1],r(n,EVUI.Modules.Binding.BindingInsertionMode.InsertAfter,n.bindingHandle.currentState.element,t)):(n.bindingHandle.currentState.element=i.currentState.element,r(n,i.binding.insertionMode,n.bindingHandle.currentState.element,t))):r(n,n.bindingHandle.binding.insertionMode,n.bindingHandle.currentState.element,t));else r(n,n.bindingHandle.binding.insertionMode,n.bindingHandle.currentState.element,t)},g=function(n){return n!=null&&typeof n.type=="number"&&typeof n.tagName=="string"?!0:!1},ii=function(n,t){if(g(t.a)===!0||g(t.b)===!0){var i=t.parentComparison;return i.parentComparison==null?null:i.parentComparison}return t.parentComparison},s=function(n,t){var i=n.toNode(nt(t));return ir(n),i},nt=function(n){return n.options==null?null:n.options.nodeCreation},te=function(n,t){var o=nt(n.bindingHandle),r=u.domTreeConverter.htmlToDomTree(t,o),s,f,i;for(r==null&&(r=u.domTreeConverter.toDomTreeElement(document.createTextNode(""),o)),n.boundPropertyDictionary={},s=n.bindingHandle.currentState.boundProperties.length,f=0;f<s;f++)i=n.bindingHandle.currentState.boundProperties[f],n.boundPropertyDictionary[i.path]=typeof i.value=="function"?{value:"$evui.dispatch(event, '"+vr(n,i)+"'"}:{value:i.value};return r.search(function(t){var i=ge(n,t);i!=null&&(t[e]=i)}),r},tr=function(n){var i,t;if(n!=null&&(n.node=undefined,n.content!=null&&typeof n.content!="string"))for(i=n.content.length,t=0;t<i;t++)tr(n.content[t])},ir=function(n){var i,r,u,t;if(n!=null&&(i=n.node,i!=null)&&(r=n[e],r!=null)&&(i[e]=r,n.content!=null&&typeof n.content!="string"))for(u=n.content.length,t=0;t<u;t++)ir(n.content[t])},rr=function(n,t){if(typeof t!="function"&&(t=function(){}),typeof n.bindingHandle.currentState.htmlContent=="object"&&n.bindingHandle.currentState.htmlContent!=null)return EVUI.Modules.Core.Utils.isElement(n.bindingHandle.currentState.htmlContent)===!0?t(n.bindingHandle.currentState.htmlContent.outerHTML):fe(n,n.bindingHandle.currentState.htmlContent,function(n){t(n)});if(typeof n.bindingHandle.currentState.htmlContent=="string"&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.bindingHandle.currentState.htmlContent)===!1){var i=lt(n.bindingHandle.currentState.htmlContent);return i!=null?(n.bindingHandle.htmlContent=i,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.content)===!0&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.url)===!1?hr(n,i,function(n){return t(n)}):t(n.bindingHandle.htmlContent.content)):t(n.bindingHandle.currentState.htmlContent)}return t(null)},ie=function(n,t){if(n.bindingHandle.currentState.htmlContentSet===!0)rr(n,function(i){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i)===!0)return t(null);n.bindingHandle.currentState.htmlContent=i;var r=ur(n);n.bindingHandle.currentState.sourceObserver==null&&(n.bindingHandle.oldStateBound===!0&&n.bindingHandle.currentState.source===n.bindingHandle.oldState.source&&n.bindingHandle.oldState.sourceObserver!=null?(n.bindingHandle.currentState.sourceObserver=n.bindingHandle.oldState.sourceObserver,n.bindingHandle.currentState.arrayObserver=n.bindingHandle.oldState.arrayObserver):n.bindingHandle.currentState.sourceObserver=d(n));t(fr(n,r))});else{if(n.bindingHandle.currentState.htmlContent!=null&&typeof n.bindingHandle.currentState.htmlContent=="object"&&(n.bindingHandle.currentState.htmlContent=n.bindingHandle.currentState.htmlContent.content),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.bindingHandle.currentState.htmlContent)===!0)return t(null);n.bindingHandle.currentState.sourceObserver==null&&(n.bindingHandle.oldStateBound===!0&&n.bindingHandle.currentState.source===n.bindingHandle.oldState.source&&n.bindingHandle.oldState.sourceObserver!=null?(n.bindingHandle.currentState.sourceObserver=n.bindingHandle.oldState.sourceObserver,n.bindingHandle.currentState.arrayObserver=n.bindingHandle.oldState.arrayObserver):n.bindingHandle.currentState.sourceObserver=d(n));var i=null;return n.parentSession!=null&&n.parentSession.isArray===!0&&n.parentSession.bindingHandle.currentState.boundProperties!=null&&n.parentSession.bindingHandle.currentState.htmlContent===n.bindingHandle.currentState.htmlContent?t(n.parentSession.bindingHandle.currentState.boundProperties.map(function(n){return new EVUI.Modules.Binding.BoundProperty(n.path)})):(i=ur(n),t(fr(n,i)))}},ts=function(n,t){var f,i,u,e,r,o;if(t=t.slice(),f=n.length,i=t.length,f!==i)return!0;for(u=0;u<f;u++)for(e=n[u],r=0;r<i;r++)if(o=t[r],o.path===e.path&&o.value===e.value){i--;t.splice(r,1);break}return i>0?!0:!1},re=function(n){var f,r,i,t;if(n.bindingHandle.oldState.source===n.bindingHandle.currentState.source){if(n.bindingHandle.currentState.sourceObserver==null&&(n.bindingHandle.oldStateBound===!0&&n.bindingHandle.oldState.sourceObserver!=null?(n.bindingHandle.currentState.sourceObserver=n.bindingHandle.oldState.sourceObserver,n.bindingHandle.currentState.arrayObserver=n.bindingHandle.oldState.arrayObserver):n.bindingHandle.currentState.sourceObserver=d(n)),n.bindingHandle.oldState.childBindingHandles.length>0?n.oldStateDictionary=n.bindingHandle.currentState.sourceObserver.getObservedProperties():n.parentSession!=null&&n.parentSession.oldStateDictionary!=null&&(n.oldStateDictionary=n.parentSession.oldStateDictionary.getChild(n.bindingHandle.currentState.parentBindingKey)),n.observedDifferences=n.observedDifferences!=null?n.observedDifferences:n.bindingHandle.currentState.sourceObserver.getChanges(!0),n.bindingHandle.canceledDuringReBind===!0)return n.bindingHandle.canceledDuringReBind=!1,!0;if(n.oldStateDictionary!=null&&n.parentSession!=null&&n.oldStateDictionary.haveChildrenChanged()===!0||n.bindingHandle.oldState.htmlContent!==n.bindingHandle.currentState.htmlContent)return!0;if(i=n.observedDifferences.length,i===0)return!1;for(r=!1,t=0;t<i;t++)if(f=n.observedDifferences[t],f.hostObject===n.bindingHandle.currentState.source){r=!0;break}if(r===!1)return!1}else return(n.bindingHandle.currentState.sourceObserver==null&&(n.bindingHandle.currentState.sourceObserver=d(n),n.bindingHandle.oldState.childBindingHandles.length>0?n.oldStateDictionary=n.bindingHandle.currentState.sourceObserver.getObservedProperties():n.parentSession!=null&&n.parentSession.oldStateDictionary!=null&&(n.oldStateDictionary=n.parentSession.oldStateDictionary.getChild(n.bindingHandle.currentState.parentBindingKey))),n.observedDifferences=n.observedDifferences!=null?n.observedDifferences:u.diffController.compare(n.bindingHandle.currentState.source,n.bindingHandle.oldState.source),n.bindingHandle.canceledDuringReBind===!0)?(n.bindingHandle.canceledDuringReBind=!1,!0):!0;return n.bindingHandle.canceledDuringReBind=!1,!0},ht=function(n){return n.bindingHandle.options.enumerateArrays===!0&&n.isArray===!0?!0:!1},ue=function(n){for(var u,t,f,e=n.originalBoundProps,a=e.length,o={},s=n.bindingHandle.binding.getBoundProperties(),v=s.length,h=[],c={},i=0;i<a;i++)u=e[i],o[u.path]=u;for(i=0;i<v;i++)if(t=s[i],t!=null&&!EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.path)){var l=o[t.path],r=c[t.path],y=r==null;r==null&&(r=new EVUI.Modules.Binding.BoundProperty(t.path));r.value=t.value;l!=null&&t.value===l.value&&n.isArray===!1&&(f=n.isArray===!0?null:EVUI.Modules.Core.Utils.getValue(t.path,n.bindingHandle.currentState.source),t.value!==f&&(r.value=f));y===!0&&(c[t.path]=r,h.push(r))}return h},ur=function(n){var t=[];return n.bindingHandle.htmlContent!=null&&n.bindingHandle.htmlContent.content===n.bindingHandle.currentState.htmlContent?n.bindingHandle.htmlContent.needsRecalcuation===!1&&n.bindingHandle.htmlContent.tokenMappings!=null?t=n.bindingHandle.htmlContent.tokenMappings:(t=ui(n.bindingHandle.htmlContent.content),n.bindingHandle.htmlContent.needsRecalcuation=!1,n.bindingHandle.htmlContent.tokenMappings=t):t=ui(n.bindingHandle.currentState.htmlContent),t},fr=function(n,t){for(var i,u,f=[],e=ht(n),o=t.length,r=0;r<o;r++){if(i=t[r],u=new EVUI.Modules.Binding.BoundProperty(i.path),e===!1||n.bindingHandle.currentState.parentBinding!=null&&i.value!==undefined)try{u.value=EVUI.Modules.Core.Utils.getValue(i.path,n.bindingHandle.currentState.source)}catch(s){EVUI.Modules.Core.Utils.log(s)}f.push(u)}return f},fe=function(n,t,i){var e,r,s,u,f;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.content)===!1)return n.bindingHandle.htmlContent=lt(t.key),i(t.content);if(e=!1,r=null,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.key)===!1)r=lt(t.key);else if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.url)===!1)for(s=o.length,u=0;u<s;u++)if(f=o[u],f.url===t.url&&f.ignoreUrl===!1){r=f;break}return(r==null&&(r=new yr,r.key=t.key,r.url=t.url,e=!0),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.content)===!1)?i(r.content):EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.url)===!1?(e===!0&&n.bindingHandle.options.addMissingHtmlContent!==!1&&(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.key)===!0&&(r.key=EVUI.Modules.Core.Utils.makeGuid()),o.push(r),n.bindingHandle.htmlContent=r),hr(n,r,function(n){i(n)})):i(null)},ri=function(n){var o=[],u,h,i,f,r,t,e;if(n.bindingHandle.currentState.boundContentFragment!=null)for(u=new EVUI.Modules.Dom.DomHelper("["+EVUI.Modules.Binding.Constants.Attr_BoundObj+"]",n.bindingHandle.currentState.boundContentFragment),h=u.elements.length,i=0;i<h;i++)(f=u.elements[i],r=f.getAttribute(EVUI.Modules.Binding.Constants.Attr_BoundObj),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r)!==!0)&&(t=new ao,t.element=f,t.path=r,t.source=EVUI.Modules.Core.Utils.getValue(r,n.bindingHandle.currentState.source),o.push(t));else if(n.bindingHandle.currentState.boundContentTree!=null&&n.bindingHandle.currentState.mergedHtmlContent.indexOf(EVUI.Modules.Binding.Constants.Attr_BoundObj)!==-1&&(e=n.bindingHandle.currentState.boundContentTree.search(function(n){var i,t,r;if(n.attrs==null)return!1;for(i=n.attrs.length,t=0;t<i;t++)if(r=n.attrs[t],r.key===EVUI.Modules.Binding.Constants.Attr_BoundObj)return!0},!0),e!=null&&e.length>0&&(n.bindingHandle.currentState.boundContentFragment=s(n.bindingHandle.currentState.boundContentTree,n.bindingHandle),n.bindingHandle.currentState.boundContentFragment!=null)))return ri(n);return o},ee=function(n){var u,e,i,t;if(n.parentSession!=null&&n.parentSession.isArray===!0&&n.bindingHandle.currentState.element==null)return[];for(u=[],e=n.bindingHandle.currentState.source.length,i=0;i<e;i++){var o=i.toString(),r=new EVUI.Modules.Binding.BindArgs,f=n.bindingHandle.binding.insertionMode;(f===EVUI.Modules.Binding.BindingInsertionMode.Default&&(f=i===0?EVUI.Modules.Binding.BindingInsertionMode.Default:EVUI.Modules.Binding.BindingInsertionMode.InsertAfter),r.bindingSource=n.bindingHandle.currentState.source[i],r.templateName=n.bindingHandle.templateName,r.htmlContent=n.bindingHandle.htmlContent!=null?n.bindingHandle.htmlContent.key:n.bindingHandle.currentState.htmlContent,r.bindingMode=n.bindingHandle.binding.bindingMode,r.insertionMode=f,t=ut(r,n.bindingHandle),t!=null)&&(t.currentState.parentBindingHandle=n.bindingHandle,t.currentState.parentBindingPath=o,t.currentState.parentBindingKey=o,t.currentState.boundProperties=n.bindingHandle.currentState.boundProperties.map(function(n){var t=new EVUI.Modules.Binding.BoundProperty(n.path);return t.value=n.value,t}),u.push(t))}return u},oe=function(n){var e=ri(n),o=e.length,t,i;if(o!==0){var s=w(n,n.bindingHandle.oldState.childBindingHandles),h=w(n,n.bindingHandle.oldState.childBindingHandles),r=n.bindingHandle.oldState.childBindingHandles.length,c=n.bindingHandle.oldState.childBindingHandles.slice(),u={},l=or(n,n.bindingHandle.oldState.childBindingHandles);for(i=0;i<r;i++)u[i]=i;for(t={},t.pathDic=s,t.unfoundPathDic=h,t.numChildren=r,t.childBindings=c,t.numOldChildren=r,t.remainingIndexes=u,t.indexKeys=Object.keys(u),t.numKeys=t.indexKeys.length,t.makeNewKeys=!1,t.hashDic=l,i=0;i<o;i++){var f=e[i],a=f.path,v=f.source,y=f.element;er(n,t,a,v,y)}ct(n,n.bindingHandle.oldState.childBindingHandles);ct(n,n.bindingHandle.currentState.childBindingHandles)}},se=function(n){for(var t,f,e,o=w(n,n.bindingHandle.oldState.childBindingHandles),s=w(n,n.bindingHandle.oldState.childBindingHandles),h=n.bindingHandle.currentState.source.length,r=n.bindingHandle.oldState.childBindingHandles.length,c=n.bindingHandle.oldState.childBindingHandles.slice(),u={},l=or(n,n.bindingHandle.oldState.childBindingHandles),i=0;i<r;i++)u[i]=i;for(t={},t.pathDic=o,t.unfoundPathDic=s,t.numChildren=r,t.childBindings=c,t.numOldChildren=r,t.remainingIndexes=u,t.indexKeys=Object.keys(u),t.numKeys=t.indexKeys.length,t.makeNewKeys=!1,t.hashDic=l,i=0;i<h;i++)f=i.toString(),e=n.bindingHandle.currentState.source[i],er(n,t,f,e);ct(n,n.bindingHandle.oldState.childBindingHandles);ct(n,n.bindingHandle.currentState.childBindingHandles)},er=function(n,t,i,r,u){var y=!1,s=h(t.pathDic,vt(i)),o=s!=null?s.getNextUnprocessedBinding():null,p,a,c,w,f,b,v;if(o!=null&&(o.processed=!0),o==null||o.binding.currentState.source!==r&&n.bindingHandle.currentState.source===n.bindingHandle.oldState.source){if(r!=null&&(p=r[e],p!=null&&(s=t.hashDic[p],s!=null)))for(a=0;a<s.numBindings;a++)if((c=s.bindings[a],c.processed!==!0)&&c.binding.currentState.source===r){c.processed=!0;o=c.binding;y=!0;break}}else if(o==null||o.binding.currentState.source!==r&&n.bindingHandle.currentState.source!==n.bindingHandle.oldState.source){if(r!=null&&(p=r[e],p!=null&&(s=t.hashDic[p],s!=null)))for(a=0;a<s.numBindings;a++)if((c=s.bindings[a],c.processed!==!0)&&c.binding.currentState.source===r){c.processed=!0;o=c.binding;y=!0;break}}else o!=null&&o.binding.currentState.source===r&&(y=!0);y===!0&&o!=null&&o.index!==undefined&&(o=o.binding);y===!0&&(o.pendingState==null&&(o.pendingState=new l),o.pendingState.parentBindingPath=i,o.pendingState.parentBindingKey=i,o.pendingState.parentBindingHandle=o.currentState.parentBindingHandle,o.pendingState.normalizedPath=o.pendingState.getNormalizedPath(),o.pendingState.htmlContent=n.bindingHandle.htmlContent!=null&&n.bindingHandle.htmlContent.content===o.currentState.htmlContent?n.bindingHandle.htmlContent.key:o.currentState.htmlContent,o.pendingState.htmlContentSet=!0,o.pendingState.source=r,o.pendingState.sourceSet=!0,u!=null&&(o.pendingState.element=u,o.pendingState.elementSet=!0),n.bindingHandle.currentState.childBindingHandles.push(o));y===!1&&(w=new EVUI.Modules.Binding.BindArgs,w.bindingSource=r,w.bindingTarget=u,w.templateName=n.bindingHandle.templateName,f=ut(w,n.bindingHandle),f!=null&&(f.currentState.parentBindingKey=i,f.currentState.parentBindingPath=i,f.currentState.parentBindingHandle=n.bindingHandle,f.currentState.normalizedPath=f.currentState.getNormalizedPath(),f.currentState.htmlContent==null&&(f.currentState.htmlContent=n.bindingHandle.htmlContent!=null&&n.bindingHandle.htmlContent.content===n.bindingHandle.currentState.htmlContent?n.bindingHandle.htmlContent.key:n.bindingHandle.currentState.htmlContent,f.currentState.htmlContentSet=!0),f.pendingState==null&&(f.pendingState=new l),f.pendingState.parentBindingPath=i,f.pendingState.parentBindingKey=i,f.pendingState.parentBindingHandle=f.currentState.parentBindingHandle,f.pendingState.normalizedPath=f.pendingState.getNormalizedPath(),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f.currentState.htmlContent)===!0&&(f.pendingState.htmlContent=EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f.currentState.htmlContent)===!0&&n.bindingHandle.htmlContent!=null&&n.bindingHandle.htmlContent.content===f.currentState.htmlContent?n.bindingHandle.htmlContent.key:f.currentState.htmlContent,f.pendingState.htmlContentSet=!0),f.pendingState.source=r,f.pendingState.sourceSet=!0,(u==null||f.binding.insertionMode===EVUI.Modules.Binding.BindingInsertionMode.Default)&&(f.binding.insertionMode=f.currentState.parentBindingHandle!=null&&f.currentState.parentBindingHandle.binding.insertionMode!==EVUI.Modules.Binding.BindingInsertionMode.Default?f.currentState.parentBindingHandle.binding.insertionMode:EVUI.Modules.Binding.BindingInsertionMode.Default),b=h(t.unfoundPathDic,vt(i)),b!=null&&(v=b.getNextUnprocessedBinding(),v!=null&&(v.processed=!0,f.currentState.boundContent=v.binding.currentState.boundContent.slice(),f.currentState.source=v.binding.currentState.source,f.currentState.childBindingHandles=v.binding.currentState.childBindingHandles.slice(),f.newStateBound=v.binding.newStateBound)),n.bindingHandle.currentState.childBindingHandles.push(f)))},he=function(n,t){for(var r,u,i,f,o=[],s=t.length,h=ht(n),e=0;e<s;e++)(r=t[e],u=new EVUI.Modules.Binding.BindArgs,u.bindingSource=r.source,u.bindingTarget=r.element,i=ut(u,n.bindingHandle),i!=null)&&(i.currentState.parentBindingHandle=n.bindingHandle,i.currentState.parentBindingPath=r.path,i.currentState.htmlContent==null&&(i.currentState.htmlContent=n.bindingHandle.currentState.htmlContent),f=EVUI.Modules.Core.Utils.getValuePathSegments(r.path),i.currentState.parentBindingKey=f.length===0?r.path:f[f.length-1],h===!0&&(i.currentState.boundProperties=n.bindingHandle.currentState.boundProperties.map(function(n){var t=new EVUI.Modules.Binding.BoundProperty(n.path);return t.value=n.value,t})),o.push(i));return o},ce=function(n){for(var i,u,f=[],e=n.bindingHandle.binding.getChildBindings(),c=e.length,o=n.bindingHandle.currentState.childBindingHandles,l=o.length,s={},t=0;t<l;t++)i=o[t],s[i.id]=i;for(t=0;t<c;t++){var h=e[t],r=null,i=s[h.id];i!=null&&(r=i);r==null&&(u=ut(h,n.bindingHandle),u!=null&&(r=u));r!=null&&f.push(r)}return f},le=function(n){var u=n.bindingHandle.binding.onBindHtmlContent,f=t.onBindHtmlContent,i=typeof u,r=typeof f;return i!=="function"&&r!=="function"?!1:n.parentSession!=null&&n.parentSession.bindingHandle.options.suppressChildEvents===!0?!1:i==="function"||r==="function"},ae=function(n){var ht=n.shouldReBind,w,tt,b,it,s,t,d,e,rt,ut,y,k,p,r,h,ot,o,u,c,st,f;if(ht===!1&&n.bindingHandle.currentState.childBindingHandles.length===0)return[];if(n.bindingHandle.oldState==null)return n.bindingHandle.currentState.childBindingHandles;var a=ve(n),g=Object.keys(a.modifiedPaths),nt=g.length;if(nt===0)return[];for(w=[],f=0;f<nt;f++)for(t=a.modifiedPaths[g[f]],tt=t.length,r=0;r<tt;r++)w.push(t[r]);for(b=[],w.sort(function(n,t){return n.index-t.index}),it=w.length,s=[],f=0;f<it;f++)if(t=w[f],t.applied!==!0)if(t.bindingStructureChangeType===i.Added){n.isArray===!0&&(t.binding.currentState.boundContent=null);s.push(t.binding);t.applied=!0;continue}else if(t.bindingStructureChangeType===i.Moved){if(t.moveSwapTarget==null){s.push(t.binding);t.applied=!0;continue}if(d=t.moveSwapTarget.currentState,e=a.modifiedPaths[d.normalizedPath],e==null){s.push(t.binding);t.applied=!0;continue}for(e=e[0],rt=e.binding.currentState.element,ut=e.binding.currentState.boundContent[0],e.bindingStructureChangeType===i.Removed&&(e.binding.currentState.element=document.createElement("div"),e.applied=!0,b.push(e)),y=document.createElement("div"),ut.after(y),k=document.createDocumentFragment(),p=t.binding.currentState.boundContent.length,r=0;r<p;r++)h=t.binding.currentState.boundContent[r],r===0&&h.before(y),k.append(h);y.replaceWith(k);t.binding.currentState.element=rt;t.applied=!0;s.push(t.binding)}else if(t.bindingStructureChangeType===i.Removed){b.push(t);t.applied=!0;continue}else if(t.bindingStructureChangeType===i.Shifted){t.contentsModified===!0&&s.push(t.binding);t.applied=!0;continue}else if(t.bindingStructureChangeType===i.Swapped){var d=t.moveSwapTarget.currentState,e=a.modifiedPaths[d.normalizedPath][0],y=document.createElement("div"),ft=document.createElement("div"),k=document.createDocumentFragment(),et=document.createDocumentFragment();if(t.binding.currentState.boundContent!=null)for(p=t.binding.currentState.boundContent.length,r=0;r<p;r++)h=t.binding.currentState.boundContent[r],r===0&&h.before(y),k.append(h);if(e!=null&&e.binding.currentState.boundContent!=null)for(p=t.moveSwapTarget.currentState.boundContent.length,r=0;r<p;r++)h=e.binding.currentState.boundContent[r],r===0&&h.before(ft),et.append(h);y.replaceWith(et);ft.replaceWith(k);e!=null&&(e.applied=!0,s.push(e.binding));s.push(t.binding);t.applied=!0;continue}else t.contentsModified===!0&&s.push(t.binding),t.applied=!0;for(ot=a.unchangedBindings.length,f=0;f<ot;f++)o=a.unchangedBindings[f],u=new l,u.boundContent=o.currentState.boundContent,u.boundProperties=o.currentState.boundProperties,u.boundContentFragment=o.currentState.boundContentFragment,u.boundTemplateContentClone=o.currentState.boundTemplateContentClone,u.boundContentTree=o.currentState.boundContentTree,u.childBindingHandles=o.currentState.childBindingHandles,c=o.pendingState,u.element=c.element,u.normalizedPath=c.normalizedPath,u.htmlContent=c.htmlContent,u.mergedHtmlContent=o.currentState.mergedHtmlContent,u.parentBindingHandle=c.parentBindingHandle,u.parentBindingKey=c.parentBindingKey,u.parentBindingPath=c.parentBindingPath,u.source=c.source,u.sourceObserver=o.currentState.sourceObserver,o.oldState=n.bindingHandle.currentState,o.currentState=u,o.pendingState=null,o.oldStateBound=n.bindingHandle.oldStateBound,o.newStateBound=!0;for(st=b.length,f=0;f<st;f++)v(b[f].binding);return s},h=function(n,t){for(var i=n[t],r;i==null;){if(r=t.lastIndexOf("."),r!==-1)t=t.substring(0,r);else break;i=n[t]}return i},w=function(n,t){for(var e,i,r,o,f={},s=t.length,u=0;u<s;u++)e=t[u],i=e.currentState,i.normalizedPath==null&&(i.normalizedPath=i.getNormalizedPath()),r=f[i.normalizedPath],r==null&&(r=new it(i.normalizedPath),f[i.normalizedPath]=r),o=r.addBinding(e,u),o.stateToCheck=i;return f},or=function(n,t){for(var i,r,u,s,o={},h=t.length,f=0;f<h;f++)i=t[f],r=i.currentState.source!=null?i.currentState.source[e]:null,r==null&&(r=Math.random(),i.currentState.source!=null&&(i.currentState.source[e]=r)),u=o[r],u==null&&(u=new it(r),o[r]=u),s=u.addBinding(i,f),s.stateToCheck=i.currentState;return o},ct=function(n,t){for(var r,u=t.length,i=0;i<u;i++)r=t[i],r.currentState.source!=null&&delete r.currentState.source[e]},ve=function(n){var p=new yo,o,it,lt,y,rt,c,e,t,ut,ft,l,d,et,at,s,v,k,ot,g,r,nt;p.isArray=n.isArray;var tt=n.isArray&&n.bindingHandle.currentState.arrayObserver!=null?n.bindingHandle.currentState.arrayObserver.getChanges(!0):[],vt=EVUI.Modules.Core.Utils.toDictionary(tt,function(n){return n.newIndex.toString()}),st=EVUI.Modules.Core.Utils.toDictionary(tt,function(n){return n.oldIndex.toString()}),f=p.modifiedPaths,a=w(n,n.bindingHandle.currentState.childBindingHandles),b=w(n,n.bindingHandle.oldState.childBindingHandles),ht=le(n)===!0?n.bindingHandle.currentState.sourceObserver.getChanges():[],ct=EVUI.Modules.Core.Utils.isArray(n.observedDifferences)===!0?n.observedDifferences.concat(ht):ht,yt=ct.length;for(s=0;s<yt;s++)if(o=ct[s],o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Added||o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Changed||o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Removed){if(e=o.path,e==null)continue;if((o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Added||o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Removed)&&EVUI.Modules.Core.Utils.isObject(o.newValue)===!1&&EVUI.Modules.Core.Utils.isObject(o.originalValue)===!1&&(o.type=EVUI.Modules.Observers.ObservedObjectChangeType.Changed),t=h(a,e),o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Added){if(t==null)continue;f[t.normalizedPath]==null&&(f[t.normalizedPath]=t.makeChangeArray(i.Added))}else if(o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Changed||o.type===EVUI.Modules.Observers.ObservedObjectChangeType.Removed){if(it=!1,t==null&&(it=!0,t=h(b,e)),t!=null&&it===!0&&f[t.normalizedPath]==null){f[t.normalizedPath]=t.makeChangeArray(i.Removed);continue}if(t==null)continue;if(l=f[t.normalizedPath],l!=null){for(lt=l.length,r=0;r<lt;r++)y=l[r],y.contentsModified===!1&&y.bindingStructureChangeType!==i.Shifted&&y.bindingStructureChangeType!==i.Removed&&y.bindingStructureChangeType!==i.Swapped&&(y.contentsModified=!0);continue}f[t.normalizedPath]=t.makeChangeArray(function(t){return sr(n,t,a,b,vt,st),t.bindingStructureChangeType})}}if(n.bindingHandle.oldState!=null&&n.bindingHandle.currentState.source!=n.bindingHandle.oldState.source)for(n.observedDifferences==null&&(n.observedDifferences=u.diffController.compare(n.bindingHandle.currentState.source,n.bindingHandle.oldState.source)),rt=n.observedDifferences.rootComparison.differences,d=rt.length,s=0;s<d;s++)if((c=rt[s],e=c.getPath(),e!=null)&&(t=h(a,e),t!=null||(t=h(b,e),t!=null)))if(ut=c.a==null?"object":typeof c.a,ft=c.b==null?"object":typeof c.b,c.a!=null&&c.b!=null&&ut==="object"&&ft==="object"){if(l=f[e],l!=null){for(d=l.length,r=0;r<d;r++)l[r].contentsModified=!0;continue}f[e]=t.makeChangeArray(function(t){return sr(n,t,a,b,tt,st),t.bindingStructureChangeType})}else if(ft==="object"&&c.a==null&&c.b!=null){if(t==null)continue;f[e]==null&&(f[e]=t.makeChangeArray(i.Removed))}else if(ut==="object"&&c.a!=null&&c.b==null){if(t==null)continue;f[e]==null&&(f[e]=t.makeChangeArray(i.Added))}for(et=Object.keys(a),at=et.length,s=0;s<at;s++)if(v=et[s],k=f[v],k===undefined)if(b[v]===undefined)f[v]=h(a,v).makeChangeArray(i.Added);else for(ot=h(a,v),r=0;r<ot.numBindings;r++)p.unchangedBindings.push(ot.bindings[r].binding);else for(g=k.length,r=0;r<g;r++)nt=k[r],nt.contentsModified===!1&&nt.bindingStructureChangeType===i.Shifted&&(p.unchangedBindings.push(nt.binding),k.splice(r,1),r--,g--,g===0&&delete f[v]);return p},sr=function(n,t,r,u,f,e){var s=!1,c=t.binding.pendingState!=null?t.binding.pendingState:t.binding.oldState,l,a,o,y,v;if(n.isArray===!0&&(l=f[t.binding.currentState.parentBindingKey],l==null?(l=e[t.binding.currentState.parentBindingKey],l!=null&&delete e[t.binding.currentState.parentBindingKey]):delete f[t.binding.currentState.parentBindingKey],l!=null))switch(l.changeType){case EVUI.Modules.Observers.ArrayChangeType.Added:t.bindingStructureChangeType=i.Added;s=!0;break;case EVUI.Modules.Observers.ArrayChangeType.Moved:t.bindingStructureChangeType=i.Moved;s=!0;break;case EVUI.Modules.Observers.ArrayChangeType.Removed:t.bindingStructureChangeType=i.Removed;s=!0;break;case EVUI.Modules.Observers.ArrayChangeType.Shifted:t.bindingStructureChangeType=i.Shifted;s=!0}if(c==null||c.parentBindingKey===t.binding.currentState.parentBindingKey){t.contentsModified=!0;return}if(c.parentBindingKey!==t.binding.currentState.parentBindingKey){if((t.binding.oldStateBound===!1||t.binding.oldState==null)&&s===!1&&(t.bindingStructureChangeType=i.Added),c.source!==t.binding.currentState.source){t.contentsModified=!0;return}if(a=h(r,c.normalizedPath),a==null&&(a=h(u,c.normalizedPath)),a!=null){if(o=a.getNextUnprocessedBinding(),o==null){t.contentsModified===!1&&(v=n.oldStateDictionary.getChild(t.binding.currentState.parentBindingKey),t.contentsModified=v.haveChildrenChanged());return}o.processed=!0;t.moveSwapTarget=o.binding;y=o.binding.pendingState!=null?o.binding.pendingState:o.binding.oldState;y==null&&(y=o.stateToCheck);o.stateToCheck.parentBindingKey===c.parentBindingKey&&t.binding.currentState.parentBindingKey===y.parentBindingKey?t.bindingStructureChangeType=i.Swapped:(n.isArray===!1?s===!1&&(t.bindingStructureChangeType=i.Moved):s===!1&&(t.bindingStructureChangeType=i.Shifted),t.contentsModified===!1&&(v=n.oldStateDictionary.getChild(t.binding.currentState.parentBindingKey),t.contentsModified=v.haveChildrenChanged()));return}}t.contentsModified=!0},is=function(n){return n.parentSession!=null&&n.parentSession.isArray===!1&&n.bindingHandle.currentState.element!=null?n.parentSession.bindingHandle.currentState.boundContentFragment.contains(n.bindingHandle.currentState.element):!0},ye=function(n){for(var t=n.bindingHandle.currentState.parentBindingHandle,i=[];t!=null;){if(i.indexOf(t.currentState.source)!==-1)return!0;i.push(t.currentState.source);t=t.currentState.parentBindingHandle}return i.indexOf(n.bindingHandle.currentState.source)!==-1?!0:!1},hr=function(n,t,i){var r,f;if(t.failed===!0)return i(null);t.pending===!1?(r=function(n){for(t.pending=!1,t.failed===!1&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1?t.content=n:t.failed=!0,i(n);t.pendingCallbacks.length>0;){var r=t.pendingCallbacks.shift();r(n)}},EVUI.Modules.Core.Utils.require("Http"),f=null,n.bindingHandle.binding.contentLoadSettings!=null?(f=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestArgs,n.bindingHandle.binding.contentLoadSettings.httpRequestArgs),f.url=t.url,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f.method)===!0&&(f.method="GET")):(f=new EVUI.Modules.Http.HttpRequestArgs,f.url=t.url,f.method="GET"),t.pending=!0,u.httpManager.send(f,function(n){var i,u;if(t.pending=!1,n==null)return t.failed=!0,r(null);if(n.success===!0){if(i=n.response,i==null)return r(null);if(typeof i=="string"&&n.xmlHttpRequest.responseType!=="json")return r(i);if(n.xmlHttpRequest.responseType==="json"){try{i=JSON.parse(i)}catch(f){i=null;EVUI.Modules.Core.Utils.log(f)}return typeof i=="string"?r(i):r(null)}if(EVUI.Modules.Core.Utils.instanceOf(i,Blob)===!0)t.pending=!0,EVUI.Modules.Core.Utils.blobToTextAsync(i).then(function(n){t.pending=!1;r(n)}).catch(function(n){t.pending=!1;EVUI.Modules.Core.Utils.log(n);r(null)});else if(EVUI.Modules.Core.Utils.instanceOf(i,ArrayBuffer)===!0){u=null;try{u=(new TextDecoder).decode(i)}catch(f){EVUI.Modules.Core.Utils.log(f)}r(u)}else return EVUI.Modules.Core.Utils.instanceOf(i,Node)===!0?EVUI.Modules.Core.Utils.isElement(i)===!0?r(i.outerHTML):EVUI.Modules.Core.Utils.instanceOf(i,Document)===!0?r(i.body.innerHtml):r(i.textContent):r(null)}else return n.error!=null&&n.error.exception!=null&&EVUI.Modules.Core.Utils.log(n.error.exception),r(null)})):t.pendingCallbacks.push(i)},pe=function(n,t,i){var r={},f,u;if(n!=null&&typeof n=="object"?r=n:(r.key=n,r.content=t,r.url=i),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.key)===!0)throw Error("BindingHtmlContent must have a non-whitespace string key.");if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.content)===!0&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.url)===!0)throw Error("BindingHtmlContent must have either content or a url.");if(f=lt(r.key),f!=null)throw Error('BindingHtmlContent entry with the key "'+r.key+'" already exists.');else return u=new yr,u.key=r.key,u.content=r.content,u.url=r.url,u.item=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Binding.BindingHtmlContent(u),r,["key","content","url"]),o.push(u),u},we=function(n){for(var i,r=o.length,t=0;t<r;t++)if(i=o[t],i.item.key===n)return o.splice(t,1),!0;return!1},lt=function(n){for(var i,r=o.length,t=0;t<r;t++)if(i=o[t],i.item.key===n)return i;return null},tt=function(n){var r,t,i;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return null;for(r=a.length,t=0;t<r;t++)if(i=a[t],i.templateName===n)return i;return null},b=function(n,t,i){var f=t!=null&&n.options==null&&t.options.shareOptions!==!1,e=t!=null&&n.contentLoadSettings==null&&t.options.shareContentLoadSettings!==!1,r=null,u=["id","source","context","bindProgressState","bindingSource","bindingTarget","bindingPath","element","getBoundProperties","boundContentFragment","parentBinding","parentBindingKey","getChildBindings","bind","bindAsync","dispose","getBoundContent","removeChildBinding","changeBoundPropertyValue"];return i==null?r=new EVUI.Modules.Binding.BindingTemplate:(r=new EVUI.Modules.Binding.BindingTemplate(i),u.push("templateName")),r=EVUI.Modules.Core.Utils.shallowExtend(r,n,u),r.options=f===!0?t.options:EVUI.Modules.Core.Utils.deepExtend(new EVUI.Modules.Binding.BindOptions,r.options),r.contentLoadSettings=e===!0?t.binding.contentLoadSettings:EVUI.Modules.Core.Utils.deepExtend(new EVUI.Modules.Binding.BindingContentLoadSettings,r.contentLoadSettings),r},be=function(n,t){var l,w,r,a;if(EVUI.Modules.Core.Utils.isElement(n)===!1)return null;var f=ke(n),i={},s=f.sourcePath,e=f.mode,h=f.key,v=f.templateName,c=f.src,y=f.elementTemplateName;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(s)===!1&&(i.bindingPath=s),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(e)===!1){var e=e.toLowerCase(),u=EVUI.Modules.Binding.BindingInsertionMode,p=[u.Append,u.Fragment,u.InsertAfter,u.InsertBefore,u.Prepend,u.ReplaceChildren,u.Shadow],b=p.length;for(r=0;r<b;r++)if(l=p[r],e.indexOf(l)!==-1){i.insertionMode=l;break}e.indexOf(EVUI.Modules.Binding.BindingMode.Merge)!==-1?i.bindingMode=EVUI.Modules.Binding.BindingMode.Merge:e.indexOf(EVUI.Modules.Binding.BindingMode.Overwrite)!==-1&&(i.bindingMode=EVUI.Modules.Binding.BindingMode.Overwrite)}if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(h)===!1&&(i.htmlContent=h),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(v)===!1&&(i.templateName=v),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(y)===!1&&t!=null&&EVUI.Modules.Core.Utils.isArray(t.currentState.source[s])&&(i.templateName=y),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(c)===!1&&(typeof i.htmlContent=="string"?(i.htmlContent={},i.htmlContent.key=h):i.htmlContent={},i.htmlContent.url=c,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.htmlContent.key)===!0))for(w=o.length,r=0;r<w;r++)if(a=o[r],a.url===c){i.htmlContent=a;break}return i},ke=function(n){if(n==null)return null;var t=new lo;return t.key=n.getAttribute(EVUI.Modules.Binding.Constants.Attr_HtmlContentKey),t.mode=n.getAttribute(EVUI.Modules.Binding.Constants.Attr_Mode),t.templateName=n.getAttribute(EVUI.Modules.Binding.Constants.Attr_BindingTemplate),t.sourcePath=n.getAttribute(EVUI.Modules.Binding.Constants.Attr_BoundObj),t.src=n.getAttribute(EVUI.Modules.Binding.Constants.Attr_HtmlContentUrl),t.elementTemplateName=n.getAttribute(EVUI.Modules.Binding.Constants.Attr_ElementBindingTemplate),t},de=function(n,t){var f,i,r,u;if(typeof n=="object")return(n.needsRecalcuation===!0||n.contentMetata==null)&&(n.contentMetata=cr(n.content,t)),n.contentMetata;for(f=bt.length,i=0;i<f;i++)if(r=bt[i],r.html===n)return r;return u=cr(n,t),bt.push(u),u},cr=function(n,t){var i=new bo,r;return i.html=n,r=u.domTreeConverter.htmlToDomTree(n,nt(t.bindingHandle)),r.search(function(n){var s,t,f,o,h,r,u;if(n.attrs!=null)for(s=n.attrs.length,t=0;t<s;t++)if(f=n.attrs[t],f.val.indexOf("{{")!==-1)for(o=ui(f.val),h=o.length,r=0;r<h;r++)u=o[r],i.attributePaths[u.path]==null&&(i.attributePaths[u.path]=e+u.path+e)}),i},ge=function(n,t){var p,s,w,h,r,i,c,u,f,o,d,l;if(typeof t.content=="string"&&(p=lr(t.content),t.content=p.content),s=new dr,t.attrs==null)return s;for(w=t.attrs.length,h=0;h<w;h++){r=t.attrs[h];i=new gr;i.name=r.key;var b=r.val.split(/\s+/),nt=r.key.toLowerCase(),g=b.length,e="",k="";for(c=0;c<g;c++){for(u=new fi,i.values.push(u),f=lr(b[c]),e+=" "+f.content,u.value=f.content,o=f.content,d=f.paths.length,l=0;l<d;l++){i.containsBoundValues=!0;u.wasBound=!0;var a=f.paths[l],v=n.boundPropertyDictionary[a],y=new nu;y.boundContent=v==null?"":v.value;y.boundPath=a;o=o.replace(v.value,"{{"+a+"}}");u.boundValues.push(y)}u.tokenizedString=o;k+=" "+o}e=e.trim();r.val=e;i.value=e;i.tokenizedValue=k.trim();s.attributes[r.key]=i}return s},lr=function(n){var u,i,f,t,r,o;if(typeof n!="string"||n.length===0)return{paths:[],content:n};for(u=[],i=n.indexOf(e);i!==-1;){if(f=n.indexOf(e,i+1),f===-1)break;t=n.substring(i,f+pt);r=et[t];r==null&&(r=new RegExp(t.replace(si,function(n){return"\\"+n}),"g"),et[t]=r);n=n.replace(r,"");o=t.substring(pt,t.length-pt);o.length>0&&u.push(o);i=n.indexOf(e)}return{paths:u,content:n}},ar=function(n){return n[e]},ut=function(n,i){var e,u,o,h,c;if(n==null)return null;var f=new ho(no()),r=null,s=!1,a=typeof n;if(a==="string")if(u=tt(n),u!=null)r=b(u,i),s=!0;else return null;return a!=="object"&&r==null?null:(EVUI.Modules.Core.Utils.instanceOf(n,EVUI.Modules.Binding.Binding)===!0&&(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.templateName)===!1?(u=tt(n.templateName),u!=null?(u=EVUI.Modules.Core.Utils.shallowExtend({},u),u=EVUI.Modules.Core.Utils.shallowExtend(u,n),r=b(u,i)):r=t.addBindingTemplate(n),s=!0):r=b(n,i)),o=null,EVUI.Modules.Core.Utils.isElement(n.element)?o=n.element:EVUI.Modules.Core.Utils.isElement(n.bindingTarget)&&(o=n.bindingTarget),e=be(o,i),e!=null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(e.templateName)===!1&&(n.templateName=e.templateName),s===!1&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.templateName)===!1&&(u=tt(n.templateName),u==null?r=t.addBindingTemplate(n):(u=EVUI.Modules.Core.Utils.shallowExtend({},u),u=EVUI.Modules.Core.Utils.shallowExtend(u,n),r=b(u,i),s=!0)),e!=null&&(r!=null?r=EVUI.Modules.Core.Utils.shallowExtend(r,e,function(n,t){if(t[n]==null)return!0}):n=EVUI.Modules.Core.Utils.shallowExtend(n,e)),r==null&&(r=b(n,i)),s===!1&&i!=null&&(u=tt(i.templateName),u!=null?(u=EVUI.Modules.Core.Utils.shallowExtend({},u),r=b(u,i)):i.htmlContent!=null&&r.htmlContent==null&&(r.htmlContent=i.htmlContent.item),i.options.recursiveEvents===!0&&(r.onBind=i.binding.onBind,r.onBindChildren=i.binding.onBindChildren,r.onBindHtmlContent=i.binding.onBindHtmlContent,r.onBound=i.binding.onBound,r.onChildrenBound=i.binding.onChildrenBound,r.onSetBindings=i.binding.onSetBindings,r.onSetHtmlContent=i.binding.onSetHtmlContent)),f.id=iu++,f.currentState=new l,f.binding=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Binding.Binding(f),r,["templateName"]),f.progressState=EVUI.Modules.Binding.BindingProgressStateFlags.Idle,f.templateName=r.templateName,f.htmlContent=typeof r.htmlContent=="object"?r.htmlContent:f.htmlContent,o=n.bindingTarget==null?n.element:n.bindingTarget,h=n.bindingSource==null?n.source:n.bindingSource,o!=null&&f.currentState.element==null&&(f.currentState.element=at(o)),h!=null&&f.binding.source==null&&typeof h=="object"?f.binding.source=h:e!=null&&e.bindingPath!=null&&(c=null,c=i!=null?EVUI.Modules.Core.Utils.getValue(e.bindingPath,i.currentState.source):EVUI.Modules.Core.Utils.getValue(e.bindingPath,window),c!=null&&(f.binding.source=c)),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.htmlContent)===!1&&(f.currentState.htmlContent=r.htmlContent),f)},no=function(){var n=new pr;return n.controller=t,n.triggerDispose=v,n.triggerBind=dt,n.validateElement=to,n.getValidElement=at,n.triggerUpdate=ci,n.toDomNode=s,n.bubblingEvents=new EVUI.Modules.EventStream.BubblingEventManager,n},to=function(n){return n==null?!0:typeof n=="string"&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1?!0:n instanceof DocumentFragment?!0:EVUI.Modules.Core.Utils.isElement(n)===!0?!0:!1},at=function(n,t){if(n instanceof DocumentFragment||t!==!0&&typeof n=="string"&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1||EVUI.Modules.Core.Utils.isElement(n)===!0)return n;var i=EVUI.Modules.Core.Utils.getValidElement(n);return i!=null?i:n instanceof EVUI.Modules.Dom.DomHelper?n.elements[0]:null},ui=function(n){var t,i,f;if(typeof n!="string")return[];for(var r=[],e=n.length,u=0;u<e;){if(t=n.indexOf("{{",u),t==-1)break;if(i=n.indexOf("}}",t),i==-1)break;(u=i,f=n.substring(t+2,i),r.indexOf(f)===-1)&&r.push(f)}return r.map(function(n){var t=new so;return t.path=n,t})},io=function(n,t,i,r){var o,c,s,f,u,h,e;if(i==null||i.length===0)return t;if(typeof t!="string")return null;for(o=t,c=i.length,s=0;s<c;s++)if(f=i[s],f.value!==undefined){u=null;u=typeof f.value=="function"?ro(n,f):f.value;u==null?u="":(u=u.toString(),n.bindingHandle.options.noHtmlInjection===!0&&(u=u.replace(/\<|\>/g,function(n){return n==="<"?"&lt;":n===">"?"&gt;":n})));h=r.attributePaths[f.path];h!=null&&(u+=h);try{e=et[f.path];e==null&&(e=new RegExp("{{"+f.path.replace(si,function(n){return"\\"+n})+"}}","g"),et[f.path]=e);o=o.replace(e,u)}catch(l){EVUI.Modules.Core.Utils.log(l)}}return o},vt=function(n){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return n;var n=n.replace(/\.|\[|\]\.|\]/g,".");return n.endsWith(".")===!0&&(n=n.substring(0,n.length-1)),n},vr=function(n,t){return EVUI.Modules.Core.Utils.getHashCode(su+n.bindingHandle.id+":"+t.path).toString(36)},ro=function(n,t){var i;if(typeof t.value!="function")return null;var f=t.value,u=vr(n,t),e="$evui.dispatch(event, `"+u+"`)",r=EVUI.Modules.Binding.BindingController.BoundEvents[u];if(r!=null){if(r.handler===f)return e;n.rollbackDispatchHandles.push(r);r.dispose()}return i=new kr,i.handler=f,i.id=fu,i.binding=n.bindingHandle,i.path=t.path,i.hashKey=u,i.invocationHandle=function(n){var t=uo(i,n),e;if(t==null&&(t=new vo,t.currentTarget=n.currentTarget,t.eventName=n.type,i.invocationSites.push(t)),i.binding.options.eventContextMode===EVUI.Modules.Binding.BoundEventContextMode.ParentObject){var u=vt(i.path),f=u.lastIndexOf("."),r=null;return f===-1?r=i.binding.currentState.source:(e=u.substring(0,f),r=EVUI.Modules.Core.Utils.getValue(e,i.binding.currentState.source)),r==null&&(r=window),i.handler.call(r,n,i.binding.binding)}if(i.binding.options.eventContextMode===EVUI.Modules.Binding.BoundEventContextMode.Element)return i.handler.call(n.currentTarget,n,i.binding.binding);throw Error("Invalid eventContextMode: "+i.binding.options.eventContextMode);},EVUI.Modules.Binding.BindingController.BoundEvents[i.hashKey]=i,n.bindingHandle.dispatchHandles.push(i),e},uo=function(n,t){for(var i,u=n.invocationSites.length,r=0;r<u;r++)if(i=n.invocationSites[r],i.eventName===t.type&&i.currentTarget===t.currentTarget)return i;return null},fo=function(n,t){var i=EVUI.Modules.Binding.BindingController.BoundEvents[t],r;if(i==null){r="Dispatch function for event "+n.type+" element "+eo(n.currentTarget)+" could not be found.";EVUI.Modules.Core.Utils.log(r);return}return i.invocationHandle(n,i.binding)};Object.defineProperty($evui,"dispatch",{get:function(){return fo},enumerable:!1});var eo=function(n){var t=n.tagName.toLowerCase();EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.id)===!1&&(t+="#"+n.id);EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.className)===!1&&(t+="."+n.className.trim().replace(/\s/g,"."));t},oo=function(){EVUI.Modules.Core.Utils.cacheProperties(new l)},so=function(){this.path=null},yr=function(){this.item=null;this.key=null;this.url=null;this.content=null;this.needsRecalcuation=!0;this.tokenMappings=null;this.pending=!1;this.loaded=!1;this.failed=!1;this.ignoreUrl=!1;this.pendingCallbacks=[];this.contentMetata=null},ho=function(n){if(n instanceof pr==!1)throw Error("Invalid parameters.");this.wrapper=n;this.id=null;this.progressState=EVUI.Modules.Binding.BindingProgressStateFlags.Idle;this.templateName=null;this.options=null;this.binding=null;this.currentState=null;this.oldState=null;this.pendingState=null;this.disposing=!1;this.newStateBound=!1;this.oldStateBound=!1;this.dispatchHandles=[];this.canceledDuringReBind=!1;this.htmlContent=null;this.completionState=EVUI.Modules.Binding.BindingCompletionState.None},l=function(){this.stateId=ru++;this.htmlContent=null;this.parentBindingHandle=null;this.element=null;this.parentBindingKey=null;this.parentBindingPath=null;this.childBindingHandles=[];this.source=null;this.sourceHashCode=null;this.sourceObserver=null;this.arrayObserver=null;this.boundProperties=null;this.mergedHtmlContent=null;this.boundContentFragment=null;this.boundContentTree=null;this.boundContent=null;this.elementSet=!1;this.sourceSet=!1;this.htmlContentSet=!1;this.boundTemplateContentClone=null;this.normalizedPath=null};l.prototype.getNormalizedPath=function(){return vt(this.parentBindingPath)};var pr=function(){this.controller=null;this.triggerBind=null;this.triggerDispose=null;this.triggerUpdate=null;this.validateElement=null;this.toDomNode=null;this.bubblingEvents=null},wr=function(){this.sessionId=uu++;this.bindingHandle=null;this.bindingArgs=null;this.eventStream=null;this.callbacks=[];this.cancel=!1;this.originalBoundProps=[];this.childSessions=[];this.context={};this.maintainCurrentState=!1;this.observedDifferences=null;this.oldStateDictionary=null;this.shouldReBind=!0;this.parentSession=null;this.lastInsertedNode=null;this.isArray=!1;this.batchId=-1;this.sessionMode=ft.None;this.rollbackState=null;this.rollbackPendingState=null;this.rollbackDispatchHandles=[];this.boundPropertyDictionary={}},co=function(){this.session=null;this.flags=yt.None},yt={None:0,SameBinding:1,SameElement:2,SameSource:4},br=function(){this.id=-1;this.callback=null;this.session=null},lo=function(){this.templateName=null;this.key=null;this.sourcePath=null;this.src=null;this.mode=null;this.elementTemplateName=null},ao=function(){this.element=null;this.source=null;this.path=null},ft={None:0,Bind:1,Update:2},kr=function(){this.hashKey=null;this.path=null;this.binding=null;this.handler=null;this.invocationSites=[];this.invocationHandle=function(){}};kr.prototype.dispose=function(){for(var u=this.invocationSites.length,t=0;t<u;t++){var n=this.invocationSites[t],i="on"+n.eventName,r=n.currentTarget[i];r!=null&&r.toString().indexOf(this.hashKey)!==-1&&(n.currentTarget[i]=null,n.currentTarget.removeAttribute(i))}this.invocationSites=[];EVUI.Modules.Binding.BindingController.BoundEvents[this.hashKey]===this&&delete EVUI.Modules.Binding.BindingController.BoundEvents[this.hashKey]};var vo=function(){this.eventName=null;this.currentTarget=null},i={None:0,Added:1,Removed:2,Swapped:3,Shifted:4,Moved:5},yo=function(){this.isArray=!1;this.modifiedPaths={};this.unchangedBindings=[]},po=function(){this.index=-1;this.binding=null;this.contentsModified=!1;this.bindingStructureChangeType=i.None;this.moveSwapTarget=null;this.applied=!1},it=function(n){this.normalizedPath=n;this.bindings=[];this.numBindings=0};it.prototype.addBinding=function(n,t){var i=new wo(n);return i.index=t,this.numBindings=this.bindings.push(i),i};it.prototype.getNextUnprocessedBinding=function(){for(var t,n=0;n<this.numBindings;n++)if(t=this.bindings[n],t.processed===!1)return t;return null};it.prototype.makeChangeArray=function(n){for(var r,t,u=[],i=0;i<this.numBindings;i++)r=this.bindings[i],t=new po,t.binding=r.binding,t.index=r.index,t.bindingStructureChangeType=typeof n=="function"?n(t):n,u.push(t);return u};it.prototype.merge=function(n){var i,t;if(n!=null)for(i=n.numBindings,t=0;t<i;t++)this.bindings.push(n.bindings[t]),this.numBindings++};var wo=function(n){this.binding=n;this.index=-1;this.processed=!1;this.stateToCheck=null},bo=function(){this.html=null;this.attributePaths={}},dr=function(){this.attributes={}};dr.prototype.getAttributeMetadata=function(n){return this.attributes[n]};var gr=function(){this.name=null;this.containsBoundValues=!1;this.value=null;this.tokenizedValue=null;this.values=[]},fi=function(){this.value=null;this.wasBound=!1;this.tokenizedString=null;this.boundValues=[]},nu=function(){this.boundContent=null;this.boundPath=null},ko=function(){this.templateName=null},tu=function(){this.id=eu++;this.batchContainer=null;this.sessions=[];this.numSessions=0;this.numComplete=0},ei=function(){this.numBatches=0;this.batches=[];this.currentBatch=null;this.parentContainer=null;this.childContainers=null;this.numChildContainers=0};oo();hu()};Object.defineProperty(EVUI.Modules.Binding.BindingController,"BoundEvents",{value:{},writable:!1,enumerable:!0,configuable:!1});EVUI.Modules.Binding.BindingHtmlContent=function(n){if(n==null||typeof n.key!="string")throw Error("Invalid constructor arguments.");var t=n;this.key=null;Object.defineProperty(this,"key",{get:function(){return t.key},configurable:!1,enumerable:!0});this.url=null;Object.defineProperty(this,"url",{get:function(){return t.url},configurable:!1,enumerable:!0});this.content=null;Object.defineProperty(this,"content",{get:function(){return t.content},set:function(n){if(typeof n!="string"&&n!=null)throw Error("content must be a string.");t.content!==n&&(t.needsRecalcuation=!0,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1&&t.loaded===!0&&(t.ignoreUrl=!0),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)==!0&&(t.ignoreUrl=!1,t.loaded=!1),t.content=n)},configurable:!1,enumerable:!0})};EVUI.Modules.Binding.Binding=function(n){if(n==null||n.wrapper==null)throw Error("Invalid constructor arguments");var t=n,i=this;this.id=null;Object.defineProperty(this,"id",{get:function(){return t.id},configurable:!1,enumerable:!0});this.templateName=null;Object.defineProperty(this,"templateName",{get:function(){return t.templateName},configurable:!1,enumerable:!0});this.element=null;Object.defineProperty(this,"element",{get:function(){return t.pendingState!=null&&t.pendingState.elementSet===!0?t.pendingState.element:t.currentState.element},set:function(n){if(n!==t.currentState.element){if(t.progressState!=EVUI.Modules.Binding.BindingProgressStateFlags.Idle)throw Error("Cannot change the element of a Binding that is queued or in progress.");if(t.wrapper.validateElement(n)===!1)throw Error("Failed to set element - must be null, a non-whitespace string, a DocumentFragment, or an Element.");t.newStateBound===!0||t.pendingState!=null?(t.pendingState==null&&(t.pendingState={}),t.pendingState.elementSet=!0,t.pendingState.element=n):(t.currentState.element=n,t.currentState.elementSet=!0)}},configurable:!1,enumerable:!0});this.bindingProgressState=EVUI.Modules.Binding.BindingProgressStateFlags.Idle;Object.defineProperty(this,"bindingProgressState",{get:function(){return t.progressState},configurable:!1,enumerable:!0});this.bindingCompletionState=EVUI.Modules.Binding.BindingCompletionState.None;Object.defineProperty(this,"bindingCompletionState",{get:function(){return t.completionState},configurable:!1,enumerable:!0});this.source=null;Object.defineProperty(this,"source",{get:function(){return t.pendingState!=null&&t.pendingState.sourceSet===!0?t.pendingState.source:t.currentState.source},set:function(n){if(n!=null&&typeof n!="object")throw Error("source must be an object.");if(n!==t.currentState.source){if(t.progressState!=EVUI.Modules.Binding.BindingProgressStateFlags.Idle)throw Error("Cannot change the source object reference of a Binding that is queued or in progress.");t.newStateBound===!0||t.pendingState!=null?(t.pendingState==null&&(t.pendingState={}),t.pendingState.source=n,t.pendingState.sourceSet=!0):(t.currentState.source=n,t.currentState.sourceSet=!0)}},configurable:!1,enumerable:!0});this.htmlContent=null;Object.defineProperty(this,"htmlContent",{get:function(){return t.pendingState!=null&&t.pendingState.htmlContentSet===!0?t.pendingState.htmlContent:t.currentState.htmlContent},set:function(n){if(n!==t.currentState.htmlContent){if(EVUI.Modules.Core.Utils.hasFlag(t.progressState,EVUI.Modules.Binding.BindingProgressStateFlags.GotHtmlContent))throw Error("Cannot change the htmlContent of a Binding that has already been Bound.");var i=null;if(t.newStateBound===!0||t.pendingState!=null?(t.pendingState==null&&(t.pendingState={}),i=t.pendingState):i=t.currentState,n!=null&&typeof n!="string")if(n instanceof EVUI.Modules.Binding.BindingHtmlContent||n!=null&&typeof n=="object")n.item!=null&&(n=n.item),i.htmlContent=n,i.htmlContentSet=!0;else if(EVUI.Modules.Core.Utils.isElement(n)===!0)i.htmlContent=n,i.htmlContentSet=!0;else throw Error("template must be a string, Element, or BindingTemplateCaheItem.");else i.htmlContent=n,i.htmlContentSet=!0}}});this.options=null;Object.defineProperty(this,"options",{get:function(){return t.options},set:function(n){if(typeof n=="object")if(n==null)throw Error("options must be an object.");else t.options=EVUI.Modules.Core.Utils.deepExtend(new EVUI.Modules.Binding.BindOptions,n);else throw Error("options must be an object.");}});this.contentLoadSettings=null;this.bindingMode=EVUI.Modules.Binding.BindingMode.Merge;this.insertionMode=EVUI.Modules.Binding.BindingInsertionMode.Default;this.getBoundProperties=function(){for(var i,r,f=t.currentState!=null&&t.currentState.boundProperties!=null?t.currentState.boundProperties.length:0,u=[],n=0;n<f;n++)i=t.currentState.boundProperties[n],r=new EVUI.Modules.Binding.BoundProperty(i.path),r.value=i.value,u.push(r);return u};this.changeBoundPropertyValue=function(n,i){var f,r,u;if(typeof n!="string")throw Error("String expected.");for(f=t.currentState!=null&&t.currentState.boundProperties!=null?t.currentState.boundProperties.length:0,r=0;r<f;r++)if(u=t.currentState.boundProperties[r],u.path===n)return u.value=i,!0;return!1};this.boundContentFragment=null;Object.defineProperty(this,"boundContentFragment",{get:function(){return t.currentState.boundContentFragment!=null?t.currentState.boundContentFragment:(t.currentState.boundContentTree!=null&&t.newStateBound===!1&&(t.currentState.boundContentFragment=t.wrapper.toDomNode(t.currentState.boundContentTree,t)),t.currentState.boundContentFragment)},configurable:!1,enumerable:!0});this.parentBinding=null;Object.defineProperty(this,"parentBinding",{get:function(){return t.currentState.parentBindingHandle!=null?t.currentState.parentBindingHandle.binding:null},configurable:!1,enumerable:!0});this.parentBindingKey=null;Object.defineProperty(this,"parentBindingKey",{get:function(){return t.currentState.parentBindingKey},configurable:!1,enumerable:!0});this.getChildBindings=function(){for(var i=[],r=t.currentState!=null&&t.currentState.childBindingHandles!=null?t.currentState.childBindingHandles.length:0,n=0;n<r;n++)i.push(t.currentState.childBindingHandles[n].binding);return i};this.removeChildBinding=function(n){var r,u,i,f;if(n==null)return!1;for(r=!1,u=t.currentState!=null&&t.currentState.childBindingHandles!=null?t.currentState.childBindingHandles.length:0,i=0;i<u;i++)if(f=t.currentState.childBindingHandles[i].binding,n.id===binding.id&&f===n){r=!0;break}return r===!1?!1:(n.dispose(),!0)};this.getBoundContent=function(){for(var i=[],r=t.currentState.boundContent.length,n=0;n<r;n++)i.push(t.currentState.boundContent[n]);return i};this.bind=function(n,i){typeof n=="function"&&i==null&&(i=n);(n==null||typeof n=="function")&&(n=new EVUI.Modules.Binding.BindArgs,n.bindingTarget=this.element,n.bindingSource=this.source);t.wrapper.triggerBind(t,n,null,i)};this.bindAsync=function(n){return new Promise(function(t){i.bind(n,function(){t(i)})})};this.update=function(n,i){t.wrapper.triggerUpdate(t,n,null,i)};this.updateAsync=function(n){return new Promise(function(t){i.update(n,function(){t(i)})})};this.applyBindingTemplate=function(n){if(t.progressState!==EVUI.Modules.Binding.BindingProgressStateFlags.Idle)throw Error("Cannot set the BindingTemplate of a Binding in progress.");var i=null;if(typeof n=="string"){if(i=EVUI.Modules.Binding.Binder.getBindingTemplate(n),i==null)return!1}else if(n!=null&&typeof n=="object")i=n;else throw Error("String or object expected.");return EVUI.Modules.Core.Utils.shallowExtend(this,i,["templateName"]),t.templateName=n,!0};this.dispose=function(){return t.wrapper.triggerDispose(t)};this.onBind=null;this.onSetHtmlContent=null;this.onSetBindings=null;this.onBindHtmlContent=null;this.onBindChildren=null;this.onChildrenBound=null;this.onBound=null;this.addEventListener=function(n,i,r){return EVUI.Modules.Core.Utils.isObject(r)===!1&&(r=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),r.eventType=EVUI.Modules.EventStream.EventStreamEventType.Event,t.wrapper.bubblingEvents.addEventListener(n,i,r)};this.removeEventListener=function(n,i){return t.wrapper.bubblingEvents.removeEventListener(n,i)}};EVUI.Modules.Binding.Binding.prototype.search=function(n,t,i){var e,r,u;if(typeof n!="function")throw Error("Function expected.");typeof t!="boolean"&&(t=!1);typeof i!="boolean"&&(i=!1);var f=[],o=this.getChildBindings(),s=o.length;for(e=0;e<s;e++){if(r=o[e],n(r)===!0){if(i===!0)return r;f.push(r)}if(t===!0&&(u=r.search(n,t,i),u!=null)){if(i===!0)return u;u.length>0&&(f=f.concat(u))}}return i===!0?null:f};EVUI.Modules.Binding.Binding.prototype.getRootBinding=function(){for(var n=this.parentBinding,t;n!=null;){if(t=n.parentBinding,t==null)return n;n=t}return n};EVUI.Modules.Binding.BoundProperty=function(n){this.path=n;this.value=null};EVUI.Modules.Binding.BindingTemplate=function(n){var t=n;this.templateName=null;t!=null&&Object.defineProperty(this,"templateName",{get:function(){return t.templateName},enumerable:!0,configurable:!1});this.htmlContent=null;this.options=null;this.contentLoadSettings=null;this.bindingMode=EVUI.Modules.Binding.BindingMode.Merge;this.insertionMode=EVUI.Modules.Binding.BindingInsertionMode.Default;this.onBind=null;this.onSetHtmlContent=null;this.onSetBindings=null;this.onBindHtmlContent=null;this.onBindChildren=null;this.onChildrenBound=null;this.onBound=null};EVUI.Modules.Binding.BindArgs=function(){this.bindingTarget=null;this.bindingSource=null;this.templateName=null;this.bindingContext=null};EVUI.Modules.Binding.UpdateArgs=function(){this.bindingSource=null;this.bindingContext=null};EVUI.Modules.Binding.BindingContentLoadSettings=function(){this.httpRequestArgs=null};EVUI.Modules.Binding.BindOptions=function(){this.recursive=!0;this.noHtmlInjection=!1;this.recursiveEvents=!0;this.suppressChildEvents=!1;this.shareOptions=!0;this.shareContentLoadSettings=!0;this.nodeCreation=null;this.scopedCSSSelectors=!0;this.addMissingHtmlContent=!0;this.enumerateArrays=!0;this.shareContextMode=EVUI.Modules.Binding.ShareContextMode.ShareReference;this.eventContextMode=EVUI.Modules.Binding.BoundEventContextMode.Element};EVUI.Modules.Binding.BinderEventArgs=function(n){var t=n;this.binding=t.bindingHandle.binding;this.reBinding=t.bindingHandle.oldStateBound;this.eventName=null;this.eventType=null;this.pause=function(){};this.resume=function(){};this.cancel=function(){};this.stopPropagation=function(){};this.context={}};EVUI.Modules.Binding.BindingMode={Merge:"merge",Overwrite:"overwrite"};Object.freeze(EVUI.Modules.Binding.BindingMode);EVUI.Modules.Binding.BindingInsertionMode={Default:"default",Append:"append",Prepend:"prepend",InsertBefore:"before",InsertAfter:"after",Shadow:"shadow",Fragment:"fragment",ReplaceChildren:"replace"};Object.freeze(EVUI.Modules.Binding.BindingInsertionMode);EVUI.Modules.Binding.ShareContextMode={NewContext:"cxt-new",ShareReference:"cxt-ref",Clone:"cxt-clone"};Object.freeze(EVUI.Modules.Binding.ShareContextMode);EVUI.Modules.Binding.BindingProgressStateFlags={Idle:0,Queued:1,GotElement:2,GotHtmlContent:4,GotBoundProperties:8,BoundHtmlContent:16,GotChildren:32,BindingChildren:64,BoundChildren:128,Injected:256};Object.freeze(EVUI.Modules.Binding.BindingProgressStateFlags);EVUI.Modules.Binding.BoundEventContextMode={Element:"element",ParentObject:"parent"};Object.freeze(EVUI.Modules.Binding.BoundEventContextMode);EVUI.Modules.Binding.BindingCompletionState={None:"none",Queued:"queued",Executing:"executing",Success:"success",Canceled:"canceled",Failed:"failed",Disposed:"disposed"};Object.freeze(EVUI.Modules.Binding.BindingCompletionState);EVUI.Modules.Binding.BindingControllerServices=function(){this.httpManager=null;this.domTreeConverter=null;this.diffController=null};EVUI.Modules.Binding.Binder=null,function(){var n=null,t=EVUI.Modules.Binding.BindingController;Object.defineProperty(EVUI.Modules.Binding,"Binder",{get:function(){return n==null&&(n=new t),n},configurable:!1,enumerable:!0})}();EVUI.Constructors.Binding=EVUI.Modules.Binding.BindingController;Object.freeze(EVUI.Modules.Binding);delete $evui.binder;$evui.binder=null;Object.defineProperty($evui,"binder",{get:function(){return EVUI.Modules.Binding.Binder},enumerable:!0});$evui.bind=function(n,t,i){return $evui.binder.bind(n,t,i)};$evui.bindAsync=function(n,t){return $evui.binder.bindAsync(n,t)};$evui.addBindingTemplate=function(n){return $evui.binder.addBindingTemplate(n)};$evui.addBindingHtmlContent=function(n,t,i){return $evui.binder.addHtmlContent(n,t,i)};$evui.removeBindingTemplate=function(n){return $evui.binder.removeBindingTemplate(n)};$evui.removeBindingHtmlContent=function(n){return $evui.binder.removeHtmlContent(n)};Object.freeze(EVUI.Modules.Binding);EVUI.Modules.Core={};EVUI.Modules.Core.Settings={};$evui.settings=EVUI.Modules.Core.Settings;Object.defineProperty($evui,"settings",{get:function(){return EVUI.Modules.Core.Settings},enumerable:!0});EVUI.Modules.Core.Settings.loggingEnabled=!0;EVUI.Modules.Core.Settings.alternateLoggingFunction=function(){};EVUI.Modules.Core.Settings.stepsBetweenWaits=250;EVUI.Modules.Core.Settings.defaultMinimumZIndex=100;EVUI.Modules.Core.Constants={};EVUI.Modules.Core.Constants.Fn_Init=function(){};EVUI.Modules.Core.Constants.Fn_InitAsync=function(){};EVUI.Modules.Core.Constants.Fn_ExecutorCallback=function(){};EVUI.Modules.Core.Constants.Fn_ExtendPropertyFilter=function(){};EVUI.Modules.Core.Constants.Fn_DeepExtendPropertyFilter=function(){};EVUI.Modules.Core.Constants.Fn_DeepExtendRecursionFilter=function(){};EVUI.Modules.Core.Constants.Symbol_ObjectProperties="evui-property-list",function(){typeof Symbol!="undefined"&&(EVUI.Modules.Core.Constants.Symbol_ObjectProperties=Symbol("evui-property-list"))}();EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers="evui-proto-list",function(){typeof Symbol!="undefined"&&(EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers=Symbol("evui-proto-list"))}();Object.freeze(EVUI.Modules.Core.Constants);EVUI.Modules.Core.AsyncSequenceExecutionArgs=function(){this.functions=null;this.parameter=null;this.forceCompletion=!1};EVUI.Modules.Core.AsyncSequenceExecutor=function(){var t=function(){},i=function(){this.functions=null;this.parameter=null;this.index=0;this.callback=null;this.forceCompletion=!1;this.errors=null},n=function(t){var u=r(t),i;if(u==null)return t.callback(t.errors);try{i=u(t.parameter);EVUI.Modules.Core.Utils.isPromise(i)===!0?(i.then(function(){n(t)}),i.catch(function(i){EVUI.Modules.Core.Utils.log(i);t.errors.push(i);t.forceCompletion===!0?n(t):t.callback(t.errors)})):n(t)}catch(f){EVUI.Modules.Core.Utils.log(f);t.errors.push(f);t.forceCompletion===!0?n(t):t.callback(t.errors)}},r=function(n){var t=n.functions[n.index];return n.index++,t};return t.prototype.execute=function(t,r){var e=typeof t,f,u;if(typeof t==null||e!=="object")throw Error("Object expected.");if(EVUI.Modules.Core.Utils.isArray(t)===!0)f=t,t=new EVUI.Modules.Core.AsyncSequenceExecutionArgs,t.functions=f;else if(typeof t=="function")f=[t],t=new EVUI.Modules.Core.AsyncSequenceExecutionArgs,t.functions=f;else if(typeof t=="object"&&t!=null)EVUI.Modules.Core.Utils.isArray(t.functions)===!1&&(t.functions=[t.functions]);else throw Error("Function, Array of Functions, or Object expected.");typeof r!="function"&&(r=function(){});u=new i;u.functions=t.functions.filter(function(n){return typeof n=="function"});u.index=0;u.callback=r;u.parameter=t.parameter;u.forceCompletion=t.forceCompletion===!0?!0:!1;u.errors=[];n(u)},t.prototype.executeAsync=function(n){return new Promise(function(i){t.prototype.execute(n,function(n){i(n)})})},new t}();$evui.executeSequence=function(n,t){return EVUI.Modules.Core.AsyncSequenceExecutor.execute(n,t)};$evui.executeSequenceAsync=function(n){return EVUI.Modules.Core.AsyncSequenceExecutor.executeAsync(n)};EVUI.Modules.Core.Initializers=EVUI.Modules.Core==null?[]:EVUI.Modules.Core.Initializers;EVUI.Modules.Core.Initializers==null&&(EVUI.Modules.Core.Initializers=[]),function(){var t=!1,u=null,i=!1,n=!1,r=!1;typeof window!="undefined"?(document.addEventListener("DOMContentLoaded",function(){n=!0}),window.addEventListener("load",function(){n=!0})):n=!0;EVUI.Modules.Core.Initialize=function(f){if(typeof f!="function")throw Error("Function expected.");return EVUI.Modules.Core.Initializers.push(f),new Promise(function(f,e){var s=typeof window!="undefined",h=function(n){return(i=!1,n==null||EVUI.Modules.Core.Utils.isArray(n)===!0&&n.length===0)?f():e(n)},o=function(){s===!0&&(document.removeEventListener("DOMContentLoaded",o),window.removeEventListener("load",o),r=!1);n=!0;setTimeout(function(){var f,n,r;t===!1?(t=!0,f=EVUI.Modules.Core.Initializers.splice(0,EVUI.Modules.Core.Initializers.length),n=new EVUI.Modules.Core.AsyncSequenceExecutionArgs,n.functions=f,EVUI.Modules.Core.AsyncSequenceExecutor.execute(n,function(n){return i=!0,u=n,t=!1,h(n)})):(r=function(){setTimeout(function(){if(i===!0)return h(u);r()})},r())},10)};n===!0?o():s===!0&&r===!1?(document.addEventListener("DOMContentLoaded",o),window.addEventListener("load",o),r=!0):o()})}}();$evui.init=function(n){return EVUI.Modules.Core.Initialize(n)};EVUI.Modules.Core.CaseInsensitiveObject=function(n){var i,u,t,r;if(n!=null&&typeof n=="object"&&!(n instanceof Node))for(i=EVUI.Modules.Core.Utils.getProperties(n),u=i.length,t=0;t<u;t++)r=i[t],this[r]=n[r]};EVUI.Modules.Core.CaseInsensitiveObject.prototype.getValue=function(n){var r,f,t,i,u;if(typeof n!="string"&&typeof n!="number")return undefined;if(this[n]!==undefined||typeof n=="string"&&(n=n.toLowerCase(),this[n]!==undefined))return this[n];for(r=Object.keys(this),f=r.length,t=0;t<f;t++)if(i=r[t],u=typeof i=="string"?i.toLowerCase():u,u===n)return this[i];return undefined};EVUI.Modules.Core.CaseInsensitiveObject.prototype.setValue=function(n,t){var e,u,o,r,i,f;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0&&typeof n!="number")return!1;if(e=typeof i=="string"?n.toLowerCase():n,typeof n=="string")for(u=Object.keys(this),o=u.length,r=0;r<o;r++)if(i=u[r],f=typeof i=="string"?i.toLowerCase():f,f===e)try{delete this[i]}catch(s){this[popName]=undefined}return this[n]=t,!0};EVUI.Modules.Core.DeepExtender=function(){var n=!1,f=0;try{typeof Symbol!="undefined"&&(n=Symbol((Math.random()*1e4).toString(36)))}catch(a){}var i=function(){},e=function(){this.target=null;this.source=null;this.options=null;this.existingObjects=[];this.existingObjectsLookup={};this.filterViaFn=!1;this.filterViaArray=!1;this.filterRecursion=!1;this.filterLookup=null;this.context=null},r=function(n,t){this.source=n;this.clone=t;this.paths=[];this.sameReference=!1},o=function(){this.propertyName=null;this.propertyPath=null;this.source=null;this.target=null;this.value=undefined;this.rootSource=null;this.rootTarget=null;this.publicContext=null};i.prototype.deepExtend=function(n,t,i){if(typeof n!="object"&&n!=null)throw Error("target must be an object.");if(typeof t!="object"||t==null)return n;var r=new e;return r.target=n,r.source=t,r.rootObj=n,r.options=typeof i!="object"||i==null?new EVUI.Modules.Core.DeepExtenderOptions:i,s(r)};var s=function(n){var r,i,f,e;if(n.options.filter!=null)if(n.filterViaFn=typeof n.options.filter=="function",n.filterRecursion=typeof n.options.recursionFilter=="function",n.filterViaFn||n.filterRecursion)n.context=new o,n.context.rootSource=n.source,n.context.rootTarget=n.target,n.context.publicContext=new EVUI.Modules.Core.DeepExtendContext(n.context);else if(EVUI.Modules.Core.Utils.isArray(n.options.filter)===!0)for(n.filterViaArray=!0,n.filterLookup={},r=n.options.filter.length,i=0;i<r;i++)f=n.options.filter[i],n.filterLookup[f]=!0;return t(n,n.source,n.target,""),e=u(n.target,n.source,null,n),l(n),e},h=function(n,t,i,r,u,f){f.context.propertyName=r;f.context.propertyPath=i+"."+r;f.context.source=t;f.context.target=n;f.context.value=u},u=function(n,i,r,f){var p,b,a,s,w,y;if(i==null||typeof i!="object"||n==null||typeof n!="object")return f.target;for(p=EVUI.Modules.Core.Utils.getProperties(i),b=p.length,a=0;a<b;a++){var o=p[a],e=i[o],k=typeof e;if((f.filterViaFn===!0||f.filterRecursion===!0)&&h(n,i,r,o,e,f),f.filterViaFn===!0){if(f.options.filter(f.context.publicContext)===!1)continue}else if(f.filterViaArray===!0&&f.filterLookup[o]===!0)continue;if(e!=null&&k==="object"){var v=r==null?o:r+"."+o,l=n[o],d=typeof l=="object"&&l===e;if(e instanceof Node==!0){n[o]=e;continue}if(s=c(f,e),s!=null){if(s.sameReference===!1)if(d===!0){for(s.clone=l,w=s.paths.length,y=0;y<w;y++)EVUI.Modules.Core.Utils.setValue(s.paths[y],f.rootObj,e);s.paths.splice(0,w);s.sameReference=!0}else s.paths.push(v),s.sameReference=!1;n[o]=s.clone}else{if(f.filterRecursion===!0&&f.options.recursionFilter(f.context.publicContext)===!1){EVUI.Modules.Core.Utils.isObject(l)===!0&&t(f,e,l,v);n[o]=e;continue}(typeof l!="object"||l==null)&&(l=EVUI.Modules.Core.Utils.isArray(e)?[]:{});t(f,e,l,v);n[o]=u(l,e,v,f)}}else e!==undefined&&(n[o]=e)}return n},c=function(t,i){var u,e,r,f;if(n!==!1&&(u=t.existingObjectsLookup[i[n]],u!=null))return u;for(e=t.existingObjects.length,r=0;r<e;r++)if(f=t.existingObjects[r],f.source===i)return f;return null},t=function(t,i,u,e){var s=null,o,h,c;if(n!==!1)if(o=t.existingObjectsLookup[i[n]],o==null){if(o=new r(i,u),o.paths.push(e),h=f++,i[n]=h,c=typeof i[n]=="number",c===!0)return t.existingObjectsLookup[h]=o,o;s=o}else return o.paths.push(e),o;return s==null&&(s=new r(i,u)),s.paths.push(e),t.existingObjects.push(s),s},l=function(t){for(var r,u=Object.keys(t.existingObjectsLookup),f=u.length,i=0;i<f;i++)r=t.existingObjectsLookup[u[i]],r!=null&&delete r.source[n]};return new i}();EVUI.Modules.Core.DeepExtendContext=function(n){if(EVUI.Modules.Core.Utils.isObject(n)===!1)throw Error("Object expected.");var t=n;this.propertyName=null;Object.defineProperty(this,"propertyName",{get:function(){return t.propertyName},configurable:!1,enumerable:!0});this.propertyPath=null;Object.defineProperty(this,"propertyPath",{get:function(){return t.propertyPath},configurable:!1,enumerable:!0});this.source=null;Object.defineProperty(this,"source",{get:function(){return t.source},configurable:!1,enumerable:!0});this.target=null;Object.defineProperty(this,"target",{get:function(){return t.target},configurable:!1,enumerable:!0});this.value=undefined;Object.defineProperty(this,"value",{get:function(){return t.value},configurable:!1,enumerable:!0});this.rootSource=null;Object.defineProperty(this,"rootSource",{get:function(){return t.rootSource},configurable:!1,enumerable:!0});this.rootTarget=null;Object.defineProperty(this,"rootTarget",{get:function(){return t.rootTarget},configurable:!1,enumerable:!0})};EVUI.Modules.Core.DeepExtendContext.prototype.getSourceValue=function(){return this.value};EVUI.Modules.Core.DeepExtendContext.prototype.getTargetValue=function(){return EVUI.Modules.Core.Utils.getValue(this.propertyName,this.target)};EVUI.Modules.Core.DeepExtendContext.prototype.getSourceParent=function(){for(var i,r=EVUI.Modules.Core.Utils.getValuePathSegments(this.propertyPath),u=r.length,n=this.rootSource,t=0;t<u-1;t++){if(i=n[r[t]],i==null)break;n=i}return n};EVUI.Modules.Core.DeepExtendContext.prototype.getTargetParent=function(){for(var i,r=EVUI.Modules.Core.Utils.getValuePathSegments(this.propertyPath),u=r.length,n=this.rootTarget,t=0;t<u-1;t++){if(i=n[r[t]],i==null)break;n=i}return n};EVUI.Modules.Core.DeepExtenderOptions=function(){this.filter=null;this.recursionFilter=null};EVUI.Modules.Core.Utils={};$evui.cio=function(n){return new EVUI.Modules.Core.CaseInsensitiveObject(n)};EVUI.Modules.Core.Utils.deepExtend=function(n,t,i){return new EVUI.Modules.Core.DeepExtender.deepExtend(n,t,i)};$evui.deepExtend=function(n,t,i){return EVUI.Modules.Core.Utils.deepExtend(n,t,i)};EVUI.Modules.Core.Utils.getElementAttributes=function(n){var i,u,t,r;if(n==null||(EVUI.Modules.Core.Utils.isjQuery(n)===!0&&(n=n[0]),EVUI.Modules.Core.Utils.isDomHelper(n)===!0&&(n=n.elements[0]),EVUI.Modules.Core.Utils.isElement(n)===!1))return null;for(i=new EVUI.Modules.Core.CaseInsensitiveObject,u=n.attributes.length,t=0;t<u;t++)r=n.attributes[t],i[r.name]=r.value;return i};$evui.getAttrs=function(n){return EVUI.Modules.Core.Utils.getElementAttributes(n)};EVUI.Modules.Core.Utils.getValue=function(n,t){var i,u;if(t==null)throw Error("Cannot get a value from a null or undefined source.");if(i=typeof n,i!=="string"){if(i==="number"||i==="symbol")return t[n];if(n==null)return t;throw Error("Cannot get value, path must be a string.");}var f=EVUI.Modules.Core.Utils.getValuePathSegments(n),e=f.length,r=t;for(u=0;u<e;u++)if(r=r[f[u]],r==null)return null;return r};$evui.get=function(n,t){return EVUI.Modules.Core.Utils.getValue(n,t)};EVUI.Modules.Core.Utils.PathCache={};EVUI.Modules.Core.Utils.getValuePathSegments=function(n){var h=typeof n,e,t,u,s;if(h==="number")n=n.toString();else if(h!=="string")throw Error("Cannot get path segments from a non-string.");if(n==="")return[];if(e=EVUI.Modules.Core.Utils.PathCache[n],e!=null)try{return e.slice()}catch(y){}var f=[],c=/\[|\]|\.|\?/,l=/"|'|`/,a=c.test(n)===!0||l.test(n)===!0;if(a===!1)return EVUI.Modules.Core.Utils.PathCache[n]=Object.freeze([n]),[n];var v=n.length,i="",r=!1,o=null;for(t=0;t<v;t++){if(u=n[t],s=r,l.test(u)===!0&&(r===!1?(t===0||n[t-1]!=="\\")&&(r=!0,o=u):u===o&&t>0&&n[t-1]!=="\\"&&(r=!1)),r===!0){if(s===!1)continue;i+=u;continue}(r!==!1||s!==!0)&&(c.test(u)===!0?i.length>0&&(f.push(i),i=""):i+=u)}if(r===!0)throw Error("Malformed path. Literal text run starting with "+o+" had no matching un-escaped close character");return i.length>0&&f.push(i),EVUI.Modules.Core.Utils.PathCache[n]=Object.freeze(f.slice()),f};$evui.getPathSegments=function(n){return EVUI.Modules.Core.Utils.getValuePathSegments(n)};EVUI.Modules.Core.Utils.setValue=function(n,t,i,r){var u,o,f;if(typeof n!="string"){if(EVUI.Modules.Core.Utils.isArray(t)===!0&&typeof n=="number")return t[n]=i,!0;if(n==null)return t=i,!0;throw Error("Cannot set value, path must be a string.");}if(t==null)throw Error("Cannot set value of a null or undefined target.");var s=EVUI.Modules.Core.Utils.getValuePathSegments(n),h=s.length,e=t;for(u=0;u<h;u++){if(u===h-1)return e[s[h-1]]=i,!0;if(o=s[u],f=e[o],f==null)if(r===!0)f={},e[o]=f;else throw Error('Failed to set property at path "'+n+'", value at "'+o+'"  was null or undefined.');e=f}return!1};$evui.set=function(n,t,i,r){return EVUI.Modules.Core.Utils.setValue(n,t,i,r)};EVUI.Modules.Core.Utils.isObject=function(n){return typeof n=="object"&&n!=null};$evui.isObject=function(n){return EVUI.Modules.Core.Utils.isObject(n)};EVUI.Modules.Core.Utils.isArray=function(n){return Array.isArray(n)===!0?!0:!1};$evui.isArray=function(n){return EVUI.Modules.Core.Utils.isArray(n)};EVUI.Modules.Core.Utils.makeGuid=function(){for(var n="",t=0;t<36;t++)switch(t){case 8:case 13:case 18:case 23:n+="-";break;case 14:n+=(Math.floor(Math.random()*4)+1).toString(16);break;case 19:n+=(Math.floor(Math.random()*4)+8).toString(16);break;default:n+=Math.floor(Math.random()*16).toString(16)}return n};$evui.guid=function(){return EVUI.Modules.Core.Utils.makeGuid()};EVUI.Modules.Core.Utils.emptyGuid=function(){return"00000000-0000-0000-0000-000000000000"};$evui.emptyGuid=function(){return EVUI.Modules.Core.Utils.emptyGuid()};EVUI.Modules.Core.Utils.isPromise=function(n){return n==null?!1:typeof Promise!="undefined"&&n instanceof Promise?!0:typeof n.then=="function"&&typeof n.catch=="function"?!0:!1};$evui.isPromise=function(n){return EVUI.Modules.Core.Utils.isPromise(n)};EVUI.Modules.Core.Utils.stringIsNullOrWhitespace=function(n){if(typeof n!="string")return!0;return n.trim().length===0};$evui.isStringValid=function(n){return!EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)};EVUI.Modules.Core.Utils.log=function(n){try{if(EVUI.Modules.Core.Settings.loggingEnabled===!0)console.log(n);else{var t=EVUI.Modules.Core.Settings.alternateLoggingFunction;typeof t=="function"&&t(n)}}catch(i){}};$evui.log=function(n){return EVUI.Modules.Core.Utils.log(n)};EVUI.Modules.Core.Utils.hasFlag=function(n,t){if(typeof n!="number"||typeof t!="number")return!1;var i=n&t;return i===t};$evui.hasFlag=function(n,t){return EVUI.Modules.Core.Utils.hasFlag(n,t)};EVUI.Modules.Core.Utils.addFlag=function(n,t){return typeof n!="number"&&typeof t!="number"?n:n|t};$evui.addFlag=function(n,t){return EVUI.Modules.Core.Utils.addFlag(n,t)};EVUI.Modules.Core.Utils.removeFlag=function(n,t){return typeof n!="number"&&typeof t!="number"?n:n&~t};$evui.removeFlag=function(n,t){return EVUI.Modules.Core.Utils.removeFlag(n,t)};EVUI.Modules.Core.Utils.isjQuery=function(n){return n==null?!1:typeof jQuery=="undefined"?!1:n instanceof jQuery==!0?!0:!1};EVUI.Modules.Core.Utils.isElement=function(n){return n instanceof Element};$evui.isElement=function(n){return EVUI.Modules.Core.Utils.isElement(n)};EVUI.Modules.Core.Utils.containsElement=function(n,t){return(EVUI.Modules.Core.Utils.isjQuery(n)===!0&&(n=n[0]),EVUI.Modules.Core.Utils.isDomHelper(n)===!0&&(n=n.elements[0]),n instanceof Node==!1)?!1:n.parentElement==null?!1:(EVUI.Modules.Core.Utils.isjQuery(t)===!0&&(t=t[0]),EVUI.Modules.Core.Utils.isDomHelper(t)===!0&&(t=t.elements[0]),t instanceof Node==!1)?!1:t.contains(n)};EVUI.Modules.Core.Utils.isOrphanedNode=function(n){var t,i;if(n==null)return!0;if(n.isConnected===!0)return!1;for(t=n.parentNode;t!=null;)if(i=t.parentNode,i==null)break;else t=i;return t!=null&&(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE||t.nodeType===Node.DOCUMENT_NODE)?!1:!0};EVUI.Modules.Core.Utils.shallowExtend=function(n,t,i){var c,e,l,r,u,o;if(n==null||typeof n!="object"||t==null||typeof t!="object")return n;var s=!1,f=null,h=!1;if(i!=null)if(typeof i=="function")h=!0;else if(EVUI.Modules.Core.Utils.isArray(i)===!0)for(s=!0,f={},c=i.length,r=0;r<c;r++)f[i[r]]=!0;for(e=EVUI.Modules.Core.Utils.getProperties(t),l=e.length,r=0;r<l;r++){if(u=e[r],h===!0){if(i(u,t,n)===!1)continue}else if(s===!0&&f[u]===!0)continue;(o=t[u],o!==undefined)&&(n[u]=o)}return n};$evui.extend=function(n,t,i){return EVUI.Modules.Core.Utils.shallowExtend(n,t,i)};EVUI.Modules.Core.Utils.makeOrExtendObject=function(n,t,i,r){return t==null?i==null?n:EVUI.Modules.Core.Utils.shallowExtend(n,i,r):i==null?t:t instanceof n.constructor?EVUI.Modules.Core.Utils.shallowExtend(t,i):EVUI.Modules.Core.Utils.shallowExtend(n,i)};EVUI.Modules.Core.Utils.waitAsync=function(n){if(typeof n!=null&&typeof n!="number")throw new Error("Number expected.");return new Promise(function(t){setTimeout(function(){t()},n)})};$evui.waitAsync=function(n){return EVUI.Modules.Core.Utils.waitAsync(n)};EVUI.Modules.Core.Utils.getValidElement=function(n){return EVUI.Modules.Core.Utils.isElement(n)?n:EVUI.Modules.Core.Utils.isjQuery(n)===!0&&n.length>0&&EVUI.Modules.Core.Utils.isElement(n[0])===!0?n[0]:EVUI.Modules.Dom!=null&&n instanceof EVUI.Modules.Dom.DomHelper&&n.elements.length>0&&EVUI.Modules.Core.Utils.isElement(n.elements[0])===!0?n.elements[0]:null};EVUI.Modules.Core.Utils.isDomHelper=function(n){return EVUI.Modules.Dom!=null&&n instanceof EVUI.Modules.Dom.DomHelper};EVUI.Modules.Core.Utils.require=function(n,t){if(EVUI.Modules[n]==null)throw Error("Dependency missing: Module EVUI.Modules."+n+" is required."+(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!1?" "+t:""));};EVUI.Modules.Core.Utils.requireAll=function(n){if(n==null)throw Error("Dependencies missing.");if(n.checked!==!0){for(var t in n)n[t].required===!0&&EVUI.Modules.Core.Utils.require(t);n.checked=!0}};EVUI.Modules.Core.Utils.instanceOf=function(n,t){return n==null||typeof t!="function"?!1:n instanceof t?!0:EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.name)===!0||t.name.toLowerCase()==="object"?!1:"[object "+t.name+"]"===Object.prototype.toString.call(n)?!0:!1};$evui.instanceOf=function(n,t){return EVUI.Modules.Core.Utils.instanceOf(n,t)};EVUI.Modules.Core.Utils.getHashCode=function(n){var a,l,t;if(typeof n!="string")throw Error("String expected.");if(a=n.length,a===0)return 0;var r=0,u=0,e=0,o=0,s=0,f=0,h=0,i=0,c=0,v=1;for(l=0;l<a;l++)i=n.charCodeAt(l),i===0?i=10.1667:i===1&&(i=26.567),r=i-l/v,r<0&&(r*=-1),u-=i,u<0&&(u*=-8.1373),c=i%5,c===0?(h-=r,h<0&&(h*=-112.69)):c===4?(f-=r,f<0&&(f=f*-918.07)):c===3?(s-=r,s<0&&(s*=-213.7)):c===2?(o-=r,o<0&&(o*=-8.1471)):(e-=r,e<0&&(e*=-10.912)),v=i;return t=(h-f-s-o-e-u)/(a/r),u!==0&&(t===u?t*=Math.sqrt(u):t/=u),e!==0&&t!==e&&(t*=e),o!==0&&t!==o&&(t/=o),s!==0&&t!==s&&(t*=s),f!==0&&t!==f&&(t/=f),h!==0&&t!==h&&(t*=h),i!==0&&t!==i&&(t/=i),t<1&&t!==0&&t>-1&&(t=1/t),t<0&&(t*=-1),t>Number.MAX_SAFE_INTEGER&&(t=Math.sqrt(t)),t};$evui.getHashCode=function(n){return EVUI.Modules.Core.Utils.getHashCode(n)};EVUI.Modules.Core.Utils.toDictionary=function(n,t){var r,e,i,u,f;if(EVUI.Modules.Core.Utils.isArray(n)===!1)throw Error("Array expected.");if(typeof t!="function")throw Error("Function expected.");for(r={},e=n.length,i=0;i<e;i++)(u=n[i],f=t(u,i),f!=null)&&(r[f]=u);return r};$evui.toDictionary=function(n,t){return EVUI.Modules.Core.Utils.toDictionary(n,t)};EVUI.Modules.Core.Utils.getProperties=function(n){var f,h,e,i,o,s,c,u,t,r;if(typeof n!="object"||n==null)return null;if(f=n.constructor==null?null:n.constructor[EVUI.Modules.Core.Constants.Symbol_ObjectProperties],f!=null)return f;if(n.constructor==Object||n.constructor!=null&&n.constructor[EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers]===!1)return Object.keys(n);if(EVUI.Modules.Core.Utils.isArray(n)===!0){for(h=n.length,e=[],i=0;i<h;i++)e.push(i);return e}if(EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers!=null){if(o=n.constructor==null?!1:n.constructor[EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers],o===!0){t=[];for(r in n)t.push(r);return t}if(o===!1)return Object.keys(n);if(s=Object.getPrototypeOf(n),c=Object.keys(s),c.length===0){if(u=Object.getPrototypeOf(s),u===Object.prototype||u==null||Object.getPrototypeOf(u)==null)return n.constructor!=null&&(n.constructor[EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers]=!1),Object.keys(n)}else n.constructor!=null&&(n.constructor[EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers]=!0)}t=[];for(r in n)t.push(r);return t};$evui.props=function(n){return EVUI.Modules.Core.Utils.getProperties(n)};EVUI.Modules.Core.Utils.cacheProperties=function(n,t){return EVUI.Modules.Core.Constants.Symbol_ObjectProperties==null?!1:n==null||typeof n!="object"?!1:Object.getPrototypeOf(n)==Object.prototype?!1:EVUI.Modules.Core.Utils.isArray(t)===!1?(t=EVUI.Modules.Core.Utils.getProperties(n),n.constructor[EVUI.Modules.Core.Constants.Symbol_ObjectProperties]=t,!0):!1};$evui.cacheProps=function(n,t){return EVUI.Modules.Core.Utils.cacheProperties(n,t)};EVUI.Modules.Core.Utils.uncacheProperties=function(n){return EVUI.Modules.Core.Constants.Symbol_ObjectProperties==null||n==null||typeof n!="object"?!1:(delete n.constructor[EVUI.Modules.Core.Constants.Symbol_ObjectProperties],delete n.constructor[EVUI.Modules.Core.Constants.Symbol_HasPrototypeMembers],!0)};$evui.uncacheProps=function(n){return EVUI.Modules.Core.Utils.uncacheProperties(n)};EVUI.Modules.Core.Utils.createController=function(n,t){var r,i;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw Error("String expected.");/s$/i.test(n)===!0&&(n=n.substring(0,n.length-1));r=new RegExp("^"+n+"$|^"+n+"s$","i");for(i in EVUI.Constructors)if(r.test(i)===!0)return new EVUI.Constructors[i](t);return null};$evui.createController=function(n,t){return EVUI.Modules.Core.Utils.createController(n,t)};Object.freeze(EVUI.Modules.Core);Object.freeze(EVUI.Modules.Core.Constants);Object.freeze(EVUI.Modules.Core.Utils);EVUI.Modules.Diff={};EVUI.Modules.Diff.Dependencies={Core:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Diff.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Diff.Dependencies);EVUI.Modules.Diff.Constants={};EVUI.Modules.Diff.Constants.Fn_ShouldComparePredicate=function(){return!0};Object.freeze(EVUI.Modules.Diff.Constants);EVUI.Modules.Diff.SymbolCache=null,function(){var n={};Object.defineProperty(EVUI.Modules.Diff,"SymbolCache",{get:function(){return n},enumerable:!0,configurable:!1})}();EVUI.Modules.Diff.DiffController=function(){var o=function(){this.objectParentage=[];this.counter=0;this.objectHashCodes=[];this.compareResult=new EVUI.Modules.Diff.CompareResult;this.mode=n.Diff;this.hashCache={};this.getValueHashCode=function(n){return u(this,n)}},s={Unknown:-1,Common:0,AOnly:1,BOnly:2},w=function(){this.key=null;this.flags=s.Unknown},h=function(){this.obj=null;this.hash=null},n={Diff:0,GetValueHash:1,StringDiff:2},c=EVUI.Modules.Core.Utils.getHashCode("##evui.null##"),l=EVUI.Modules.Core.Utils.getHashCode("##evui.undefined##"),a=EVUI.Modules.Core.Utils.getHashCode("##evui.true##"),v=EVUI.Modules.Core.Utils.getHashCode("##evui.false##");this.compare=function(r,u,f){var e=i(f,n.Diff);return e.compareResult.rootComparison=t(e,r,u,null,null),e.compareResult};this.getValueHashCode=function(t,f){var e=i(f,n.GetValueHash);return r(e,null,t,null,typeof t,null,!0)===!1?null:u(e,t)};this.compareStrings=function(r,u,f){var o;if(typeof r!="string"||typeof u!="string")throw Error("Invalid parameters: cannot compare non-string values.");o=new EVUI.Modules.Diff.CompareOptions;o.diffStrings=!0;o.stringCompareOptions=f;var s=i(o,n.StringDiff),h=t(s,r,u),e=new EVUI.Modules.Diff.StringCompareResult;return e.a=r,e.b=u,e.options=s.compareResult.options,e.stringDiffs=h.differences,e};var i=function(t,i){t=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Diff.CompareOptions,t);t.exclusionFilters!=null&&EVUI.Modules.Core.Utils.isArray(t.exclusionFilters)===!0&&(t.exclusionFilters=t.exclusionFilters.slice());t.stringCompareOptions=t.stringCompareOptions==null?new EVUI.Modules.Diff.StringCompareOptions:EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Diff.StringCompareOptions,t.stringCompareOptions);var r=new o;return r.compareResult.options=t,i==null&&(i=n.Diff),r},r=function(n,t,i,r,u,f,e){var h,o,s;if(n.compareResult.options.excludeFunctions===!0&&(u==="function"||f==="function")||u==="object"&&i instanceof Node||f==="object"&&r instanceof Node)return!1;if(n.compareResult.options.exclusionFilters!=null)if(typeof n.compareResult.options.exclusionFilters=="function"){if(n.compareResult.options.exclusionFilters(i,t)===!1||e===!1&&n.compareResult.options.exclusionFilters(r,t)===!1)return!1}else if(EVUI.Modules.Core.Utils.isArray(n.compareResult.options.exclusionFilters)===!0)for(h=n.compareResult.options.exclusionFilters.length,o=0;o<h;o++)if(s=n.compareResult.options.exclusionFilters[o],typeof s=="function"&&(s(i,t)===!1||e===!1&&s(r,t)===!1))return!1;return!0},t=function(n,t,i,u,e){var s=typeof t,h=typeof i,o,c,l,a;return r(n,u,t,i,s,h,!1)===!1?null:(o=new EVUI.Modules.Diff.Comparison(n),o.id=n.counter++,o.a=t,o.b=i,o.parentComparison=e,o.propName=u,n.compareResult.allComparisons.push(o),s==="object"&&h==="object"?(c=t==null,l=i==null,o.diffType=EVUI.Modules.Diff.DiffType.Object,c===!1&&l===!1?(o=f(n,o),t.constructor.prototype!==i.constructor.prototype&&(o.flags|=EVUI.Modules.Diff.DiffFlags.Prototype)):((c===!1||l===!1)&&(o.flags|=c===!1?EVUI.Modules.Diff.DiffFlags.AOnly:EVUI.Modules.Diff.DiffFlags.BOnly,o.flags|=EVUI.Modules.Diff.DiffFlags.Reference),o=f(n,o))):(t!==i&&(o.flags|=EVUI.Modules.Diff.DiffFlags.Value),s==="string"&&h==="string"?(o.diffType=EVUI.Modules.Diff.DiffType.String,n.compareResult.options.diffStrings===!0&&(o.differences=y(t,i))):(o.diffType=EVUI.Modules.Diff.DiffType.Property,s!==h&&(o.flags|=EVUI.Modules.Diff.DiffFlags.Prototype))),a=n.compareResult.options.compareValuesOnly===!0?EVUI.Modules.Core.Utils.removeFlag(o.flags,EVUI.Modules.Diff.DiffFlags.Reference):o.flags,e!=null&&(e.childComparisons.push(o),a!==EVUI.Modules.Diff.DiffFlags.None&&(e.differences.push(o),e.flags|=EVUI.Modules.Diff.DiffFlags.Children)),a!==EVUI.Modules.Diff.DiffFlags.None?n.compareResult.allDifferences.push(o):n.compareResult.allInCommon.push(o),o)},y=function(n,t){var o,h,k,g,d,y,a,e,f,u;if(n===t)return[];for(var c=[],s=null,p=n.length,w=t.length,tt=p>=w?p:w,i=0,r=0,b="";i<tt||r<tt;)if(o=n[i],h=t[r],o!==h&&o!==undefined&&h!==undefined){if(s!=null&&(s.text=b,b="",c.push(s),s=null),k=!1,g=!1,o!==undefined&&h!==undefined){var l=i,v=r,nt=w;for(y=i;y<p;y++)if(a=i+(y-i),o=n[a],a<nt){for(e=r;e<nt;e++)if(t[e]===o){k=!0;nt=e;l=a;v=e;break}}else break;for(d=k===!0?l:p,y=r;y<w;y++)if(a=r+(y-r),h=t[a],a<d){for(e=i;e<d;e++)if(h===n[e]){g=!0;d=e;(a<=v||e<=l)&&(v=a,l=e);break}}else break}if(o=n[l],h=t[v],o!==h)if(k===!1&&g===!1)l=p,v=w;else{u=new EVUI.Modules.Diff.StringDifference;u.aIndex=i;u.text=n.substring(i,p);u.flags|=EVUI.Modules.Diff.DiffFlags.AOnly;c.push(u);f=new EVUI.Modules.Diff.StringDifference;f.bIndex=r;f.text=t.substring(r,w);f.flags|=EVUI.Modules.Diff.DiffFlags.BOnly;c.push(f);break}l!==i&&(u=new EVUI.Modules.Diff.StringDifference,u.aIndex=i,u.text=n.substring(i,l),u.flags|=EVUI.Modules.Diff.DiffFlags.AOnly,c.push(u),i=l);v!==r&&(f=new EVUI.Modules.Diff.StringDifference,f.bIndex=r,f.text=t.substring(r,v),f.flags|=EVUI.Modules.Diff.DiffFlags.BOnly,c.push(f),r=v)}else if(o===undefined&&h!==undefined){f=new EVUI.Modules.Diff.StringDifference;f.bIndex=r;f.text=t.substring(r,w);f.flags|=EVUI.Modules.Diff.DiffFlags.BOnly;c.push(f);break}else if(h===undefined&&o!==undefined){u=new EVUI.Modules.Diff.StringDifference;u.aIndex=i;u.text=n.substring(i,p);u.flags|=EVUI.Modules.Diff.DiffFlags.AOnly;c.push(u);break}else if(o===undefined&&h===undefined)break;else s==null&&(s=new EVUI.Modules.Diff.StringDifference,s.aIndex=i,s.bIndex=r),b+=o,i++,r++;return s!=null&&(s.text=b,c.push(s)),c},f=function(n,i){var h,a,c,p,u,r,e;if(i.a===i.b)return i;i.flags|=EVUI.Modules.Diff.DiffFlags.Reference;var l={},o=i.a==null,s=i.b==null;if(o===!1)for(h=EVUI.Modules.Core.Utils.getProperties(i.a),a=h.length,u=0;u<a;u++){var r=h[u],v=i.a[r],y=s===!1?i.b[r]:undefined,f=t(n,v,y,r,i);f!=null&&(s===!1&&(l[r]=f),f.flags|=EVUI.Modules.Diff.DiffFlags.AOnly)}if(s===!1)for(c=EVUI.Modules.Core.Utils.getProperties(i.b),p=c.length,u=0;u<p;u++){if(r=c[u],o===!1&&(e=l[r],e!=null)){e.flags=EVUI.Modules.Core.Utils.removeFlag(e.flags,EVUI.Modules.Diff.DiffFlags.AOnly);continue}var v=o===!1?i.a[r]:undefined,y=i.b[r],f=t(n,v,y,r,i);f!=null&&(f.flags|=EVUI.Modules.Diff.DiffFlags.BOnly)}return i},u=function(n,t){var f,e,i,r,u;if(t===null)return c;if(t===undefined)return l;f=typeof t;switch(f){case"string":return t.length<=36?(i=n.hashCache[t],i==null?(r=EVUI.Modules.Core.Utils.getHashCode(t),n.hashCache[t]=r,r):i):EVUI.Modules.Core.Utils.getHashCode(t);case"boolean":return t===!0?a:v;case"bigint":case"number":return e=t.toString()+"##evui."+f+"##",i=n.hashCache[e],i==null?(r=EVUI.Modules.Core.Utils.getHashCode(e),n.hashCache[e]=r,r):i;case"function":return n.options.excludeFunctions===!0?"":EVUI.Modules.Core.Utils.getHashCode(t.toString()+"##evui."+f+"##");case"symbol":return u=EVUI.Modules.Diff.SymbolCache[t],u==null&&(u=EVUI.Modules.Core.Utils.getHashCode(EVUI.Modules.Core.Utils.makeGuid()),EVUI.Modules.Diff.SymbolCache[t]=u),u;case"object":return p(n,t);default:return""}},p=function(n,t){var f=e(n,t),o,s,i,c,l,v;if(f==null)f=new h,f.obj=t,n.objectHashCodes.push(f);else if(f.hash!=null)return f.hash;n.objectParentage.push(t);var a="##evui.object##@",y=EVUI.Modules.Core.Utils.getProperties(t),p=y.length;for(o=0;o<p;o++)(s=y[o],i=t[s],r(n,s,i,null,typeof i,null,!0)!==!1)&&(a+="##evui.prop##"+s+':"',c=null,n.objectParentage.indexOf(i)!==-1?(l=e(n,i),c=l!=null&&l.hash!=null?l.hash:n.compareResult.options.compareValuesOnly===!0?EVUI.Modules.Core.Utils.getHashCode("##evui.circular##{}"):EVUI.Modules.Core.Utils.getHashCode("##evui.circular##"+Object.prototype.toString.call(i)+i.constructor.toString())):c=u(n,i),a+=c+'"');return v=EVUI.Modules.Core.Utils.getHashCode(a),f.hash=v,n.objectParentage.pop(),v},e=function(n,t){for(var r,u=n.objectHashCodes.length,i=0;i<u;i++)if(r=n.objectHashCodes[i],r.obj===t)return r;return null}};EVUI.Modules.Diff.CompareResult=function(){this.rootComparison=null;this.allDifferences=[];this.allComparisons=[];this.allInCommon=[];this.options=null};EVUI.Modules.Diff.CompareResult.prototype.getAllValueMatches=function(n){var f,o,u,t;if(typeof n!="number")throw Error("Number expected.");for(f=[],o=this.allComparisons.length,u=0;u<o;u++){var i=this.allComparisons[u],r=null,e=null;i.getAHashCode()===n?(r=i,e=i.a):i.getBHashCode()===n&&(r=i,e=i.b);r!=null&&(t=new EVUI.Modules.Diff.CompareMatch,t.comparison=r,t.matchingObject=e,t.name=r.propName,t.path=r.getPath(),t.source=n,f.push(t))}return f};EVUI.Modules.Diff.CompareResult.prototype.getAllReferenceMatches=function(n){var f,e,u,r,t,i;if(n==null||typeof n!="object")throw Error("Object expected.");for(f=[],e=this.allComparisons.length,u=0;u<e;u++)r=this.allComparisons[u],t=null,r.a===n?t=r:r.b===n&&(t=r),t!=null&&(i=new EVUI.Modules.Diff.CompareMatch,i.comparison=t,i.matchingObject=n,i.name=t.propName,i.path=t.getPath(),i.source=n,f.push(i));return f};EVUI.Modules.Diff.Comparison=function(n){var t=this,u=n,i=null,r=null;this.id=-1;this.propName=null;this.a=null;this.b=null;this.diffType=EVUI.Modules.Diff.DiffType.None;this.flags=EVUI.Modules.Diff.DiffFlags.None;this.parentComparison=null;this.childComparisons=[];this.differences=[];this.getAHashCode=function(){return i!=null?i:(i=u.getValueHashCode(t.a),t.a===t.b&&(r=i),i)};this.getBHashCode=function(){return r!=null?r:(r=u.getValueHashCode(t.b),t.a===t.b&&(i=r),r)}};EVUI.Modules.Diff.CompareMatch=function(){this.source=null;this.matchingObject=null;this.path=null;this.name=null;this.comparison=null};EVUI.Modules.Diff.Comparison.prototype.getPath=function(){if(this.propName==null)return null;for(var t=this.propName,n=this.parentComparison;n!=null&&n.propName!=null;)t=n.propName+"."+t,n=n.parentComparison;return t};EVUI.Modules.Diff.StringDifference=function(){this.aIndex=-1;this.bIndex=-1;this.text=null;this.flags=EVUI.Modules.Diff.DiffFlags.None};EVUI.Modules.Diff.StringCompareResult=function(){this.a=null;this.b=null;this.options=null;this.stringDiffs=[]};EVUI.Modules.Diff.MergeWinner={A:"a",B:"b"};Object.freeze(EVUI.Modules.Diff.MergeWinner);EVUI.Modules.Diff.DiffType={None:"none",String:"string",Object:"object",Property:"prop"};Object.freeze(EVUI.Modules.Diff.DiffType);EVUI.Modules.Diff.DiffFlags={None:0,Reference:1,Value:2,AOnly:4,BOnly:8,Children:16,Prototype:32};Object.freeze(EVUI.Modules.Diff.DiffFlags);EVUI.Modules.Diff.CompareOptions=function(){this.excludeFunctions=!0;this.compareValuesOnly=!1;this.exclusionFilters=null;this.diffStrings=!1;this.stringCompareOptions=null};EVUI.Modules.Diff.StringCompareOptions=function(){this.mode=EVUI.Modules.Diff.StringDiffMode.Character;this.whitespaceWordBreaks=!0;this.wordBreaks=[]};EVUI.Modules.Diff.StringDiffMode={Character:"character",Word:"word"};Object.freeze(EVUI.Modules.Diff.StringDiffMode);EVUI.Modules.Diff.Comparer=null,function(){var n=null;Object.defineProperty(EVUI.Modules.Diff,"Comparer",{get:function(){return n==null&&(n=new EVUI.Modules.Diff.DiffController),n},enumerable:!0,configurable:!1})}();EVUI.Constructors.Diff=EVUI.Modules.Diff.DiffController;$evui.diff=function(n,t,i){return EVUI.Modules.Diff.Comparer.compare(n,t,i)};$evui.strDiff=function(n,t){return EVUI.Modules.Diff.Comparer.compareStrings(n,t)};$evui.getValueHashCode=function(n,t){return EVUI.Modules.Diff.Comparer.getValueHashCode(n,t)};Object.freeze(EVUI.Modules.Diff);EVUI.Modules.Dom={};EVUI.Modules.Dom.Dependencies={Core:Object.freeze({required:!0}),DomTree:Object.freeze({required:!1})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Dom.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Dom.Dependencies);EVUI.Modules.Dom.Constants={};EVUI.Modules.Dom.Constants.PreviousDisplayState="evuiDisplayState";EVUI.Modules.Dom.Constants.Fn_BrowserEventHandler=function(){};Object.freeze(EVUI.Modules.Dom.Constants);EVUI.Modules.Dom.ControlInfo=function(n,t){if(EVUI.Modules.Dom.Dependencies.checked!==!0){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Dom.Dependencies)}if(typeof n!="string")throw Error("ID must be a string.");var r=n,i=null,u=null;this.id=null;Object.defineProperty(this,"id",{get:function(){return r},configurable:!1,enumerable:!0});this.control=null;Object.defineProperty(this,"control",{get:function(){return i},configurable:!1,enumerable:!0});this.attributes=t==null?{}:t;this.getControl=function(n){return n!==!0&&i!=null?i:i=r.startsWith("#")===!0?document.getElementById(r.substring(1)):document.getElementById(r)};this.getHelper=function(n){if(n!==!0&&u!=null)return u;var t=this.getControl(n);return t==null?null:u=new EVUI.Modules.Dom.DomHelper(t)}};EVUI.Modules.Dom.DomHelper=function(){var r=null,c=/-[A-Za-z]{1}/gi,n=function(n,t){if(EVUI.Modules.Dom.Dependencies.checked!==!0){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Dom.Dependencies)}this.elements=Object.freeze(p(n,t))},l=function(){this.previousDisplayState=null;this.displayStateWasInlined=!1},s=function(n){r==null&&(r=EVUI.Modules.Core.Utils.getHashCode("@EVUIDom:"+EVUI.Modules.Core.Utils.makeGuid()).toString(36));var t=n[r];return t==null&&(t=new l,n[r]=t),t},w=function(){},t=function(n,t){var u,i,r;if(n!=null)for(u=n.length,i=0;i<u;i++)(r=n[i],r!=null)&&t(r)};n.prototype.first=function(){return this.elements[0]};n.prototype.hide=function(){return t(this.elements,function(n){var f=n.nodeType,u;if(f===Node.ELEMENT_NODE){var r=s(n),t=null,i=!1;(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.style.display)==!1&&(t=n.style.display,i=!0),t!=="none")&&(t==null&&(u=getComputedStyle(n),t=u.display,i=!1),r.displayStateWasInlined=i,r.previousDisplayState=t,n.style.display="none")}}),this};n.prototype.show=function(){return t(this.elements,function(n){var i=n.nodeType,t;i===Node.ELEMENT_NODE&&(t=s(n),n.style.display=EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.previousDisplayState)===!1?t.displayStateWasInlined===!1?null:t.previousDisplayState:"inline-block",t.previousDisplayState=null,t.displayStateWasInlined=!1)}),this};n.prototype.outerHeight=function(n){return this.elements==null?0:this.elements.length>0?a(this.elements[0],n):0};n.prototype.outerWidth=function(n){return this.elements==null?0:this.elements.length>0?v(this.elements[0],n):0};n.prototype.append=function(n){return u(this.elements,n,"append")};n.prototype.prepend=function(n){return u(this.elements,n,"prepend")};n.prototype.insertBefore=function(n){return u(this.elements,n,"before")};n.prototype.insertAfter=function(n){return u(this.elements,n,"after")};n.prototype.remove=function(){return t(this.elements,function(n){(n.nodeType===Node.TEXT_NODE||n.nodeType===Node.ELEMENT_NODE)&&n.remove()}),this};n.prototype.empty=function(){return t(this.elements,function(n){if(n.childNodes!=null)for(var t=n.childNodes[0];t!=null;)t.remove(),t=n.childNodes[0];n.textContent!==undefined&&(n.textContent=null)}),this};n.prototype.replace=function(n){var i=[];return t(this.elements,function(t){var r,u;if(t.nodeType===Node.ELEMENT_NODE||t.nodeType===Node.TEXT_NODE){var f=e(n),o=document.createDocumentFragment(),s=f.length;for(r=0;r<s;r++)u=f[r],o.append(u),i.push(u);t.replaceWith(o)}}),new EVUI.Modules.Dom.DomHelper(i)};n.prototype.offset=function(){var n=new EVUI.Modules.Dom.ElementBounds,t,r,i;return this.elements==null||this.elements.length===0?n:(t=this.elements[0],t===window)?(n.top=window.scrollY,n.left=window.scrollX,n.bottom=window.scrollY+this.outerHeight(),n.right=window.scrollX+this.outerWidth(),n):t instanceof DocumentFragment?n:(r=t.style.display,t.style.display="inline-block",i=t.getBoundingClientRect(),n.left=i.left+window.scrollX,n.top=i.top+window.scrollY,n.right=n.left+i.width,n.bottom=n.top+i.height,t.style.display=r,n)};n.prototype.attr=function(n,i){if(this.elements!=null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)!==!0)return i===undefined?this.elements.length===0?null:this.elements[0].getAttribute(n):(t(this.elements,function(t){t.nodeType===Node.ELEMENT_NODE&&(i===null?t.removeAttribute(n):t.setAttribute(n,i.toString()))}),this)};n.prototype.addClass=function(n){return f(this.elements,n,"add"),this};n.prototype.removeClass=function(n){return f(this.elements,n,"remove"),this};n.prototype.toggleClass=function(n,t){return f(this.elements,n,"toggle",t),this};n.prototype.hasClass=function(n,t){var r,e,i,u,f;if(typeof n!="string"||this.elements==null)return!1;for(r=!1,e=this.elements.length,i=0;i<e;i++)if(u=this.elements[i],u.nodeType===Node.ELEMENT_NODE){if(f=u.classList.contains(n),t===!0&&f===!1)return!1;if(f===!0&&(r=!0,t!==!0))break}return r};n.prototype.text=function(n){return t(this.elements,function(t){t.innerText!==undefined&&(t.innerText=n)}),this};n.prototype.on=function(n,i){if(n!=null&&typeof i=="function"&&this.elements!=null){typeof n=="string"&&(n=n.split(/\s+/));EVUI.Modules.Core.Utils.isArray(n)===!1&&(n=[n]);var r=n.length;r!=0&&t(this.elements,function(t){var u,f;if(t instanceof DocumentFragment!=!0)for(u=0;u<r;u++)(f=n[u],typeof f=="string")&&t.addEventListener(f,i)})}};n.prototype.off=function(n,i){if(n!=null&&typeof i=="function"&&this.elements!=null){typeof n=="string"&&(n=n.split(/\s+/));EVUI.Modules.Core.Utils.isArray(n)===!1&&(n=[n]);var r=n.length;r!=0&&t(this.elements,function(t){var u,f;if(!(t instanceof DocumentFragment))for(u=0;u<r;u++)(f=n[u],typeof f=="string")&&t.removeEventListener(f,i)})}};n.prototype.val=function(n){if(this.elements.length!==0)return typeof n!="undefined"?(this.elements[0].value=n,this):this.elements[0].value};n.prototype.css=function(n,i){var r,u;if(this.elements.length!==0)if(typeof n=="string"){if(n=h(n),n==null)return;if(typeof i=="undefined")try{return getComputedStyle(this.elements[0])[n]}catch(s){return}else t(this.elements,function(t){t.style!=null&&(t.style[n]=i)})}else if(EVUI.Modules.Core.Utils.isObject(n)===!0){var f={},e=[],o=0;for(r in n)(u=h(r),r!=null)&&(f[u]=n[r],o=e.push(u));t(this.elements,function(n){var t,i;if(n.style!=null)for(t=0;t<o;t++)i=e[t],n.style[i]=f[i]})}};var h=function(n){return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0?null:n.replace(c,function(n){return n.substring(1,n.length).toUpperCase()})},f=function(n,i,r,u){if(i!=null&&n!=null){typeof i=="string"&&(i=i.split(/\s+/));EVUI.Modules.Core.Utils.isArray(i)===!1&&(i=[i]);var f=i.length;f!=0&&t(n,function(n){var e,t;if(n.nodeType===Node.ELEMENT_NODE)for(e=0;e<f;e++)if(t=i[e],typeof t=="string")switch(r){case"add":n.classList.add(t);break;case"remove":n.classList.remove(t);break;case"toggle":typeof u=="boolean"?n.classList.toggle(t,u):n.classList.toggle(t)}})}},a=function(n,t){if(n===window)return document.documentElement.clientHeight;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return 0;if(n.nodeType===Node.DOCUMENT_NODE)return Math.max(document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight);var r=getComputedStyle(n),o=i(r.height),s=i(r.borderTop),h=i(r.borderBottom),u=s+h,c=i(r.marginTop),l=i(r.marginBottom),f=c+l,e=o+(u>0?u:0);return t===!0&&f>0&&(e+=f),e},v=function(n,t,r){if(n===window)return document.documentElement.clientWidth;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return 0;if(n.nodeType===Node.DOCUMENT_NODE)return Math.max(document.documentElement.scrollWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth);var r=getComputedStyle(n),o=i(r.width),s=i(r.borderLeft),h=i(r.borderRight),u=s+h,c=i(r.marginLeft),l=i(r.marginRight),f=c+l,e=o+(u>0?u:0);return t===!0&&f>0&&(e+=f),e},i=function(n){var i=n.indexOf("px"),t;return(i>0&&(n=n.substring(0,i)),t=parseFloat(n),isNaN(t)===!0)?0:t},y=function(n){var i,u,o,s,r,f,h,t,e;if(EVUI.Modules.DomTree!=null){if(i=EVUI.Modules.DomTree.Converter.htmlToDocumentFragment(n),i==null)return[];for(u=[],o=i.childNodes.length,t=0;t<o;t++)u.push(i.childNodes[t]);return u}for(s=document.createDocumentFragment(),r=document.createElement("div"),r.innerHTML=n,f=[],h=r.childNodes.length,t=0;t<h;t++)e=r.childNodes[0],s.appendChild(e),f.push(e);return f},e=function(n){var t=null,u,f,e,i,r;if(EVUI.Modules.Core.Utils.isElement(n)===!0)t=[n];else if(n instanceof Document||n===window)t=[n];else if(n instanceof DocumentFragment)t=[n];else if(typeof n=="string")t=y(n);else if(EVUI.Modules.Core.Utils.isjQuery(n)===!0)u=n,t=[],u.each(function(n,i){t.push(i)});else if(n instanceof NodeList)for(t=[],f=n.length,i=0;i<f;i++)t.push(n[i]);else if(EVUI.Modules.Core.Utils.isArray(n)===!0)for(t=[],e=n.length,i=0;i<e;i++)r=n[i],(EVUI.Modules.Core.Utils.isElement(r)||r instanceof DocumentFragment||r instanceof Document||r===window)&&t.push(r);else EVUI.Modules.Core.Utils.isDomHelper(n)===!0&&(t=n.elements.slice());return t},u=function(n,i,r){var u=[];return t(n,function(n){var o,t,c,h;if(n!==window&&(!(n===document||n instanceof DocumentFragment)||r!=="before"&&r!=="after")){var s=e(i),f=document.createDocumentFragment(),l=s.length;for(o=0;o<l;o++)if(t=EVUI.Modules.Core.Utils.isOrphanedNode(s[o])===!1?s[o].cloneNode(!0):s[o],t instanceof DocumentFragment){for(c=t.childNodes.length,h=0;h<c;h++)u.push(t.childNodes[h]);f.appendChild(t)}else u.push(t),f.appendChild(t);switch(r){case"append":n.append(f);break;case"prepend":n.prepend(f);break;case"before":n.before(f);break;case"after":n.after(f)}}}),new EVUI.Modules.Dom.DomHelper(u)},o=function(n){for(var r,t="",u=n.split(","),e=u.length,f=0,i=0;i<e;i++)(r=u[i].trim(),r.length!==0)&&(f>0&&(t+=", "),t+=":scope "+r,f++);return t},p=function(n,t){var i,u,r;if(typeof n=="string"&&n.trim().startsWith("<")===!1){try{if(i=null,t!=null)if(EVUI.Modules.Core.Utils.isElement(t))i=t.querySelectorAll(o(n));else if(t instanceof Document||t instanceof DocumentFragment)i=t.querySelectorAll(n);else if(EVUI.Modules.Core.Utils.isjQuery(t)===!0&&t.length>0)t=t[0],i=t.querySelectorAll(o(n));else if(EVUI.Modules.Core.Utils.isDomHelper(t)===!0&&t.elements.length>0)t=t.elements[0],i=t.querySelectorAll(o(n));else throw Error("Invalid context.");else i=document.querySelectorAll(n)}catch(f){}if(i==null)return[];for(n=[],u=i.length,r=0;r<u;r++)n.push(i[r])}else n=e(n);return n==null?[]:n.filter(function(n){return n instanceof Node||n===window||n===document||n instanceof DocumentFragment})};return n}();EVUI.Modules.Dom.ElementBounds=function(){this.top=0;this.left=0;this.bottom=0;this.right=0};EVUI.Modules.Dom.ElementBounds.prototype.toWindowRelativeBounds=function(){var t=window.pageXOffset,i=window.pageYOffset,n=new EVUI.Modules.Dom.ElementBounds;return n.top=this.top-i,n.bottom=this.bottom-i,n.left=this.left-t,n.right=this.right-t,n};$evui.control=function(n,t){return new EVUI.Modules.Dom.ControlInfo(n,t)};$evui.dom=function(n,t){return new EVUI.Modules.Dom.DomHelper(n,t)};Object.freeze(EVUI.Modules.Dom);EVUI.Modules.DomEvents={};EVUI.Modules.DomEvents.Dependencies={Core:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.DomEvents.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.DomEvents.Dependencies);EVUI.Modules.DomEvents.Constants={};EVUI.Modules.DomEvents.Constants.Fn_EventHandler=function(){};EVUI.Modules.DomEvents.Constants.Prop_EvuiArgsName="evuiArgs";Object.freeze(EVUI.Modules.DomEvents.Constants);EVUI.Modules.DomEvents.AsyncDomEventManager=function(){var i=EVUI.Modules.Core.Utils.getHashCode(EVUI.Modules.Core.Utils.makeGuid()).toString(36).replace(".",""),r=EVUI.Modules.Core.Utils.getHashCode(EVUI.Modules.Core.Utils.makeGuid()).toString(36).replace(".",""),n=EVUI.Modules.Core.Utils.getHashCode(EVUI.Modules.Core.Utils.makeGuid()).toString(36).replace(".",""),y=EVUI.Modules.Core.Utils.makeGuid(),t;typeof Symbol!="undefined"&&(i=Symbol(i),r=Symbol(r),n=Symbol(n));var p=0,w=0,b=0,k=0,e={},d=function(n){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.DomEvents.Dependencies);var r=this,i=n,t=new o(r,i);this.addAsyncEventListener=function(n,i,r){if(h(n)===!1)throw Error("String expected.");if(typeof i!="function")throw Error("Function expected.");it(t,n,i,r)};this.removeAsyncEventListener=function(n,i,r){if(h(n)===!1)throw Error("String expected.");if(typeof i!="function")throw Error("Function expected.");return a(t,n,i,r)};this.dispatchAsyncEvent=function(n){if(EVUI.Modules.Core.Utils.instanceOf(n,Event)===!1)throw Error("Event object expected.");return new Promise(function(i){ht(t,n,function(){i()})})};this.addToAsyncEventSession=function(n){var r=l(n),u;r!=null&&(u=r.composedPath.indexOf(i),u!==-1)&&(r.composedPathHandles[u]=t)}},o=function(n,t){this.eventerId=w++;this.eventer=n;this.target=t;this.eventQueue=[];this.bubbler=new EVUI.Modules.EventStream.BubblingEventManager;this.registeredEvents={};this.executing=!1};o.prototype.getRegisteredEvent=function(n){return this.registeredEvents[n]};o.prototype.getNextQueuedEvent=function(n,t){for(var i,e,o=this.eventQueue.length,r=null,f=-1,s=typeof t=="string",u=0;u<o;u++)if((i=this.eventQueue[u],s!==!0||i.type===t)&&(r==null||i.eventId<r.eventId)){if(e=l(i.sessionId),e==null)continue;e.currentTarget===this.target&&(r=i,f=u)}return n===!0&&f>-1&&this.eventQueue.splice(f,1),r};t=function(){this.eventType=null;this.numHandlers=0;this.triggeringHandler=null;this.executing=!1;this.pendingRemovals={};this.boundHandlers=[]};t.prototype.getBoundHandler=function(n){for(var i,t=0;t<this.numHandlers;t++)if(i=this.boundHandlers[t],i.userHandler===n||i.targetBoundHandler===n)return i;return null};t.prototype.isPendingRemoval=function(n){return this.pendingRemovals[n.handlerId]!=null};var v=function(){this.handlerId=p++;this.userHandler=null;this.targetBoundHandler=null;this.eventStreamHandler=null;this.options=null},g=function(){this.eventId=b++;this.type=null;this.clonedEventArgs=null;this.sessionId=null},nt=function(){this.eventSequenceId=-1;this.sessionId=null;this.eventType=null;this.target=null;this.currentTarget=null;this.composedPathHandles=[];this.composedPath=[];this.eventStream=null;this.aborted=!1;this.callback=null},tt=function(){this.eventSequenceId=-1;this.sessionId=null},it=function(n,i,r,u){var e,f;u=rt(u);e=n.getRegisteredEvent(i);e==null&&(e=new t,e.eventType=i,n.registeredEvents[i]=e);e.triggeringHandler==null&&(e.triggeringHandler=ut(n,i,u));f=new v;f.userHandler=r;f.targetBoundHandler=r.bind(n.target);f.options=u;f.eventStreamHandler=function(t){if(e.isPendingRemoval(f)!==!0)return f.options.once===!0&&a(n,i,f.listener,f.options),f.targetBoundHandler(t)};e.numHandlers=e.boundHandlers.push(f);n.bubbler.addEventListener(i,f.eventStreamHandler,EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.EventStream.EventStreamEventListenerOptions,u))},s=function(n){return typeof n!="object"||n==null?!1:typeof n.addEventListener!="function"?!1:typeof n.removeEventListener!="function"?!1:typeof n.dispatchEvent!="function"?!1:!0},h=function(n){return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1},rt=function(n){return n==null||typeof n!="object"?new EVUI.Modules.DomEvents.EventOptions:EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.DomEvents.EventOptions,n)},ut=function(t,i,u){var f=function(f){var v,l,a,s,h,o;try{if(ft(t,i)===!0&&f.preventDefault(),v=f.composedPath(),l=EVUI.Modules.Core.Utils.shallowExtend({},f,function(n,t){if(typeof t[n]=="function")return!1}),l.composedPath=function(){return v.slice()},l.preventDefault=function(){f.preventDefault()},a=v.slice(),u.capture===!0&&a.reverse(),s=new g,s.clonedEventArgs=l,s.type=i,s.composedPath=a,h=f[r],h==null){var y=k++,p=ot(t,y),w=f[n];delete f[n];h=new tt;h.eventSequenceId=y;h.sessionId=p;o=new nt;o.eventSequenceId=y;o.currentTarget=f.currentTarget;o.eventType=s.type;o.target=f.target;o.sessionId=p;o.composedPath=a;o.callback=w;e[p]=o;f[r]=h;f.bubbles===!1?o.composedPathHandles.push(t):st(o)}s.sessionId=h.sessionId;c(t,s)}catch(b){EVUI.Modules.Core.Utils.log('DomEvents: Error triggering async handlers for event "'+f.type+'": '+b.stack)}};return t.target.addEventListener(i,f,u),f},ft=function(n,t){var i,f,r,u;if(h(t)===!1||(i=n.getRegisteredEvent(t),i==null))return!1;for(f=i.boundHandlers.length,r=0;r<f;r++)if((u=i.boundHandlers[r],i.isPendingRemoval(u)!==!0)&&u.options.autoPreventDefault===!0)return!0;return!1},c=function(n,t){var i=l(t.sessionId);i!=null&&(n.executing===!0||i.currentTarget!==t.clonedEventArgs.currentTarget?n.eventQueue.push(t):et(n,t,i))},et=function(n,t,i){var r=n.getRegisteredEvent(t.type),u;n.executing=!0;u=new EVUI.Modules.EventStream.EventStream;u.context=t.clonedEventArgs.currentTarget;u.bubblingEvents=n.bubbler;u.processInjectedEventArgs=function(n){var r=new EVUI.Modules.DomEvents.AsyncDomEventArgs;return EVUI.Modules.Core.Utils.shallowExtend(r,t.clonedEventArgs),r.eventSequenceId=i.eventSequenceId,r.cancel=n.cancel,r.pause=n.pause,r.resume=n.resume,r.state=n.state,r.stopImmediatePropagation=function(){return n.stopPropagation()},r.stopPropagation=function(){i.aborted=!0},r};u.processReturnedEventArgs=function(n){u.eventState=n.state};u.addEvent(t.type,function(){});u.onComplete=function(){var h,y,s,l,v,o,u,f;if(n.executing=!1,r!=null&&r.pendingRemovals!=null)for(h=EVUI.Modules.Core.Utils.getProperties(r.pendingRemovals),y=h.length,s=0;s<y;s++)l=h[s],v=r.pendingRemovals[l],v!=null&&a(n,r,v),delete r.pendingRemovals[l];if(r.numHandlers===0&&r.triggeringHandler==null&&delete n.registeredEvents[r.eventType],o=i.composedPathHandles.indexOf(n),u=null,o!==-1&&(o++,u=i.composedPathHandles[o]),u!=null){for(i.currentTarget=u.target,f=u.getNextQueuedEvent(!0,t.type);f==null;){if(o++,u=i.composedPathHandles[o],u==null)break;i.currentTarget=u.target;f=u.getNextQueuedEvent(!0,t.type)}f!=null&&c(u,f)}if(u==null&&(delete e[i.sessionId],typeof i.callback=="function"))try{i.callback()}catch(p){EVUI.Modules.Core.Utils.log("Error invoking dispatchedEvent's callback");EVUI.Modules.Core.Utils.log(p)}f=n.getNextQueuedEvent(!0);f!=null&&c(n,f)};u.execute()},ot=function(n,t){return EVUI.Modules.Core.Utils.getHashCode(y+":"+n.eventerId+"-"+t).toString(36).replace(".","")},l=function(n){return e[n]},st=function(n){var r,t,i;if(EVUI.Modules.Core.Utils.isArray(n.composedPath)!==!1)for(r=n.composedPath.length,t=0;t<r;t++)(i=u(n.composedPath[t]),i!=null)&&i.addToAsyncEventSession(n.sessionId)},u=function(n){if(typeof n!="object"||n==null)return null;var t=n[i];return t==null&&(t=new d(n),n[i]=t),t},a=function(n,i,r,u){var f=null,e=null,o;return(f=EVUI.Modules.Core.Utils.instanceOf(i,t)===!0?i:n.getRegisteredEvent(i),f==null)?!1:(e=EVUI.Modules.Core.Utils.instanceOf(r,v)===!0?r:f.getBoundHandler(r),e==null)?!1:n.bubbler.removeEventListener(f.eventType,e.eventStreamHandler)===!1?!1:f.executing===!0?(f.pendingRemovals[e.handlerId]=e,!0):(o=f.boundHandlers.indexOf(e),o!==-1)?(f.boundHandlers.splice(o,1),f.numHandlers--,f.numHandlers===0&&(n.target.removeEventListener(f.eventType,f.triggeringHandler,u),f.triggeringHandler=null,delete n.registeredEvents[f.eventType]),!0):!1},ht=function(t,i,r){i[n]=r;t.target.dispatchEvent(i)},f=function(){};return f.prototype.addAsyncEventListener=function(n,t,i,r){if(s(n)===!1)throw Error("EventTarget expected.");var f=u(n);return f.addAsyncEventListener(t,i,r)},f.prototype.removeAsyncEventListener=function(n,t,i,r){if(s(n)===!1)throw Error("EventTarget expected.");var f=u(n);return f.removeAsyncEventListener(t,i,r)},f.prototype.dispatchAsyncEvent=function(n,t){if(s(n)===!1)throw Error("EventTarget expected.");var i=u(n);return i.dispatchAsyncEvent(t)},EventTarget.prototype.addAsyncEventListener=function(n,t,i){return EVUI.Modules.DomEvents.AsyncDomEventManager.addAsyncEventListener(this,n,t,i)},EventTarget.prototype.removeAsyncEventListener=function(n,t,i){return EVUI.Modules.DomEvents.AsyncDomEventManager.removeAsyncEventListener(this,n,t,i)},EventTarget.prototype.dispatchAsyncEvent=function(n){return EVUI.Modules.DomEvents.AsyncDomEventManager.dispatchAsyncEvent(this,n)},new f}();EVUI.Modules.DomEvents.EventOptions=function(){this.once=!1;this.capture=!1;this.autoPreventDefault=!1};EVUI.Modules.DomEvents.AsyncDomEventArgs=function(){this.eventSequenceId=-1;this.cancel=function(){return!1};this.pause=function(){return!1};this.resume=function(){return!1};this.stopImmediatePropagation=function(){return!1};this.stopPropagation=function(){return!1};this.state=null};Object.freeze(EVUI.Modules.DomEvents);EVUI.Modules.DomTree={};EVUI.Modules.DomTree.Dependencies={Core:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.DomTree.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.DomTree.Dependencies);EVUI.Modules.DomTree.Constants={};EVUI.Modules.DomTree.Constants.Fn_Selector=function(){};EVUI.Modules.DomTree.Constants.Fn_AttributeFilter=function(){};Object.freeze(EVUI.Modules.DomTree.Constants);EVUI.Modules.DomTree.DomTreeConverter=function(){var t,e;if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.DomTree.Dependencies);var n=EVUI.Modules.DomTree.DomTreeElementType,rt=["a","img","svg","link","script","audio","embed","object","source","video"],ut=["area","base","br","col","command","embed","hr","img","input","link","menuitem","meta","keygen","param","source","track","wbr"],c=/\&gt;|\&lt;/ig,ft=/\<!--|--\>|\<!\CDATA\[\[|\]\]\>/ig,et=/\<script|\<\/\s*script\s*\>|\<textarea|\<\/\s*textarea\s*\>|\<style|\<\/\s*style\s*\>|\<pre|\<\/\s*pre\s*\>|\<code|\<\/\s*code\s*\>/ig,ot=/\'|\"|\/\*|\*\/|\/\/"|`/g,st=/\<\/|\/\>|<|\>/g,ht=/\s|\>|\//,ct=/\<|\<\/\s*/,lt=/^on/i,at=/^\$evui\.dispatch\(`[a-z0-9]*\.[a-z0-9]*\`\)$/,vt=typeof String.prototype.matchAll!="undefined",l={},yt=function(){this.source=null;this.options=new EVUI.Modules.DomTree.DomTreeElementOptions;this.outputToString=!1;this.parseOptions=null};this.toDomTreeElement=function(n,t){if(n==null)return null;var i=o(n,t);return pt(i)};this.fromDomTreeElement=function(n,t){if(n==null)return null;var i=o(n,t);return b(i,!1)};this.fromDomTreeElementToString=function(n,t){if(n==null)return null;var i=o(n,t);return b(i,!0)};this.htmlToDocumentFragment=function(n,t){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return null;var i=g(n);return i.toNode(null,d(t))};this.htmlToDomTree=function(n,t){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return null;var i=g(n);return i.toDomTree(null,d(t))};var o=function(n,t){var i=new yt,u,e,r,f;if(i.source=n,i.options=t!=null?EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.DomTree.DomTreeElementOptions,t):new EVUI.Modules.DomTree.DomTreeElementOptions,EVUI.Modules.Core.Utils.isArray(i.options.omittedElements)===!1)i.options.omittedElements=[];else{for(u=[],e=i.options.omittedElements.length,r=0;r<e;r++)(f=i.options.omittedElements[r],typeof f=="string")&&u.push(f.toLowerCase());i.options.omittedElements=u}if(EVUI.Modules.Core.Utils.isArray(i.options.omittedElements)===!1)i.options.omittedAttributes=[];else{for(u=[],e=i.options.omittedAttributes.length,r=0;r<e;r++)(f=i.options.omittedAttributes[r],typeof f=="string")&&u.push(f.toLowerCase());i.options.omittedAttributes=u}return i.parseOptions=v(i.options),i.parseOptions.elementOptions.safeMode===!0&&a(i.parseOptions),i},a=function(n){n.elementOptions.includeOmittedElementOuterTag=!1;n.elementOptions.noInlineEventHandlers=!0;n.omittedElementsDic.script=!0},v=function(n){var i=new e,r,t;if(i.elementOptions=n,EVUI.Modules.Core.Utils.isArray(n.omittedElements)===!0)for(r=n.omittedElements.length,t=0;t<r;t++)i.omittedElementsDic[n.omittedElements[t].toLowerCase()]=!0;if(EVUI.Modules.Core.Utils.isArray(n.omittedAttributes)===!0)for(r=n.omittedAttributes.length,t=0;t<r;t++)i.omittedAttributesDic[n.omittedAttributes[t].toLowerCase()]=!0;return i},pt=function(t){var r=!1,i;return(EVUI.Modules.Core.Utils.instanceOf(t.source,Document)===!0&&(r=!0,t.source=t.source.documentElement),i=y(t,t.source),i==null)?null:(r===!0&&(i.type=n.Document),i)},y=function(t,i,r,u){var e,o,f;return i==null?null:(e=ni(i.nodeType),e===n.Unknown)?null:(o=i.nodeName.toLowerCase(),t.parseOptions.isOmittedTag(o)===!0&&t.options.includeOmittedElementOuterTag===!1)?null:(f=new EVUI.Modules.DomTree.DomTreeElement,f.flags=s(i),f.type=e,f.attrs=ti(i,t),f.tagName=i.nodeName,f.content=p(t,i,e),f.shadowContent=i.shadowRoot!=null?p(t,i,e,!0):undefined,t.options.includeNodeReferences===!0&&(f.node=i),wt(t,i,f,r)==!0&&(f.flags|=EVUI.Modules.DomTree.DomTreeElementFlags.HasForiegnResource),(u===!0||r!=null&&EVUI.Modules.Core.Utils.hasFlag(r.flags,EVUI.Modules.DomTree.DomTreeElementFlags.IsInShadowDom))&&(f.flags|=EVUI.Modules.DomTree.DomTreeElementFlags.IsInShadowDom),f)},s=function(n){return n==null?EVUI.Modules.DomTree.DomTreeElementFlags.Unknown:n.nodeType===Node.TEXT_NODE||n.nodeType===Node.CDATA_SECTION_NODE||n.nodeType===Node.COMMENT_NODE?s(n.parentNode):n instanceof HTMLElement?EVUI.Modules.DomTree.DomTreeElementFlags.HTML:n instanceof CharacterData?s(n.parentElement):n instanceof Document?n.documentElement instanceof HTMLElement?EVUI.Modules.DomTree.DomTreeElementFlags.HTML:EVUI.Modules.DomTree.DomTreeElementFlags.XML:n instanceof DocumentFragment?n.ownerDocument.body instanceof HTMLElement?EVUI.Modules.DomTree.DomTreeElementFlags.HTML:EVUI.Modules.DomTree.DomTreeElementFlags.XML:EVUI.Modules.DomTree.DomTreeElementFlags.XML},wt=function(n,t,i,r){var u=bt(i.tagName),f,e;return u==null?!1:(n.options.absoluteUrls===!0&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f)===!1&&(f=kt(dt(i,u)),gt(i,u,f)),e=r==null?null:r.tagName.toLowerCase(),i.tagName==="link")?!0:i.tagName==="video"||i.tagName==="script"||i.tagName==="source"&&e==="video"?!0:!1},bt=function(n){return typeof n!="string"?null:(n=n.toLowerCase(),rt.indexOf(n)===-1)?null:n==="link"||n==="a"?"href":"src"},kt=function(n){var t,i;return n==null?null:(t=document.createElement("a"),t.href=n,i=t.protocol+"//"+t.host+t.pathname,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.search)===!1&&(i+=t.search.startsWith("?")===!1?"?"+t.search:t.search),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.hash)===!1&&(i+=t.hash.startsWith("#")===!1?"#"+t.hash:t.hash),i)},dt=function(n,t){var u,i,r,f;if(n.attrs==null||typeof t!="string")return null;for(t=t.toLowerCase(),u=n.attrs.length,i=0;i<u;i++)if(r=n.attrs[i],f=r.key.toLowerCase(),f===t)return r.val;return null},gt=function(n,t,i){var f,r,u,e;if(n.attrs!=null&&typeof t=="string"&&i!=null)for(t=t.toLowerCase(),f=n.attrs.length,r=0;r<f;r++)if(u=n.attrs[r],e=u.key.toLowerCase(),e===t){u.val=i.toString();return}},ni=function(t){switch(t){case 1:return n.Element;case 3:return n.Text;case 4:return n.CDATA;case 8:return n.Comment;case 9:return n.Document;case 11:return n.DocumentFragment;default:return n.Unknown}},ti=function(n,t){var e=n.attributes!=null?n.attributes.length:0,r,u,f,i;if(e===0)return undefined;for(r=[],u=0;u<e;u++)(f=n.attributes[u],t.parseOptions.omittedAttributesDic[f.name.toLowerCase()]!==!0)&&(i=new EVUI.Modules.DomTree.DomTreeElementAttribute,i.key=f.name,i.val=f.value,t.parseOptions.isOmittedAttribute(i,n.tagName)!==!0)&&r.push(i);return r.length===0?undefined:r},p=function(t,i,r,u){var o,f,s,c,e,l,h;if(u===!0&&i.shadowRoot==null)return[];if(o=i.nodeName.toLowerCase(),o==="iframe")return[];if(t.parseOptions.isOmittedTag(o)===!0&&t.options.includeOmittedElementOuterTag===!0)return(f=i.children.length,f===0&&w(i,i.outerHTML)===!0)?null:[];if(r===n.Text||r===n.CDATA||r===n.Comment)return i.textContent==null?"":i.textContent;if(r===n.Document||r===n.DocumentFragment||r===n.Element){if(f=u===!0?i.shadowRoot.childNodes.length:i.childNodes.length,f===0)return r===n.Element?w(i,i.outerHTML)===!0?null:i.textContent!=null&&i.textContent.length>0?i.textContent:[]:[];for(s=[],c=u===!0?i.shadowRoot.childNodes:i.childNodes,e=0;e<f;e++)l=c[e],h=y(t,l,i,u),h!=null&&s.push(h);return s}throw new Error("Unknown node type: "+i.nodeType);},w=function(n){return ut.indexOf(n.nodeName.toLowerCase())!==-1?!0:!1},b=function(n,t){var r=i(n,n.source),u;return t===!0?(u=document.createElement("div"),u.appendChild(r),u.innerHTML):n.source.type!==EVUI.Modules.DomTree.DomTreeElementType.DocumentFragment&&n.source.type!==EVUI.Modules.DomTree.DomTreeElementType.Document?r.childNodes[0]:r},u=function(n,t){var r="<"+t.tagName+"",u=ii(n,t),i,f;return t.content==null?(i="/>",u!=null?r+" "+u+i:r+" "+i):(i="<\/"+t.tagName+">",f=ri(n,t.content),u!=null?r+" "+u+">"+f+i:r+">"+f+i)},ii=function(n,t){var f,e,u,i,r;if(t.attrs==null)return null;for(f=null,t.DataUrl!=null&&t.DataUrl.Data!=null&&(f=t.DataUrl.AttributeName.toLowerCase()),e="",u=t.attrs.length,i=0;i<u;i++)r=t.attrs[i],e+=r.key.toLowerCase()===f?r.key+'="'+t.DataUrl.Data+(i===u-1?'"':'" '):r.key+'="'+r.val+(i===u-1?'"':'" ');return e},ri=function(n,t){var i,f,r;if(typeof t=="string")return t;if(i="",EVUI.Modules.Core.Utils.isArray(t)==!1)return i;for(f=t.length,r=0;r<f;r++)i+=u(n,t[r]);return i},i=function(n,t,i){i==null&&(i=document.createDocumentFragment());var r=null;if(t.type===EVUI.Modules.DomTree.DomTreeElementType.CDATA)r=document.createCDATASection(t.content);else if(t.type===EVUI.Modules.DomTree.DomTreeElementType.Comment)r=document.createComment(k(t.content));else{if(t.type===EVUI.Modules.DomTree.DomTreeElementType.Document)return ui(n,t);if(t.type===EVUI.Modules.DomTree.DomTreeElementType.Element)r=fi(n,t,i);else if(t.type===EVUI.Modules.DomTree.DomTreeElementType.Text)r=document.createTextNode(k(t.content));else{if(t.type===EVUI.Modules.DomTree.DomTreeElementType.DocumentFragment)return ei(n,t);throw Error("Invalid element type.");}}return i.appendChild(r),i},k=function(n){return typeof n!="string"?n:c.test(n)===!0?n.replace(c,function(n){return n==="&gt;"?">":n==="&lt;"?"<":n}):n},ui=function(n,t){var h=EVUI.Modules.Core.Utils.hasFlag(t.flags,EVUI.Modules.DomTree.DomTreeElementFlags.XML),w,p,s,a,c,f,b,r;if(typeof t.content=="string"||t.content==null)return w=t.content==null?u(n,u):t.content,c=new DOMParser,c.parseFromString(w,h===!0?"text/xml":"text/html");if(EVUI.Modules.Core.Utils.isArray(t.content)===!0){var l=[],k=t.content.length,v=null,e=null,o=null,y=!1;for(r=0;r<k;r++)p=t.content[r],s=i(n,p),h===!1&&y===!1&&(a=p.tagName.toLowerCase(),a==="html"?(v=s,y=!0):a==="head"?e=s:a==="body"&&(o=s),o!=null&&e!=null&&(y=!0)),l.push(s);if(c=new DOMParser,f=c.parseFromString("",h===!0?"text/xml":"text/html"),h===!0)f.documentElement.childNodes.forEach(function(n){n.remove()}),f.documentElement.appendChild(l[0].childNodes[0]);else if(v!=null)f.documentElement.replaceWith(v.childNodes[0]);else if(e!=null||o!=null)e!=null&&f.head.replaceWith(e.childNodes[0]),o!=null&&f.body.replaceWith(o.childNodes[0]);else for(b=l.length,r=0;r<b;r++)f.append(l[r].childNodes);return f}return null},fi=function(n,t){var f=null,h,o,c,s,l,e,r;if(t.content==null)h=u(n,t),o=document.createElement("div"),o.innerHTML=h,f=o.childNodes[0],f.remove();else{if(f=document.createElement(t.tagName),t.attrs!=null)for(c=t.attrs.length,r=0;r<c;r++)s=t.attrs[r],f.setAttribute(s.key,s.val);if(typeof t.content=="string")f.textContent=t.content,f.textContent=t.content;else if(EVUI.Modules.Core.Utils.isArray(t.content)===!0)for(e=t.content.length,r=0;r<e;r++)i(n,t.content[r],f)}if(EVUI.Modules.Core.Utils.isArray(t.shadowContent)===!0)for(l=f.attachShadow({mode:"open"}),e=t.shadowContent.length,r=0;r<e;r++)i(n,t.shadowContent[r],l);return f},ei=function(n,t){var u=document.createDocumentFragment(),f,r;if(typeof t.content=="string")u.appendChild(t.content);else if(EVUI.Modules.Core.Utils.isArray(t.content)===!0)for(f=t.content.length,r=0;r<f;r++)i(n,t.content[r],u);return u},d=function(n){var i=n==null||typeof n!="object"?new EVUI.Modules.DomTree.DomTreeElementOptions:EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.DomTree.DomTreeElementOptions,n),t=v(i);return t.elementOptions.safeMode===!0&&a(t),t},g=function(n){var t=new yi,i;return t.rawHtml=n,t.rawHtmlLength=n.length,t.literalTextSpans=oi(t),t.literalTextSpans=t.literalTextSpans.concat(si(t)),t.literalTextSpans.sort(function(n,t){return n.start-t.start}),i=new r,i.htmlContent=t.rawHtml,i.index=0,i.length=t.rawHtml.length,i.blockType=EVUI.Modules.DomTree.DomTreeElementType.DocumentFragment,i.tagName="#document-fragment",hi(t),t.currentTagClose=t.tagCloses[0],t.currentTagOpen=t.tagOpens[0],t.lastTextSpanIndex=0,ci(t,i)},oi=function(n){var c=[],s,r,l,h,i;f(n,ot,c);f(n,ft,c);c.sort(function(n,t){return n.index-t.index});var k=c.length,a=!1,v=!1,y=!1,p=!1,w=!1,b=!1,u=!0,o=[],e=0;for(s=0;s<k;s++)if(r=c[s],r[0]==="/*")u===!0&&(y=!0,e=r.index,u=!1);else if(r[0]==="*/")y===!0&&(i=new t,i.start=e,i.end=r.index+r[0].length,i.text=n.rawHtml.substring(i.start,i.end),o.push(i),y=!1,u=!0,e=0);else if(r[0]==="//"){if(u===!0)for(i=new t,i.start=r.index,l=n.rawHtml.indexOf("\n",r.index),l===-1&&n.rawHtml.indexOf("\r",r.index),i.end=l!==-1?l:n.rawHtml.length,i.text=n.rawHtml.substring(i.start,i.end),o.push(i);allMatches[s+1].index<i.end;)s++}else if(r[0]==='"'){if(h=r.index>1&&n.rawHtml[r.index-1]==="\\"&&n.rawHtml[r.index-2]!="\\",h===!0)continue;u===!0?(u=!1,a=!0,e=r.index):a===!0&&(i=new t,i.start=e,i.end=r.index+r[0].length,i.text=n.rawHtml.substring(i.start,i.end),o.push(i),a=!1,u=!0)}else if(r[0]==="'"){if(h=r.index>1&&n.rawHtml[r.index-1]==="\\"&&n.rawHtml[r.index-2]!="\\",h===!0)continue;u===!0?(u=!1,v=!0,e=r.index):v===!0&&(i=new t,i.start=e,i.end=r.index+r[0].length,i.text=n.rawHtml.substring(i.start,i.end),o.push(i),v=!1,u=!0)}else if(r[0]==="`"){if(h=r.index>1&&n.rawHtml[r.index-1]==="\\"&&n.rawHtml[r.index-2]!="\\",h===!0)continue;u===!0?(u=!1,p=!0,e=r.index):p===!0&&(i=new t,i.start=e,i.end=r.index+r[0].length,i.text=n.rawHtml.substring(i.start,i.end),o.push(i),p=!1,u=!0)}else r[0]==="<!--"?u===!0&&(u=!1,e=r.index+r[0].length,w=!0):r[0]==="-->"?u===!1&&w===!0&&(i=new t,i.start=e,i.end=r.index,i.text=n.rawHtml.substring(i.start,i.end),o.push(i),u=!0,w=!1):r[0].toLowerCase()==="<!cdata[["?u===!0&&(u=!1,e=r.index+r[0].length,b=!0):r[0]==="]\]>"&&u===!1&&b===!0&&(i=new t,i.start=e,i.end=r.index,i.text=n.rawHtml.substring(i.start,i.end),o.push(i),u=!0,b=!0);return o},si=function(n){var k=f(n,et),a=function(t,i){for(var r=n.rawHtml.indexOf(">",t);r!==-1&&r<i;){if(h(n,r)===!1)return r;r=n.rawHtml.indexof(">",r)}return-1},s=[],y=!1,p=!1,w=!1,b=!1,u=!0,d=k.length,e=0,v,r,c,l,i,o;for(n.lastTextSpanIndex=0,v=0;v<d;v++)(r=k[v],c=n.lastTextSpanIndex,h(n,r.index)!==!0)&&(l=r[0].toLowerCase(),l.indexOf("<script")!==-1?u===!0&&(y=!0,u=!1,e=r.index):r[0].match(/\<\/\s*script/i)!=null?y===!0&&(i=new t,o=a(e,r.index),i.start=o===-1?e:o+1,i.end=r.index,i.text=n.rawHtml.substring(i.start,i.end),s.push(i),n.lastTextSpanIndex=c,y=!1,u=!0):l.indexOf("<textarea")!==-1?u===!0&&(w=!0,u=!1,e=r.index):r[0].match(/\<\/\s*textarea/i)!=null?w===!0&&(i=new t,o=a(e,r.index),i.start=o===-1?e:o+1,i.end=r.index,i.text=n.rawHtml.substring(i.start,i.end),s.push(i),n.lastTextSpanIndex=c,w=!1,u=!0):l.indexOf("<style")!==-1?u===!0&&(p=!0,u=!1,e=r.index):r[0].match(/\<\/\s*style/i)!=null?p===!0&&(i=new t,o=a(e,r.index),i.start=o===-1?e:o+1,i.end=r.index,i.text=n.rawHtml.substring(i.start,i.end),s.push(i),n.lastTextSpanIndex=c,p=!1,u=!0):l.indexOf("<pre")!==-1?u===!0&&(b=!0,u=!1,e=r.index):r[0].match(/\<\/\s*pre/i)!=null&&b===!0&&(i=new t,o=a(e,r.index),i.start=o===-1?e:o+1,i.end=r.index,i.text=n.rawHtml.substring(i.start,i.end),s.push(i),n.lastTextSpanIndex=c,b=!1,u=!0));return s},h=function(n,t){for(var r,u=n.literalTextSpans.length,f=n.lastTextSpanIndex>=0?n.lastTextSpanIndex:0,i=f;i<u;i++){if(r=n.literalTextSpans[i],t>=r.start&&t<r.end)return n.lastTextSpanIndex=i,!0;if(r.start>t)return n.lastTextSpanIndex=i,!1}return!1},hi=function(n){var r=f(n,st),u,i,t;for(n.lastTextSpanIndex=0,u=r.length,i=0;i<u;i++)(t=r[i],h(n,t.index)!==!0)&&((t[0]===">"||t[0]==="/>")&&n.tagCloses.push(t),(t[0]==="<"||t[0]==="<\/")&&n.tagOpens.push(t));return},f=function(n,t,i){var f,u,r;if(i==null&&(i=[]),typeof n=="string"&&(f={rawHtml:n},n=f),vt===!0)for(u=n.rawHtml.matchAll(t),r=u.next();r!=null&&r.done!==!0;)i.push(r.value),r=u.next();else for(r=t.exec(n.rawHtml);r!=null;)i.push(r),r=t.exec(n.rawHtml);return i},ci=function(n,t){for(var b=n.index,w=t.index+t.length,h=null,o=null,l=null,v=[t],y=0,i=t,u,f,s,c,e,a,p;n.index<n.rawHtmlLength&&n.index<w;){if(u=li(n),u==null)return(s=nt(n,n.rawHtmlLength),s==null)?t:(t.content==null&&(t.content=[]),t.content.push(s),t);if(f=u[0],f==="<"||f==="<\/"){if(n.currentTagOpen=u,l==null||l.index<u.index-1||o===">")s=nt(n,u.index),s!=null&&(i.content==null&&(i.content=[]),c=i.content.length,c>0&&i.content[c-1].tagName==="#text"?i.content[c-1].content+=s.content:i.content.push(s));else if(o==="<"||o==="<\/"){n.tagOpenIndex++;n.currentTagOpen=n.tagOpens[n.tagOpenIndex];continue}n.tagOpenIndex++;n.index=u.index;n.currentTagOpen=n.tagOpens[n.tagOpenIndex];h=u;o=f}else if(f===">"||f==="/>"){if(n.currentTagClose=u,o==="<")if(e=new r,ai(n,e,h.index,u.index+1)===!0)e.index=h.index,f==="/>"?(e.isSelfClosing=!0,i.content==null&&(i.content=[]),i.content.push(e)):e.blockType===EVUI.Modules.DomTree.DomTreeElementType.Comment?(i.content==null&&(i.content=[]),i.content.push(e)):e.blockType===EVUI.Modules.DomTree.DomTreeElementType.CDATA?(i.content==null&&(i.content=[]),i.content.push(e)):(y=v.push(i),i.content==null&&(i.content=[]),i.content.push(e),i=e);else{n.tagCloseIndex++;n.currentTagClose=n.tagCloses[n.tagCloseIndex];continue}else if(o==="<\/"&&f===">")a=n.rawHtml.substring(h.index+2,u.index+1),p=tt(n,a,a.length,!0),i.tagName===p&&(i.length=u.index+f.length-i.index,i=v.pop(),y--);else if(o===">"||o==="/>"){n.tagCloseIndex++;n.currentTagClose=n.tagCloses[n.tagCloseIndex];continue}n.tagCloseIndex++;n.index=u.index+f.length;n.currentTagClose=n.tagCloses[n.tagCloseIndex];h=u;o=f;l=u}}return t},li=function(n){var i=n.currentTagClose==null?Number.MAX_VALUE:n.currentTagClose.index,r=n.currentTagOpen==null?Number.MAX_VALUE:n.currentTagOpen.index,t=Math.min(r,i);return t===Number.MAX_VALUE?null:t===i?n.currentTagClose:t===r?n.currentTagOpen:null},nt=function(n,t){var u,i;return n.index===t?null:(u=n.rawHtml.substring(n.index,t),u!=="")?(i=new r,i.blockType=EVUI.Modules.DomTree.DomTreeElementType.Text,i.index=n.index,i.length=u.length,i.tagName="#text",i.content=u,i):null},ai=function(n,t,i,r){var u=n.rawHtml.substring(i,r),f=u.length;return(t.tagName=tt(n,u,f,!1),t.tagName==="")?!1:(t.tagName==="#comment"?(t.blockType=EVUI.Modules.DomTree.DomTreeElementType.Comment,t.content=u.substring(4,f-3)):t.tagName==="#cdata"?(t.blockType=EVUI.Modules.DomTree.DomTreeElementType.CDATA,t.content=u.substring(9,f-3)):(t.blockType=EVUI.Modules.DomTree.DomTreeElementType.Element,t.attributes=vi(n,u.substring(t.tagName.length+1,f-1).trim())),!0)},tt=function(n,t,i,r){var e=r===!1?!0:!1,o,f,a,s;if(e===!0&&(e=/\'|\"|\s/.test(t)),e===!1&&(o=l[t],o!=null))return o;var h=0,u=0,c=t.match(ct);if(c!=null&&(u=c[0].length),t[u]==="!"){if(i>u+3&&t.substring(u+1,u+3)==="--")return"#comment";if(i>u+9&&t.substring(u+1,u+8).toLowerCase()==="![cdata[")return"#cdata"}if(i>4&&r===!0){if(t[i-4]==="-"&&t[i-3]==="-")return"#comment";if(t[i-4]==="]-"&&t[i-3]==="]")return"#cdata"}for(f=u;f<i;f++)if(a=t[f],ht.test(a)===!1)h=f;else break;return s=t.substring(u,h+1).toUpperCase(),e===!1&&(l[t]=s),s},vi=function(n,t){var o,v,y,i,l;if(t==="")return[];var r={rawHtml:t,attributes:[]},p=t,w=p.length,u=0,a=0,h=0,s=!0,f=!1,e=!1,c=!1;for(i=0;i<w;i++)if(o=p[i],o==="=")s===!0&&(a=i);else if(o==="'"){if(i>0&&t[i-1]==="\\")continue;if(e===!0||c===!0)continue;f===!1?(h=i,f=!0,s=!1):(it(r,u,a,h,i),u=i+1,f=!1,s=!0)}else if(o==='"'){if(i>0&&t[i-1]==="\\")continue;if(f===!0||c===!0)continue;e===!1?(h=i,e=!0,s=!1):(it(r,u,a,h,i),u=i+1,e=!1,s=!0)}else o==="("?(f===!0||e===!0)&&(c=!0):o===")"&&(f===!0||e===!0)&&(c=!1);if((r.attributes.length===0||u!=r.rawHtml.length)&&(v=t.substring(u,r.rawHtml.length).trim().split(/\s+/g),y=v.length,y>0))for(i=0;i<y;i++)l=new EVUI.Modules.DomTree.DomTreeElementAttribute,l.key=v[i],l.val="",r.attributes.push(l);return r.attributes},it=function(n,t,i,r,u){var e=n.rawHtml.substring(t,i).trim(),o,s,h,c,f;if(e.length===0)return!1;if(/\s+/.test(e)===!0&&(o=e.split(/\s+/g),s=o.length,s>1)){for(h=0;h<s-1;h++)f=new EVUI.Modules.DomTree.DomTreeElementAttribute,f.key=o[h].toLowerCase(),f.val="",n.attributes.push(f);e=o[s-1]}return c=n.rawHtml.substring(r+1,u),f=new EVUI.Modules.DomTree.DomTreeElementAttribute,f.key=e.toLowerCase(),f.val=c,n.attributes.push(f),!0},yi=function(){this.rawHtml=null;this.rawHtmlLength=0;this.index=0;this.tagOpenIndex=0;this.tagCloseIndex=0;this.literalTextSpans=[];this.lastTextSpanIndex=0;this.tagOpens=[];this.tagCloses=[];this.currentTagOpen=null;this.currentTagClose=null},r=function(){this.index=-1;this.length=-1;this.blockType=EVUI.Modules.DomTree.DomTreeElementType.Unknown;this.tagName=null;this.attributes=[];this.content=[];this.htmlContent=null;this.isSelfClosing=!1};r.prototype.toNode=function(n,t){var r=null,o,s,h,u,f,i,e;if(this.blockType===EVUI.Modules.DomTree.DomTreeElementType.Text)r=document.createTextNode(this.content);else if(this.blockType===EVUI.Modules.DomTree.DomTreeElementType.DocumentFragment)for(r=document.createDocumentFragment(),f=this.content.length,i=0;i<f;i++)e=this.content[i],e.toNode(r,t);else if(this.blockType===EVUI.Modules.DomTree.DomTreeElementType.CDATA)r=document.createCDATASection(this.content);else if(this.blockType===EVUI.Modules.DomTree.DomTreeElementType.Comment)r=document.createComment(this.content);else{if(o=!1,s=!1,t.isOmittedTag(this.tagName)===!0)if(t.elementOptions.includeOmittedElementOuterTag===!0)s=!0,this.tagName==="script"&&(o=!0);else return null;for(r=document.createElement(this.tagName),h=this.attributes.length,i=0;i<h;i++)(u=this.attributes[i],t.isOmittedAttribute(u,this.tagName)!==!0)&&(o!==!0||u.key.toLowerCase()!=="src")&&r.setAttribute(u.key,u.val);if(s===!1)for(f=this.content.length,i=0;i<f;i++)e=this.content[i],e.toNode(r,t)}return n!=null&&n.append(r),r};r.prototype.toDomTree=function(n,t){var i=new EVUI.Modules.DomTree.DomTreeElement,h,f,e,o,s,u,r;if(i.flags=EVUI.Modules.DomTree.DomTreeElementFlags.HTML,i.tagName=this.tagName,i.type=this.blockType,this.blockType===EVUI.Modules.DomTree.DomTreeElementType.Text||this.blockType===EVUI.Modules.DomTree.DomTreeElementType.Comment||this.blockType===EVUI.Modules.DomTree.DomTreeElementType.CDATA)i.content=this.content;else if(this.blockType===EVUI.Modules.DomTree.DomTreeElementType.DocumentFragment)for(i.content=[],u=this.content.length,r=0;r<u;r++)this.content[r].toDomTree(i,t);else if(this.blockType===EVUI.Modules.DomTree.DomTreeElementType.Element){if(h=!1,f=!1,t.isOmittedTag(this.tagName)===!0)if(t.elementOptions.includeOmittedElementOuterTag===!0)f=!0;else return null;if(this.attributes!=null){if(e=0,o=this.attributes.length,o>0)for(i.attrs=[],r=0;r<o;r++)(s=this.attributes[r],t.isOmittedAttribute(s,this.tagName)!==!0)&&(e=i.attrs.push(s));e===0&&(i.attrs=undefined)}if(this.isSelfClosing===!0)i.content=null;else if(i.content=[],f===!1)for(u=this.content.length,r=0;r<u;r++)this.content[r].toDomTree(i,t)}return n!=null&&n.content!=null&&n.content.push(i),i};t=function(){this.start=-1;this.end=-1;this.text=null};e=function(){this.elementOptions=null;this.omittedElementsDic={};this.omittedAttributesDic={}};e.prototype.isOmittedTag=function(n){return typeof n!="string"?!0:this.omittedElementsDic[n.toLowerCase()]===!0?!0:!1};e.prototype.isOmittedAttribute=function(n,t){var r,i,u,f;if(n==null||EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.key)==!0)return!0;if(r=!1,i=n.key.toLowerCase(),this.omittedAttributesDic[i]===!0?r=!0:this.elementOptions.noInlineEventHandlers===!0&&lt.test(n.key)===!0&&window[i]!==undefined&&(this.omittedAttributesDic[i]=!0,r=!0),r===!0&&this.elementOptions.inlineEventHandlerFilter!=null){if(this.elementOptions.noInlineEventHandlers===!0&&at.test(n.val)===!0)return!1;if(this.elementOptions.inlineEventHandlerFilter instanceof RegExp){if(this.elementOptions.inlineEventHandlerFilter.test(n.val)===!0)return!1}else if(typeof this.elementOptions.inlineEventHandlerFilter=="function"&&this.elementOptions.inlineEventHandlerFilter(n.key,n.val)===!0)return!1;return!0}return this.elementOptions.safeMode===!0&&((u=t.toLowerCase(),u==="script"&&i==="src")||(f=typeof n.val=="string"?n.val.toLowerCase():"",u==="link"&&(i==="as"||i==="rel")&&f==="script"))?!0:r}};EVUI.Modules.DomTree.DomTreeElement=function(){this.flags=EVUI.Modules.DomTree.DomTreeElementFlags.None;this.tagName=undefined;this.type=EVUI.Modules.DomTree.DomTreeElementType.Unknown;this.attrs=undefined;this.content=undefined;this.shadowContent=undefined;this.node=undefined};EVUI.Modules.DomTree.DomTreeElement.prototype.toNode=function(n){if(this.node!=null)return this.node;this.node=EVUI.Modules.DomTree.Converter.fromDomTreeElement(this,n);var t=function(n,i){var f,r,u;if(typeof n.content!="string"&&n.content!=null)for(f=n.content.length,r=0;r<f;r++)u=n.content[r],u.node=i.childNodes[r],t(u,u.node)};return t(this,this.node),this.node};EVUI.Modules.DomTree.DomTreeElement.prototype.search=function(n,t){var r=[],e,h,u,o,i,s,f;if(typeof n!="function"||n(this)===!0&&(r.push(this),t===!0))return r;if(this.content!=null&&typeof this.content!="string")for(e=this.content.slice(),h=e.length,u=0;u<h;u++)if(o=e[u],i=o==null?null:o.search(n),i!=null){if(s=i.length,t===!0&&s>0)return i;for(f=0;f<s;f++)r.push(i[f])}return r};EVUI.Modules.DomTree.DomTreeElement.prototype.clone=function(n){var t=new EVUI.Modules.DomTree.DomTreeElement,e,f,r,u,i;if(this.attrs!=null)for(t.attrs=[],e=this.attrs.length,i=0;i<e;i++)f=this.attrs[i],r=new EVUI.Modules.DomTree.DomTreeElementAttribute,r.key=f.key,r.val=f.val,t.attrs.push(r);if(t.flags=this.flags,t.tagName=this.tagName,t.type=this.type,this.content==null)return t;if(typeof this.content=="string")t.content=this.content;else if(EVUI.Modules.Core.Utils.isArray(this.content)===!0&&(t.content=[],n===!0))for(u=this.content.length,i=0;i<u;i++)t.content.push(this.content[i].clone(!0));if(EVUI.Modules.Core.Utils.isArray(this.shadowContent)===!0&&(t.shadowContent=[],n===!0))for(u=this.shadowContent.length,i=0;i<u;i++)t.content.push(this.shadowContent[i].clone(!0));return t};EVUI.Modules.DomTree.DomTreeElementFlags={None:0,HTML:1,XML:2,HasForiegnResource:4,IsInShadowDom:8};Object.freeze(EVUI.Modules.DomTree.DomTreeElementFlags);EVUI.Modules.DomTree.DomTreeElementAttribute=function(){this.key=null;this.val=null};EVUI.Modules.DomTree.DomTreeElementType={Unknown:0,Element:1,Text:2,Comment:3,Document:4,DocumentFragment:5,CDATA:6};Object.freeze(EVUI.Modules.DomTree.DomTreeElementType);EVUI.Modules.DomTree.DomTreeElementOptions=function(){this.safeMode=!1;this.omittedElements=[];this.omittedAttributes=[];this.includeOmittedElementOuterTag=!1;this.absoluteUrls=!1;this.includeNodeReferences=!1;this.noInlineEventHandlers=!1;this.inlineEventHandlerFilter=null};EVUI.Modules.DomTree.Converter=null,function(){var n=null;Object.defineProperty(EVUI.Modules.DomTree,"Converter",{get:function(){return n==null&&(n=new EVUI.Modules.DomTree.DomTreeConverter),n},configurable:!1,enumerable:!0})}();EVUI.Constructors.DomTree=EVUI.Modules.DomTree.DomTreeConverter;delete $evui.dromTree;$evui.domTree=null,function(){Object.defineProperty($evui,"domTree",{get:function(){return EVUI.Modules.DomTree.Converter},enumerable:!0})}();$evui.toDomTreeElement=function(n,t){return $evui.domTree.toDomTreeElement(n,t)};$evui.fromDomTreeElement=function(n,t,i){return i===!0?$evui.domTree.fromDomTreeElementToString(n,t):$evui.domTree.fromDomTreeElement(n,t)};$evui.parseHtml=function(n,t){return $evui.domTree.htmlToDocumentFragment(n,t)};$evui.parseHtmlToDomTree=function(n,t){return $evui.domTree.htmlToDomTree(n,t)};Object.freeze(EVUI.Modules.DomTree);EVUI.Modules.Enums={};EVUI.Modules.Enums.Dependencies={Core:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Enums.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Enums.Dependencies);EVUI.Modules.Enums.EnumValueGetter=function(){var n,t,s,h;if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Enums.Dependencies);n={};t={};this.getEnumValue=function(n,t,r){var s,h;if(n==null)return undefined;var u=null,f=null,e=null;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1)u=i(n),u.moduleEntry!=null&&(e=u.moduleEntry),u.enumEntry!=null&&(f=u.enumEntry);else if(typeof n=="object")e=o(n);else return undefined;return(f==null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!1&&(u=i(t),u.moduleEntry!=null&&(e=u.moduleEntry),u.enumEntry!=null&&(f=u.enumEntry)),f!=null&&u.enumValueKey==null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!1&&(s=t.toLowerCase(),u.enumEntry.values[s]!==undefined?u.enumValueKey=t:EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r)===!1&&(s=r.toLowerCase(),u.enumEntry.values[s]!==undefined&&(u.enumValueKey=r))),e==null)?undefined:(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(u.enumValueKey)===!1&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r)===!0&&(r=u.enumValueKey),r===undefined)?f.enumObj:typeof r!="string"?undefined:(h=f.enumObj[r],h!==undefined)?h:f.values[r.toLowerCase()]};this.getModule=function(t){if(typeof t!="string")return undefined;var r=t.toLowerCase(),i=n[r];return(i==null||EVUI.Modules[i.name]!==i.module)&&(e(),i=n[r],i==null)?undefined:i.module};this.getConstant=function(n,t){var r,u;if(n==null)return undefined;if(r=null,typeof n=="object"){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)return undefined;r=o(n)}else EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1&&(u=i(n),u.moduleEntry!=null&&(r=u.moduleEntry,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(u.enumValueKey)===!1&&(t=u.enumValueKey)));return r==null?undefined:typeof t!="string"?r.constants.enumObj:r.constants.values[t.toLowerCase()]};var i=function(n){var u,v,r,f,s;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return null;var t=new h,a=EVUI.Modules.Core.Utils.getValuePathSegments(n),o=a.length;for(u=0;u<o;u++)if(v=a[u],r=v.toLowerCase(),r!=="evui"&&r!=="modules"){if(t.moduleEntry==null&&(f=l(r),f!=null)){t.moduleEntry=f;continue}if(t.moduleEntry!=null&&r==="constants"?t.enumEntry=f.constants:t.moduleEntry!=null&&r==="dependencies"&&(t.enumEntry=f.dependencies),t.enumEntry==null&&(s=c(r),s!=null)){t.enumEntry=s;t.moduleEntry=s.module;continue}if(t.enumEntry!=null&&t.moduleEntry!=null&&u<=o-1){t.enumValueKey=a[o-1].toLowerCase();break}}return t.enumEntry==null?t.moduleEntry!=null&&o===1?t:e()===!0?i(n):t:t},e=function(){for(var t,s=Object.keys(EVUI.Modules),l=s.length,u=!1,e=0;e<l;e++){var o=s[e],h=o.toLowerCase(),i=EVUI.Modules[o],c=n[h];c==null?(t=new f,t.module=i,t.name=o,r(t,i),n[h]=t,u=!0):c.module!==i&&(r(t,i),u=!0)}return u},o=function(t){var u=null,e=null,s,a,o,h,c;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.name)===!1)e=t.name,u=EVUI.Modules[e];else if(t.Constants===undefined||t.Dependencies===undefined)(t===EVUI.Modules.Core||t.Settings!==undefined&&t.Utils!==undefined&&typeof t.Utils.stringIsNullOrWhitespace=="function")&&(e="Core",u=t);else for(s=Object.keys(EVUI.Modules),a=s.length,o=0;o<a;o++)if(h=s[o],c=EVUI.Modules[h],c===t){u=c;e=h;break}if(u==null)return null;var v=e.toLowerCase(),i=n[v],l=!1;return i==null&&(i=new f,i.name=e,i.module=u,n[v]=i,l=!0),i.module!==u&&(l=!0),l===!0&&r(i,t),i},r=function(n,i){for(var e,r,o,s,h=Object.keys(n.module),c=h.length,f=0;f<c;f++)delete t[h[f]];var l=Object.keys(i),a={},c=l.length,v=null,y=null;for(f=0;f<c;f++)if((e=l[f],r=i[e],r!=null)&&typeof r=="object"&&r.constructor===Object.prototype.constructor&&Object.isFrozen(r)!==!1){if(e==="Constants"){v=r;continue}else if(e==="Dependencies"){y=r;continue}o=u(r,e,n);o!=null&&(s=e.toLowerCase(),a[s]=o,t[s]=o)}n.enumEntries=a;n.module=i;n.constants=u(v,"Constants",n);n.dependencies=u(y,"Dependencies",n)},u=function(n,t,i){var r,f,o,u,e,h;if(n==null)return null;for(r=new s,r.name=t,r.module=i,r.enumObj=n,f=Object.keys(n),o=f.length,u=0;u<o;u++)e=f[u],h=n[e],r.values[e.toLowerCase()]=h;return r},c=function(n){return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0?undefined:t[n]},l=function(t){return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0?undefined:n[t]},f=function(){this.name=null;this.module=null;this.constants=null;this.dependencies=null;this.enumEntries={}};f.prototype.getEnumEntry=function(n){return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0?undefined:this.enumEntries[n]};s=function(){this.module=null;this.name=null;this.enumObj=null;this.values={}};h=function(){this.enumValueKey=null;this.enumEntry=null;this.moduleEntry=null}};EVUI.Modules.Enums.ValueGetter=null,function(){var n=null;Object.defineProperty(EVUI.Modules.Enums,"ValueGetter",{get:function(){return n==null&&(n=new EVUI.Modules.Enums.EnumValueGetter),n},configurable:!1,enumerable:!0})}();EVUI.Constructors.Enums=EVUI.Modules.Enums.EnumValueGetter;$evui.enum=function(n,t,i){return EVUI.Modules.Enums.ValueGetter.getEnumValue(n,t,i)};$evui.const=function(n,t){return EVUI.Modules.Enums.ValueGetter.getConstant(n,t)};$evui.module=function(n){return EVUI.Modules.Enums.ValueGetter.getModule(n)};Object.freeze(EVUI.Modules.Enums);EVUI.Modules.Events={};EVUI.Modules.Events.Dependencies={Core:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Events.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Events.Dependencies);EVUI.Modules.Events.Constants={};EVUI.Modules.Events.Constants.Fn_Handler=function(){};EVUI.Modules.Events.Constants.Fn_AskResultCallback=function(){};Object.freeze(EVUI.Modules.Events.Constants);EVUI.Modules.Events.EventManager=function(){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Events.Dependencies);var s=this,n=[],h=function(){this.eventListener=null;this.ordinal=null;this.mode=t.None},t={None:-1,FireUntilRemoved:0,FireOnce:1,Removed:2},i={None:-1,Trigger:0,Ask:1},c=function(){this.sessionID=EVUI.Modules.Core.Utils.makeGuid();this.triggerArgs=null;this.listeners=[];this.callback=null;this.mode=i.None;this.askResults=[];this.eventStream=null};this.on=function(n,i,u,f){return r(n,i,u,f,t.FireUntilRemoved)};this.once=function(n,i,u,f){return r(n,i,u,f,t.FireOnce)};this.off=function(t,i){for(var u,o,e,f=[],s=n.length,r=0;r<s;r++)if(u=n[r],u.eventListener.handlerId===t){f.push(u);break}else u.eventListener.eventName===t&&u.eventListener.handler===i&&f.push(u);for(o=f.length,r=0;r<o;r++)e=n.indexOf(f[r]),e!==-1&&n.splice(e,1)};this.trigger=function(n,t,r){var s=u(n,t,r),o=f(s,i.Trigger);o!=null&&e(o)};this.ask=function(n,t,r,o){typeof o!="function"&&(o=function(){});var h=u(n,t,r),s=f(h,i.Ask,o);if(s==null)return o([]);e(s)};this.askAsync=function(n,t,i){return new Promise(function(r){s.ask(n,t,i,function(n){r(n)})})};this.getEventListener=function(n){var t=p(n);return t==null?null:t.eventListener};var r=function(t,i,r,u,f){var e,s,a,c,l,o;if(t==null)return null;if(e=null,typeof t=="string"){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)throw Error("Event name must be a non-whitespace string.");if(typeof i!="function")throw Error("Event handler must be a function.");e=new EVUI.Modules.Events.EventListener(t,i,r,u)}else if(typeof t=="object"){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.eventName)===!0)throw Error("Event name must be a non-whitespace string.");if(typeof t.handler!="function")throw Error("Event handler must be a function.");e=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Events.EventListener(t.eventName,t.handler,t.priority,t.handlerName),t,["eventName","handler","priority","handlerName","handlerId"])}else throw Error("Invalid parameters. First parameter must be either a YOLO EventListener object or a non-whitespace string event name.");for(s=0,a=n.length,c=0;c<a;c++)l=n[c],l.eventListener.eventName===e.eventName&&l.ordinal>=s&&(s=l.ordinal+1);return o=new h,o.eventListener=e,o.mode=f,o.ordinal=s,n.push(o),e},u=function(n,t,i){var r=new EVUI.Modules.Events.EventTriggerArgs;if(typeof n=="string"&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1)r.eventName=n,r.data=t,r.triggerName=i;else if(typeof n=="object"){if(EVUI.Modules.Core.Utils.shallowExtend(r,n),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.eventName)===!0)throw Error("Event name must be a non-whitespace string.");}else throw Error("Invalid parameters. Parameter must be a YOLO EventTriggerArgs object or a non-whitespace string.");return r},f=function(n,t,i){var r,u;return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.eventName)===!0?null:(r=new c,r.triggerArgs=n,r.mode=t,r.callback=i,u=y(n.eventName),u==null||u.length===0)?null:(u=u.sort(function(n,t){return n.eventListener.priority===t.eventListener.priority?n.orindal-t.ordinal:t.eventListener.priority-n.eventListener.priority}),r.listeners=u,r.eventStream=l(r),r)},e=function(n){window.setTimeout(function(){n.eventStream.execute()})},l=function(n){var u=0,e=n.listeners.length,t=new EVUI.Modules.EventStream.EventStream,f,r;for(t.processInjectedEventArgs=function(t){var r=new EVUI.Modules.Events.EventManagerEventArgs(v(n,u));return r.data=n.triggerArgs.data,r.pause=t.pause,r.resume=t.resume,r.stopPropagation=t.stopPropagation,r.triggerName=n.triggerArgs.triggerName,n.mode===i.Ask&&(r.resume=function(i){t.resume()===!0&&o(n,r.listener,i,!0)}),t.error==null&&u++,r},t.processReturnedEventArgs=function(t,r){t instanceof EVUI.Modules.Events.EventManagerEventArgs&&(n.triggerArgs.data=t.data);n.mode===i.Ask&&o(n,t.listener,r)},t.endExecutionOnEventHandlerCrash=!1,f=n.listeners.length,r=0;r<f;r++)a(t,n,r);return n.mode===i.Ask&&t.addStep({key:"complete",name:"onComplete",type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){if(typeof n.callback=="function"){var i=new EVUI.Modules.Core.AsyncSequenceExecutionArgs;i.functions=n.callback;i.parameter=n.askResults;EVUI.Modules.Core.AsyncSequenceExecutor.execute(i,function(n){if(n!=null&&n.length>0)throw n[0];t.resolve()})}}}),t},a=function(i,r,u){if(i!=null&&r!=null&&!(r.listeners.length<u)){var f=r.listeners[u];f.mode!==t.Removed&&(i.addStep({name:f.eventListener.eventName+"-("+r.sessionID+")-"+u,key:f.eventListener.eventName,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(typeof f.eventListener.handler=="function"&&f.mode!==t.Removed)return n.listener.handler(n)}}),f.mode===t.FireOnce&&i.addStep({name:"removeFireOnce"+f.eventListener.eventName+"-("+r.sessionID+")-"+u,key:"remove:"+f.eventListener.eventName+"-"+u,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(i){f.mode=t.Removed;var r=n.indexOf(f);r!==-1&&n.splice(r,1);i.resolve()}}))}},v=function(n,t){var i=n.listeners[t];return i==null?null:i.eventListener},o=function(n,i,r,u){for(var s,e,c,h,o,l=n.listeners.length,f=0;f<l;f++)if(s=n.listeners[f],s.eventListener===i&&s.mode===t.Removed)return;for(e=null,c=n.askResults.length,f=0;f<c;f++)if(h=n.askResults[f],h.eventListner===i){e=h;break}e!=null?(u===!0||e.response===undefined)&&r!==undefined&&(e.response=r):(o=new EVUI.Modules.Events.AskResult,o.eventListner=i,o.response=r,n.askResults.push(o))},y=function(t){for(var r,u=[],f=n.length,i=0;i<f;i++)r=n[i],r.eventListener.eventName===t&&u.push(r);return u},p=function(t){for(var r,u=n.length,i=0;i<u;i++)if(r=n[i],r.eventListener.handlerId===t)return r}};EVUI.Modules.Events.EventListener=function(n,t,i,r){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw Error("event name must be a non-whitespace string.");if(typeof t!="function")throw Error("handler must be a function.");var u=EVUI.Modules.Core.Utils.makeGuid(),f=typeof i=="number"?i:0,e=n,o=t,s=typeof r=="string"?r:null;this.eventName=null;Object.defineProperty(this,"eventName",{get:function(){return e},enumerable:!0,configurable:!1});this.handler=null;Object.defineProperty(this,"handler",{get:function(){return o},enumerable:!0,configurable:!1});this.priority=0;Object.defineProperty(this,"priority",{get:function(){return f},enumerable:!0,configurable:!1});this.handlerId=u;Object.defineProperty(this,"handlerId",{get:function(){return u},enumerable:!0,configurable:!1});this.handlerName=null;Object.defineProperty(this,"handlerName",{get:function(){return s},configurable:!1,enumerable:!0})};EVUI.Modules.Events.EventListenerAddRequest=function(){this.eventName=null;this.handler=null;this.priority=null;this.handlerName=null};EVUI.Modules.Events.EventManagerEventArgs=function(n){var t=n;this.listener=null;Object.defineProperty(this,"listener",{get:function(){return t},configurable:!1,enumerable:!0});this.data=null;this.triggerName=null;this.pause=function(){};this.resume=function(){};this.stopPropagation=function(){}};EVUI.Modules.Events.EventTriggerArgs=function(){this.eventName=null;this.data=null;this.triggerName=null};EVUI.Modules.Events.AskResult=function(){this.eventListner=null;this.response=null};EVUI.Modules.Events.Manager=null,function(){var n=null,t=EVUI.Modules.Events.EventManager;Object.defineProperty(EVUI.Modules.Events,"Manager",{get:function(){return n==null&&(n=new t),n},configurable:!1,enumerable:!0})}();EVUI.Constructors.Events=EVUI.Modules.Events.EventManager;delete $evui.events;$evui.events=null;Object.defineProperty($evui,"events",{get:function(){return EVUI.Modules.Events.Manager},enumerable:!0});$evui.on=function(n,t,i,r){return $evui.events.on(n,t,i,r)};$evui.once=function(n,t,i,r){return $evui.events.once(n,t,i,r)};$evui.off=function(n,t){return $evui.events.off(n,t)};$evui.trigger=function(n,t,i){return $evui.events.trigger(n,t,i)};$evui.ask=function(n,t,i,r){return $evui.events.ask(n,t,i,r)};$evui.askAsync=function(n,t,i){return $evui.events.askAsync(n,t,i)};Object.freeze(EVUI.Modules.Events);EVUI.Modules.EventStream={};EVUI.Modules.EventStream.Dependencies={Core:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.EventStream.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.EventStream.Dependencies);EVUI.Modules.EventStream.Constants={};EVUI.Modules.EventStream.Constants.Fn_Job_Callback=function(){};EVUI.Modules.EventStream.Constants.Fn_Step_Handler=function(){};EVUI.Modules.EventStream.Constants.Fn_Job_Handler=function(){};EVUI.Modules.EventStream.Constants.Fn_Event_Handler=function(){};EVUI.Modules.EventStream.Constants.Fn_OnError=function(){};EVUI.Modules.EventStream.Constants.Fn_OnComplete=function(){};EVUI.Modules.EventStream.Constants.Fn_OnCancel=function(){};EVUI.Modules.EventStream.Constants.Fn_ProcessInjectedEventArgs=function(){};EVUI.Modules.EventStream.Constants.Fn_ProcessReturnedEventArgs=function(){};EVUI.Modules.EventStream.EventStream=function(n){var ut;if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.EventStream.Dependencies);var t=this,r=[],i=EVUI.Modules.EventStream.EventStreamStatus.NotStarted,o=-1,b=!1,v=!1,y=null,k=-1,d=[],it=0,p=!1,g=null,w=null,et=typeof Promise!="undefined",rt=!1,ct=!1,lt=et===!0?Promise.resolve():null,u=null,f=null;this.canSeek=!0;this.endExecutionOnEventHandlerCrash=!1;this.timeout=-1;this.jobState={};this.eventState={};this.context=null;this.bubblingEvents=null;this.skipInterval=EVUI.Modules.Core.Settings.stepsBetweenWaits;this.extendSteps=!0;this.getStatus=function(){return i};this.getSteps=function(){return r.slice()};this.getCurrentStep=function(){return u};this.isWorking=function(){return!tt()};this.getStep=function(n,t){var i=wt(n,t);return i==null?null:i};this.clear=function(){return tt()===!1?!1:(r=[],this.bubblingEvents=null,this.reset(),!0)};this.onError=function(){};this.onCancel=function(){};this.onComplete=function(){};this.execute=function(){return this.reset()===!1?!1:(i=EVUI.Modules.EventStream.EventStreamStatus.Working,s(function(){u=r[0];c(r,0)}),!0)};this.executeAsync=function(){return new Promise(function(n,i){if(t.execute()===!1){p=!1;g=null;w=null;i(new EVUI.Modules.EventStream.EventStreamError("Failed to reset EventStream, cannot begin execution."));return}p=!0;g=n;w=i})};this.reset=function(){if(tt()===!1)return!1;if(e(),i=EVUI.Modules.EventStream.EventStreamStatus.NotStarted,t.eventState=t.eventState===undefined?{}:t.eventState,t.jobState=t.jobState===undefined?{}:t.jobState,u=null,o=-1,v=!1,f=null,y=null,b=!1,_timeout=-1,d=[],it=0,p===!0){p=!1;var n=w;g=null;w=null;n(new EVUI.Modules.EventStream.EventStreamError("Stream was reset before Promise resolution."))}return!0};this.processInjectedEventArgs=function(n){return n};this.processReturnedEventArgs=function(){};this.cancel=function(){if(i===EVUI.Modules.EventStream.EventStreamStatus.Working)i=EVUI.Modules.EventStream.EventStreamStatus.Canceled;else{if(i===EVUI.Modules.EventStream.EventStreamStatus.Canceled||i===EVUI.Modules.EventStream.EventStreamStatus.Finished||i===EVUI.Modules.EventStream.EventStreamStatus.Error)return!1;var n=l(u,r,!0);st(n);h(n)}return!0};this.pause=function(){return i===EVUI.Modules.EventStream.EventStreamStatus.Working?(i=EVUI.Modules.EventStream.EventStreamStatus.Paused,o=r.indexOf(u),b===!0?v=!0:o++,e(),!0):!1};this.resume=function(){if(i!==EVUI.Modules.EventStream.EventStreamStatus.Paused)return!1;if(i=EVUI.Modules.EventStream.EventStreamStatus.Working,v===!0)v=!1,o=-1,s(function(){ot(y,u,r)});else if(rt===!1){var n=o;o=-1;ft(r[n-1],function(){s(function(){c(r,n)},0)})}else ct=!0;return!0};this.seek=function(n){var f,e;if(t.canSeek!==!0)throw Error('Seeking disabled. Set "canSeek" to true.');return(f=null,typeof n=="number"?n>=0&&n<r.length&&(f=r[n]):typeof n=="string"?f=t.getStep(n):typeof n=="object"&&r.indexOf(n)!==-1&&(f=n),f==null)?!1:(e=i===EVUI.Modules.EventStream.EventStreamStatus.Working,i=EVUI.Modules.EventStream.EventStreamStatus.Seeking,o=r.indexOf(f),u=f,v=!1,y=null,d=[],e===!1&&s(function(){c(r,o)}),!0)};this.error=function(n,t){if(tt()===!0)return!1;if(f=new EVUI.Modules.EventStream.EventStreamError("A manual error was thrown"+(typeof t=="string"&&t.length>0?": "+t:"."),n,EVUI.Modules.EventStream.EventStreamStage.ErrorCommand,u!=null?u.key:null),i===EVUI.Modules.EventStream.EventStreamStatus.Working)i=EVUI.Modules.EventStream.EventStreamStatus.Error;else if(i===EVUI.Modules.EventStream.EventStreamStatus.Paused){e();var o=l(u,r,!0,n);a(o);h(o)}};this.stopPropagation=function(){return u==null?!1:EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(u.key)===!0?!1:(d.indexOf(u.key)===-1&&d.push(u.key),!0)};this.addStep=function(n){if(n==null)return null;var t=null;if(typeof n=="function")t=new EVUI.Modules.EventStream.EventStreamStep,t.key=EVUI.Modules.Core.Utils.makeGuid(),t.name="Step "+r.length+" ("+t.key+")",t.handler=n;else if(typeof n=="object")this.extendSteps===!1?(t=new EVUI.Modules.EventStream.EventStreamStep,t.handler=n.handler,t.key=n.key,t.name=n.name,t.timeout=n.timeout,t.type=n.type):t=EVUI.Modules.Core.Utils.instanceOf(n,EVUI.Modules.EventStream.EventStreamStep)===!1?EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.EventStream.EventStreamStep,n):n,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.key)===!0&&(t.key=EVUI.Modules.Core.Utils.makeGuid()),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.name)===!0&&(t.name="Step "+r.length+" ("+t.key+")");else throw Error("Unrecognized input. Must be an object or function.");return r.push(t),this};this.addJob=function(n,t,i,r){var u=ut(n,t,i,r);return u.type=EVUI.Modules.EventStream.EventStreamStepType.Job,this.addStep(u)};this.addEvent=function(n,t,i,r){var u=ut(n,t,i,r);return u.type=EVUI.Modules.EventStream.EventStreamStepType.Event,this.addStep(u)};ut=function(n,i,r,u){var u=null,o=null,s=null,h=t.timeout,f=!1,e;if(typeof n=="function"?(u=n,n=null,f=!0):EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!1&&(o=n),f===!1&&typeof i=="function"?(u=i,i=null,f=!0):EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i)===!1&&(s=i),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i)===!0&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(o)===!1&&(s=o),f===!1&&typeof r=="function"?(u=r,r=null,f=!0):typeof r=="number"&&(h=r),f===!1&&typeof u=="function"&&(f=!0),f===!1)throw Error("Function expected.");return e=new EVUI.Modules.EventStream.EventStreamStep,e.handler=u,e.key=o,e.name=s,e.timeout=h,e};this.getPromiseResolutionValue=function(){};var c=function(n,t){if(nt(u,n)!==!1){var i=n[t];if(i==null)return h(l(u,n,!0));t++;u=i;at(i)}},at=function(n){var u,i;if(n==null&&t.error(null,"Failed to handle step, no step present."),u=EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.key)===!1&&d.indexOf(n.key)!==-1,typeof n.handler!="function"||u===!0){s(function(){c(r,r.indexOf(n)+1)});return}i=EVUI.Modules.EventStream.EventStreamStepType.Job;typeof n.type=="string"&&(i=EVUI.Modules.EventStream.EventStreamStepType.getStepType(n.type));i===EVUI.Modules.EventStream.EventStreamStepType.Job?vt(n):(i===EVUI.Modules.EventStream.EventStreamStepType.Event||i===EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent)&&yt(n)},vt=function(n){var o,v,i,c;ni(n);o=!1;v=function(t){o!==!0&&(o=!0,e(),s(function(){y=t;ot(t,n,r)}))};try{b=!0;i=new EVUI.Modules.EventStream.EventStreamJobArgs(t,v);i.resolvedValue=y==null?null:y.resolvedValue;i.key=n.key;i.name=n.name;t.context!=null?n.handler.call(t.context,i):n.handler(i)}catch(p){return b=!1,f=new EVUI.Modules.EventStream.EventStreamError("Job failed.",p,EVUI.Modules.EventStream.EventStreamStage.Job,n.key),e(),c=l(u,r,!0,f),a(c),h(c)}},yt=function(n){var e,o;if(rt=!0,e=dt(u,r),rt=!1,e instanceof ht)o=function(u){if(typeof t.processReturnedEventArgs=="function")try{var o=t.processReturnedEventArgs(e.args,u,n,t.jobState,t.eventState);if(EVUI.Modules.Core.Utils.isPromise(o)===!0)throw Error("processReturnedEventArgs cannot be an async function.");}catch(h){i=EVUI.Modules.EventStream.EventStreamStatus.Error;f=new EVUI.Modules.EventStream.EventStreamError("Error processing returned event args.",h,EVUI.Modules.EventStream.EventStreamStage.ProcessReturnedEventArgs,n.key)}nt(n,r)!==!1&&ft(n,function(){var t=r.indexOf(n);t>=0&&t++;s(function(){c(r,t)},0)})},e.promise.catch(function(t){f=new EVUI.Modules.EventStream.EventStreamError("Error executing event handler.",t,EVUI.Modules.EventStream.EventStreamStage.Handler,n.key);i=EVUI.Modules.EventStream.EventStreamStatus.Error;o(t)}),e.promise.then(function(n){o(n)});else{if(nt(n,r)===!1)return;ft(n,function(){var t=r.indexOf(n);t>=0&&t++;s(function(){c(r,t)},0)})}},ft=function(n,i){var r,h,f,e,o,s,u,c;if(t.bubblingEvents==null||typeof t.bubblingEvents.getBubblingEvents!="function"&&EVUI.Modules.Core.Utils.isArray(t.bubblingEvents)===!1)return i();r=null;try{if(EVUI.Modules.Core.Utils.isArray(t.bubblingEvents)===!0){for(r=[],h=t.bubblingEvents.length,f=0;f<h;f++)if((e=t.bubblingEvents[f],EVUI.Modules.Core.Utils.isObject(e)!==!1)&&typeof e.getBubblingEvents=="function")for(o=e.getBubblingEvents(n),u=o==null?0:o.length,s=0;s<u;s++)r.push(o[s])}else r=t.bubblingEvents.getBubblingEvents(n)}catch(l){return EVUI.Modules.Core.Utils.log(l),i()}if(r==null||(u=r.length,u===0))return i();c=new Promise(function(i){var f=new EVUI.Modules.EventStream.EventStreamConfig,e,o,s;for(f.context=t.context,f.canSeek=t.canSeek,f.endExecutionOnEventHandlerCrash=!0,f.eventState=t.eventState,f.processReturnedEventArgs=t.processReturnedEventArgs,f.skipInterval=t.skipInterval,f.extendSteps=t.extendSteps,f.timeout=typeof t.timeout=="number"?t.timeout:-1,f.onComplete=function(){i()},e=new EVUI.Modules.EventStream.EventStream(f),e.processInjectedEventArgs=function(n){var i=t.processInjectedEventArgs(n);return t.canSeek===!0&&i.seek!=null&&(i.seek=function(n,i){i===!0?(e.cancel(),t.seek(n)):e.seek(n)}),i},o=0;o<u;o++)(s=r[o],s!=null)&&e.addStep(pt(n,s));e.execute()});c.then(function(){i()})},pt=function(n,t){var i=new EVUI.Modules.EventStream.EventStreamStep;return i.key=t.eventName,i.tieout=n.timeout,i.type=EVUI.Modules.EventStream.EventStreamStepType.Event,i.handler=function(n){if(typeof t.handler=="function")return t.handler(n)},i},ot=function(n,t,i){if(b=!1,e(),kt(n),nt(t,i)!==!1){var r=i.indexOf(t);r>=0&&r++;s(function(){c(i,r)},0)}},wt=function(n,t){var f,e,u,i,t,o;if(typeof n!="string")return null;for(f=n.toLowerCase(),e=r.length,u=0;u<e;u++)if(i=r[u],i.key.toLowerCase()===f)if(t!=null){if(t=EVUI.Modules.EventStream.EventStreamStepType.getStepType(t),o=EVUI.Modules.EventStream.EventStreamStepType.getStepType(i.Type),t==o)return i}else return i;return null},l=function(n,i,r,u){var f,e;if(typeof r=="boolean"&&r!==!1&&(r=!0),n==null&&(n=new EVUI.Modules.EventStream.EventStreamStep),f=new EVUI.Modules.EventStream.EventStreamEventArgs(t.eventState),f.currentStep=i.indexOf(n),f.key=n.key,f.name=n.name,f.stepType=n.type,f.totalSteps=i.length,f.status=t.getStatus(),f.error=u,f.state=t.eventState,bt(f,n),typeof t.processInjectedEventArgs=="function"&&n.type!==EVUI.Modules.EventStream.EventStreamStepType.Job)try{if(e=t.processInjectedEventArgs(f,t.jobState),EVUI.Modules.Core.Utils.isPromise(e)===!0)throw Error("processInjectedEventArgs cannot be an async function.");e!=null&&typeof e=="object"&&(f=e)}catch(o){return(f.error=new EVUI.Modules.EventStream.EventStreamError("ProcessInjectedEventArgs failed.",o,EVUI.Modules.EventStream.EventStreamStage.ProcessInjectedEventArgs,n.key),f.error.innerError=u,f==null)?null:r===!0?f:(a(f),h(f),null)}return f},bt=function(n,r){if(n!=null&&typeof n=="object"){try{n instanceof EVUI.Modules.EventStream.EventStreamEventArgs&&(n.cancel=function(){return t.cancel()},n.pause=function(){return t.pause()},n.resume=function(){return t.resume()},n.seek=function(n){return t.seek(n)},n.stopPropagation=function(){return t.stopPropagation()})}catch(u){return f=new EVUI.Modules.EventStream.EventStreamError("Failed to add reserved handlers.",u,EVUI.Modules.EventStream.EventStreamStage.AttachEvents,r.key),i=EVUI.Modules.EventStream.EventStreamStatus.Error,a(n),h(n),null}return n}},kt=function(n){if(n==null)return null;if(n.success===!1||n.canceled===!0)n.canceled===!0?i=EVUI.Modules.EventStream.EventStreamStatus.Canceled:n.success===!1&&(f=new EVUI.Modules.EventStream.EventStreamError(n.message==null?"Job Error.":n.message,n.error,EVUI.Modules.EventStream.EventStreamStage.Job,u!=null?u.key:null),n.innerError!=null&&(f.innerError=n.innerError),i=EVUI.Modules.EventStream.EventStreamStatus.Error);else if(n.seeking==!0)i=EVUI.Modules.EventStream.EventStreamStatus.Seeking;else return null},dt=function(n,r){var u=null,e,o,h;if(n==null||typeof n.handler!="function")return u;if(e=l(n,r),e==null)return null;o=!1;try{u=t.context!=null&&n.type!==EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent?n.handler.call(t.context,e):n.handler(e)}catch(s){o=!0;f=new EVUI.Modules.EventStream.EventStreamError("Error executing event handler.",s,EVUI.Modules.EventStream.EventStreamStage.Handler,n.key)}if(typeof t.processReturnedEventArgs=="function"&&EVUI.Modules.Core.Utils.isPromise(u)===!1)try{if(h=t.processReturnedEventArgs(e,o===!0?f.exception:u,n,t.jobState,t.eventState),EVUI.Modules.Core.Utils.isPromise(h)===!0)throw Error("processReturnedEventArgs cannot be an async function.");}catch(s){o=!0;f=new EVUI.Modules.EventStream.EventStreamError("Error processing returned event args.",s,EVUI.Modules.EventStream.EventStreamStage.ProcessReturnedEventArgs,n.key)}return o===!0&&(i=EVUI.Modules.EventStream.EventStreamStatus.Error),EVUI.Modules.Core.Utils.isPromise(u)===!0?new ht(u,e):u},h=function(n){if(e(),i!==EVUI.Modules.EventStream.EventStreamStatus.Seeking){if(i!==EVUI.Modules.EventStream.EventStreamStatus.Canceled&&i!==EVUI.Modules.EventStream.EventStreamStatus.Error&&(i=EVUI.Modules.EventStream.EventStreamStatus.Finished),typeof t.onComplete=="function")try{n.status=i;n.cancel=function(){throw Error("Invalid operation: A terminating EventStream cannot be canceled.");};var r=t.onComplete(n);if(EVUI.Modules.Core.Utils.isPromise(r)===!0)throw Error("onComplete cannot be an async function.");}catch(u){EVUI.Modules.Core.Utils.log(u)}i!==EVUI.Modules.EventStream.EventStreamStatus.Seeking&&(t.jobState=undefined,t.eventState=undefined,gt())}},gt=function(){var n,i,r;if(p===!0)if(p=!1,n=w,i=g,g=null,w=null,f!=null&&f.stage!==EVUI.Modules.EventStream.EventStreamStage.Handler&&t.endExecutionOnEventHandlerCrash!==!0)n(f);else try{if(r=typeof t.getPromiseResolutionValue=="function"?t.getPromiseResolutionValue():undefined,r!==undefined)return i(r);i(!0)}catch(u){n(new EVUI.Modules.EventStream.EventStreamError("Failed to get promise resolution value.",u))}},a=function(n,r){var u,e;if(r!==!1&&(i=EVUI.Modules.EventStream.EventStreamStatus.Error),typeof t.onError=="function")try{if(u=f,f==null&&n.error!=null&&(u=n.error),n.cancel=function(){throw Error("Invalid operation: A terminating EventStream cannot be canceled.");},n.status=i,u!=null&&EVUI.Modules.Core.Utils.log(u.getErrorMessage()),e=t.onError(n,u),EVUI.Modules.Core.Utils.isPromise(e)===!0)throw Error("onError cannot be an async function.");return e}catch(o){return EVUI.Modules.Core.Utils.log(o),!1}else return!1},st=function(n){if(i=EVUI.Modules.EventStream.EventStreamStatus.Canceled,e(),typeof t.onCancel=="function")try{n.status=i;n.cancel=function(){throw Error("Invalid operation: A terminating EventStream cannot be canceled.");};var r=t.onCancel(n);if(EVUI.Modules.Core.Utils.isPromise(r)===!0)throw Error("onCancel cannot be an async function.");return r}catch(u){EVUI.Modules.Core.Utils.log(u)}},tt=function(){return i===EVUI.Modules.EventStream.EventStreamStatus.Canceled?!0:i===EVUI.Modules.EventStream.EventStreamStatus.Error?!0:i===EVUI.Modules.EventStream.EventStreamStatus.Finished?!0:i===EVUI.Modules.EventStream.EventStreamStatus.NotStarted?!0:!1},nt=function(n,y){var p;return i===EVUI.Modules.EventStream.EventStreamStatus.Canceled?(e(),p=l(n,y,!0),st(p),h(p),!1):i===EVUI.Modules.EventStream.EventStreamStatus.Error?(e(),p=l(n,y,!0,f),f!=null&&f.stage===EVUI.Modules.EventStream.EventStreamStage.Handler&&t.endExecutionOnEventHandlerCrash!==!0)?(a(p,!0),i=EVUI.Modules.EventStream.EventStreamStatus.Working,!0):(a(p),h(p),!1):i===EVUI.Modules.EventStream.EventStreamStatus.Paused?(e(),o===-1&&(o=y.indexOf(n),v===!1&&o++),!1):i===EVUI.Modules.EventStream.EventStreamStatus.Seeking?(e(),s(function(){i=EVUI.Modules.EventStream.EventStreamStatus.Working;c(r,o)}),!1):i===EVUI.Modules.EventStream.EventStreamStatus.Working||i===EVUI.Modules.EventStream.EventStreamStatus.NotStarted?!0:i===EVUI.Modules.EventStream.EventStreamStatus.Finished?(e(),!1):(f=new EVUI.Modules.EventStream.EventStreamError("Unrecognized status: "+i,null,null,n.key),e(),p=l(u,r,!0,f),a(p),h(p),!1)},e=function(){k!==-1&&(clearTimeout(k),k=-1)},ni=function(n){e();var i=typeof t.timeout!="number"?-1:t.timeout;n!=null&&typeof n.timeout=="number"&&n.timeout>=0&&(i=n.timeout);i>=0&&(k=setTimeout(function(){k=-1;ti()},i))},ti=function(){f=new EVUI.Modules.EventStream.EventStreamError("Step timeout hit.",null,u.type===EVUI.Modules.EventStream.EventStreamStepType.Job?EVUI.Modules.EventStream.EventStreamStage.Job:EVUI.Modules.EventStream.EventStreamStage.Handler,u.key);i=EVUI.Modules.EventStream.EventStreamStatus.Error;nt(u,r)},s=function(n){it++;et===!1||typeof t.skipInterval=="number"&&t.skipInterval>0&&it%t.skipInterval==0?typeof setImmediate=="function"?setImmediate(n):setTimeout(n):lt.then(n)},ii=function(n){n!=null&&(typeof n.canSeek=="boolean"&&(t.canSeek=n.canSeek),typeof n.endExecutionOnEventHandlerCrash=="boolean"&&(t.endExecutionOnEventHandlerCrash=n.endExecutionOnEventHandlerCrash),n.eventState!=null&&(t.eventState=n.eventState),n.jobState!=null&&(t.jobState=n.jobState),typeof n.skipInterval=="number"&&n.skipInterval>0&&(t.skipInterval=n.skipInterval),typeof n.timeout=="number"&&n.timeout>0&&(_timeout=n.timeout),EVUI.Modules.Core.Utils.instanceOf(n.bubblingEvents,EVUI.Modules.EventStream.BubblingEventManager)===!0&&(t.bubblingEvents=n.bubblingEvents),typeof n.extendSteps=="boolean"&&(t.extendSteps=n.extendSteps),typeof n.onCancel=="function"&&(t.onCancel=n.onCancel),typeof n.onError=="function"&&(t.onError=n.onError),typeof n.onComplete=="function"&&(t.onComplete=n.onComplete),typeof n.processInjectedEventArgs=="function"&&(t.processInjectedEventArgs=n.processInjectedEventArgs),typeof n.processReturnedEventArgs=="function"&&(t.processReturnedEventArgs=n.processReturnedEventArgs),typeof n.getPromiseResolutionValue=="function"&&(t.getPromiseResolutionValue=n.getPromiseResolutionValue),n.context!=null&&(t.context=n.context))},ht=function(n,t){this.promise=n;this.args=t};ii(n)};EVUI.Modules.EventStream.EventStreamStep=function(n,t,i,r,u){this.name=typeof r=="string"?r:null;this.key=typeof i=="string"?i:null;this.timeout=typeof u=="number"&&u>0?Math.floor(u):-1;this.handler=typeof n=="function"?n:function(){};this.type=typeof t=="string"?t:EVUI.Modules.EventStream.EventStreamStepType.Job};EVUI.Modules.EventStream.EventStreamJobResult=function(){this.resolvedValue=null;this.success=!1;this.canceled=!1;this.seeking=!1;this.message=null;this.error=null;this.innerError=null};EVUI.Modules.EventStream.EventStreamEventArgs=function(n){this.name=null;this.key=null;this.stepType=null;this.currentStep=-1;this.totalSteps=-1;this.error=null;this.status=EVUI.Modules.EventStream.EventStreamStatus.NotStarted;this.cancel=function(){return!1};this.pause=function(){return!1};this.resume=function(){return!1};this.seek=function(){return!1};this.stopPropagation=function(){return!1};this.state=n!=null?n:{}};EVUI.Modules.EventStream.EventStreamJobArgs=function(n,t){if(n instanceof EVUI.Modules.EventStream.EventStream==!1)throw TypeError("eventStream must be a EVUI.Modules.EventStream.EventStream");if(typeof t!="function")throw TypeError("Callback must be a function.");var i=n,r=t;this.name=null;this.key=null;this.resolvedValue=null;this.eventStream=i;this.cancel=function(){var n=new EVUI.Modules.EventStream.EventStreamJobResult;return n.canceled=!0,r(n)};this.seek=function(n){i.seek(n);var t=new EVUI.Modules.EventStream.EventStreamJobResult;return t.success=!0,t.seeking=!0,r(t)};this.resolve=function(n){var t=new EVUI.Modules.EventStream.EventStreamJobResult;return t.success=!0,t.resolvedValue=n,r(t)};this.reject=function(n,t,i){typeof n!="string"&&(n=n!=null?n.toString():"Process manually ended with an unknown error.");n instanceof Error&&(t=n);var u=new EVUI.Modules.EventStream.EventStreamJobResult;return u.success=!1,u.message=n,t instanceof Error&&(u.error=t),i instanceof EVUI.Modules.EventStream.EventStreamError&&(u.innerError=i),r(u)};this.getState=function(){return i.jobState};this.setState=function(n){return i.jobState=n,n}};EVUI.Modules.EventStream.EventStreamError=function(n,t,i,r){this.message=n;this.exception=t instanceof Error?t:null;this.stage=i;this.key=r;this.innerError=null;this.getErrorMessage=function(){var n="Error:";return this.message!=null&&(n+=" "+this.message+" "),this.stage!=null&&(n+="Stage: "+i+". "),this.key!=null&&(n+='Step: "'+this.key+'".'),this.exception!=null&&(n+="\nException: "+this.exception.stack),this.innerError!=null&&(n+="\nInnerError: "+this.innerError.getErrorMessage()),n}};EVUI.Modules.EventStream.EventStreamConfig=function(){this.canSeek=!0;this.endExecutionOnEventHandlerCrash=!1;this.timeout=-1;this.jobState={};this.eventState={};this.skipInterval=250;this.onCancel=null;this.onError=null;this.onComplete=null;this.processInjectedEventArgs=null;this.processReturnedEventArgs=null;this.getPromiseResolutionValue=null;this.bubblingEvents=null;this.context=null;this.extendSteps=!0};EVUI.Modules.EventStream.EventStreamEventListener=function(n,t,i,r){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw Error("event name must be a non-whitespace string.");if(typeof t!="function")throw Error("handler must be a function.");var f=EVUI.Modules.Core.Utils.makeGuid(),e=typeof i=="number"?i:0,s=n,o=t,u=typeof r=="boolean"?r:!1;this.eventName=null;Object.defineProperty(this,"eventName",{get:function(){return s},enumerable:!0,configurable:!1});this.handler=null;Object.defineProperty(this,"handler",{get:function(){return o},set:function(n){if(u===!0)throw Error("EventStreamEventListener is immutable and cannot be changed or removed.");if(n!=null&&typeof n!="function")throw Error("handler must be a function.");o=n},enumerable:!0,configurable:!1});this.priority=0;Object.defineProperty(this,"priority",{get:function(){return e},set:function(n){if(u===!0)throw Error("EventStreamEventListener is immutable and cannot be changed or removed.");if(typeof n!="number")throw Error("priority must be a number.");e=n},enumerable:!0,configurable:!1});this.handlerId=f;Object.defineProperty(this,"handlerId",{get:function(){return f},enumerable:!0,configurable:!1});this.immutable=!1;Object.defineProperty(this,"immutable",{get:function(){return u},enumerable:!0,configurable:!1})};EVUI.Modules.EventStream.EventStreamEventListenerOptions=function(){this.immutable=!1;this.once=!1;this.priority=null;this.eventType=EVUI.Modules.EventStream.EventStreamEventType.Event};EVUI.Modules.EventStream.BubblingEventManager=function(){var n={},t;this.addEventListener=function(i,r,u){var f=new t,l,o,e,s,a,h,c;if(EVUI.Modules.Core.Utils.instanceOf(i,EVUI.Modules.EventStream.EventStreamEventListener)===!0)f.listener=i,r!=null&&typeof r=="object"&&(u=r),u!=null&&typeof u=="object"?EVUI.Modules.Core.Utils.instanceOf(u,EVUI.Modules.EventStream.EventStreamEventListenerOptions)===!0?f.options=u:u=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.EventStream.EventStreamEventListenerOptions,u):f.options=new EVUI.Modules.EventStream.EventStreamEventListenerOptions,f.options.immutable=i.immutable;else{if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i)===!0)throw Error("eventKey must be a non-whitespace string.");if(typeof r!="function")throw Error("Function expected.");u=u==null||typeof u!="object"?new EVUI.Modules.EventStream.EventStreamEventListenerOptions:EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.EventStream.EventStreamEventListenerOptions,u);l=new EVUI.Modules.EventStream.EventStreamEventListener(i,r,u.priority,u.immutable);f.listener=l;f.options=u}for(o=typeof u.eventType=="string"?u.eventType.toLowerCase():u.eventType,u.eventType=o!==EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent&&o!==EVUI.Modules.EventStream.EventStreamEventType.Event?EVUI.Modules.EventStream.EventStreamEventType.Event:o,e=n[f.listener.eventName],e==null&&(e=[],n[f.listener.eventName]=e),s=0,a=e.length,h=0;h<a;h++)c=e[h],c.ordinal>=s&&(s=c.ordinal+1);return f.ordinal=s,e.push(f),f.listener};this.getBubblingEvents=function(t){var r=n[t.key],u,s,f,e,o,i;if(r==null||r.length===0)return null;for(u=[],s=r.length,i=0;i<s;i++){if(f=r[i],t.type===EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent){if(f.options.eventType!==EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent)continue;u.push(f)}else{if(f.options.eventType!==EVUI.Modules.EventStream.EventStreamEventType.Event)continue;u.push(f)}f.options.once===!0&&(index!==-1&&r.splice(i,1),i--)}if(r.length===0&&delete n[t.key],e=u.length,e===0)return null;for(u.sort(function(n,t){return n.listener.priority===t.listener.priority?n.orindal-t.ordinal:t.listener.priority-n.listener.priority}),o=[],i=0;i<e;i++)o.push(u[i].listener);return o};this.removeEventListener=function(t,i){var e=n[t],f,o,c,r,u;if(e!=null){for(f=!1,o=e.length,r=0;r<o;r++)if(u=e[r],u.listener.handler===i&&u.listener.immutable===!1&&(f=!0,e.splice(r,1),r--,o--,o===0)){delete n[t];break}return f}for(c in n){var s=n[c],f=!1,h=s.length;for(r=0;r<h;r++)u=s[r],u.listener.immutable===!1&&(u.handlerId===t||u.listener.handler===i)&&(s.splice(r,1),h--,h===0&&delete n[t],f=!0)}return f};t=function(){this.listener=null;this.options=null;this.ordinal=0}};EVUI.Modules.EventStream.EventStreamStatus={NotStarted:0,Working:1,Paused:2,Finished:3,Canceled:4,Error:5,Seeking:6};Object.freeze(EVUI.Modules.EventStream.EventStreamStatus);EVUI.Modules.EventStream.EventStreamStage={Job:"job",Handler:"handler",ProcessInjectedEventArgs:"processInjectedEventArgs",ProcessReturnedEventArgs:"processReturnedEventArgs",ErrorCommand:"errorCommand"};Object.freeze(EVUI.Modules.EventStream.EventStreamStage);EVUI.Modules.EventStream.EventStreamStepType={Job:"job",Event:"event",GlobalEvent:"global",getStepType:function(n){if(typeof n!="string")return this.Job;var t=n.toLowerCase();return t===this.Job?this.Job:t===this.Event?this.Event:t===this.GlobalEvent.toLowerCase()?this.GlobalEvent:this.Job}};EVUI.Modules.EventStream.EventStreamEventType={Event:"event",GlobalEvent:"global"};Object.freeze(EVUI.Modules.EventStream.EventStreamStepType);Object.freeze(EVUI.Modules.EventStream);EVUI.Constructors.EventStream=EVUI.Modules.EventStream.EventStream;EVUI.Modules.HtmlLoader={};EVUI.Modules.HtmlLoader.Dependencies={Core:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0}),Http:Object.freeze({required:!0}),DomTree:Object.freeze({required:!1})},function(){var n=!1;Object.defineProperty(EVUI.Modules.HtmlLoader.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.HtmlLoader.Dependencies);EVUI.Modules.HtmlLoader.Constants={};EVUI.Modules.HtmlLoader.Constants.Job_GetHtml="job.getHtml";EVUI.Modules.HtmlLoader.Constants.Job_InjectHtml="job.injectHtml";EVUI.Modules.HtmlLoader.Constants.Job_LoadChildren="job.loadChildren";EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID="evui-loader-placeholder-id";EVUI.Modules.HtmlLoader.Constants.Attr_ResourceUrl="evui-loader-placeholder-src";EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState="evui-loader-content-load-state";EVUI.Modules.HtmlLoader.Constants.Event_OnLoad="load";EVUI.Modules.HtmlLoader.Constants.Event_OnGetHtml="gethtml";EVUI.Modules.HtmlLoader.Constants.Event_OnInject="inject";EVUI.Modules.HtmlLoader.Constants.Event_OnLoadChildren="loadchildren";EVUI.Modules.HtmlLoader.Constants.Event_OnLoaded="loaded";EVUI.Modules.HtmlLoader.Constants.Event_OnComplete="complete";EVUI.Modules.HtmlLoader.Constants.StepPrefix="evui.htmlloader";EVUI.Modules.HtmlLoader.Constants.Fn_GetHtml_Callback=function(){};EVUI.Modules.HtmlLoader.Constants.Fn_GetPartials_Callback=function(){};EVUI.Modules.HtmlLoader.Constants.Fn_GetPlaceholder_Callback=function(){};EVUI.Modules.HtmlLoader.Constants.Fn_HtmlLoaderEventHandler=function(){};Object.freeze(EVUI.Modules.HtmlLoader.Constants);EVUI.Modules.HtmlLoader.HtmlLoaderController=function(n){var r,u,e;if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.HtmlLoader.Dependencies);var t=this,i=n,v=0,y=new EVUI.Modules.EventStream.BubblingEventManager;this.loadHtml=function(n,t){var f,r;if(n==null)throw Error("htmlRequestArgsOrUrl cannot be null.");typeof t!="function"&&(t=function(){});typeof n=="string"&&(f=n,n=new EVUI.Modules.HtmlLoader.HtmlRequestArgs,n.url=f);r=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.HtmlLoader.HtmlRequestArgs,n);r.httpArgs=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestArgs,r.httpArgs);r.httpArgs.responseType="text";r.httpArgs.method="GET";EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.url)===!1&&(r.httpArgs.url=r.url);i.httpManager.send(r.httpArgs,function(n){if(n.error!=null)return EVUI.Modules.Core.Utils.log(n.error.getErrorMessage()),t(null);u(n.xmlHttpRequest,function(n){return t(n)})})};this.loadHtmlAsync=function(n){if(n==null)throw new Error("htmlRequestArgsOrUrl cannot be null.");return new Promise(function(i){t.loadHtml(n,function(n){i(n)})})};this.loadHtmlPartials=function(n,t){if(n==null)throw new Error("partialLoadArgsOrPartialRequests cannot be null.");r(n,t)};this.loadHtmlPartialsAsync=function(n){if(n==null)throw new Error("partialLoadArgsOrPartialRequests cannot be null.");return new Promise(function(t){r(n,function(n){t(n)})})};r=function(n,t){var o,h,c,f;typeof t!="function"&&(t=function(){});EVUI.Modules.Core.Utils.isArray(n)===!0&&(o=n,n=new EVUI.Modules.HtmlLoader.HtmlPartialLoadArgs,n.htmlPartialLoadRequests=o);var s=[],e=[],r=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.HtmlLoader.HtmlPartialLoadArgs,n);if(r.httpArgs=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestArgs,r.httpArgs),r.htmlPartialLoadRequests.length===0)return callback([]);for(h=function(n){var f=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestArgs,r.httpArgs);f.context=n;f.method="GET";f.responseType="text";f.url=f.context.url;s.push(f.context);i.httpManager.send(f,function(i){u(i.xmlHttpRequest,function(i){return n.html=i,e.push(n),e.length===s.length?t(e):void 0})})},c=r.htmlPartialLoadRequests.length,f=0;f<c;f++)h(r.htmlPartialLoadRequests[f])};u=function(n,t){if(n==null||n.response==null||!(n.status>=200&&n.status<300||n.status===304))return t(null);try{switch(n.responseType){case"json":return t(JSON.stringify(n.response));case"document":return t(n.response.documentElement.outerHTML);case"blob":case"arraybuffer":var r=n.responseType==="blob"?n.response:new Blob([n.response]),i=new FileReader;i.onload=function(){return t(i.result)};i.readAsText(r);break;case"text":default:return t(n.response)}}catch(u){EVUI.Modules.Core.Utils.log(u);t(null)}};this.loadPlaceholder=function(n,t){s(n,t)};this.loadPlaceholderAsync=function(n){return new Promise(function(t){s(n,function(n){t(n)})})};this.loadAllPlaceholders=function(n,t){o(n,t)};this.loadAllPlaceholdersAsync=function(n){return new Promise(function(t){o(n,function(n){t(n)})})};this.addEventListener=function(n,t,i){return EVUI.Modules.Core.Utils.isObject(i)===!1&&(i=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),i.eventType=EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent,_entry.link.bubblingEvents.addEventListener(n,t,i)};this.removeEventListener=function(n,t){return _entry.link.bubblingEvents.removeEventListener(n,t)};var o=function(n,t){var h,r,i;typeof n=="string"?(h=n,n=new EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadArgs,n.placeholderID=h):(n=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadArgs,n),n.httpArgs=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestArgs,n.httpArgs));r=new EVUI.Modules.EventStream.EventStream;r.context=n;r.canSeek=!1;var u=[],o=[],s=null;s=EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.placeholderID)===!1?new EVUI.Modules.Dom.DomHelper("["+EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID+'="'+n.placeholderID+'"]',null).elements:c(null,n.forceReload,n.ignoreOnDemand);i=new e;i.allChildPlaceholders=s;i.eventStream=r;i.loadResults=u;i.placeholderArgs=n;i.placeholderID="*";i.placeholderElement=n.contextElement==null?n.contextElement:document.documentElement;l(i,t);r.addJob(function(n){for(var t,h=s.length,r=0;r<h;r++){var e=s[r],c=EVUI.Modules.Core.Utils.getElementAttributes(e),l=c.getValue(EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID);EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(l)!==!0&&(t=f(e,i.placeholderArgs,i,function(t){return u.push(t),u.length===o.length?n.resolve():void 0}),t!=null)&&(o.push(e),i.childSessions==null&&(i.childSessions=[]),i.childSessions.push(t),t.eventStream.execute())}return i.allChildPlaceholders=o,i.loadResults=u,o.length===0?n.cancel():void 0});a(i);r.execute()},s=function(n,t){var r,i;if(typeof n=="string"&&(r=n,n=new EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadArgs,n.placeholderID=r),i=f(n.placeholderID,n,null,function(n){typeof t=="function"&&t(n)}),i==null&&typeof t=="function")return t(null);i.eventStream.execute()},h=function(n,t){var i=new EVUI.Modules.Dom.DomHelper("["+EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID+'="'+n+'"]',t),r;return i.first()!=null?i.first():(r=new EVUI.Modules.Dom.DomHelper("["+EVUI.Modules.HtmlLoader.Constants.Attr_ResourceUrl+'="'+n+'"]',t),r.first())},p=function(n){var i=[],u,t,r;if(EVUI.Modules.Core.Utils.isArray(n)===!1)return i;for(u=n.length,t=0;t<u;t++)r=n[t],EVUI.Modules.Core.Utils.isElement(r)===!0&&i.push(r);return i},w=function(n){for(var t,u=new EVUI.Modules.Dom.DomHelper("["+EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID+"],["+EVUI.Modules.HtmlLoader.Constants.Attr_ResourceUrl+"],["+EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID+"]["+EVUI.Modules.HtmlLoader.Constants.Attr_ResourceUrl+"]",n),i=u.elements.slice(),f=i.length,r=0;r<f;r++)t=i[r],EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.getAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID))===!0&&t.setAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID,t.getAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_ResourceUrl));return i},c=function(n,t,i){for(var e=[],o=w(n),s=o.length,u=0;u<s;u++){var f=o[u],h=EVUI.Modules.Core.Utils.getElementAttributes(f),r=h.getValue(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState);if(r!=null){if(r=r.toLowerCase(),r===EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Loaded&&t!==!0)continue;if(r===EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.OnDemand&&i!==!0)continue;if(r===EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Loading||r===EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Pending)continue}f.setAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState,EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Pending);e.push(f)}return e},f=function(n,t,i,r){var f=null,a=!1,l,v,s,c,o,u;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)if(EVUI.Modules.Core.Utils.isElement(n)===!0)f=n,n=f.getAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID);else if(t!=null&&t.httpArgs!=null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.httpArgs.url)===!1)n=t.httpArgs.url,a=!0;else throw Error("placeholderID must be a non-whitespace string.");if(l=!1,i!=null)for(v=n.toLowerCase(),s=i;s!=null;){if(s.placeholderID.toLowerCase()===v){l=!0;break}s=s.parentSession}if(f==null&&(i!=null&&i.loadedFragment!=null?f=h(n,i.loadedFragment):a===!1&&(f=h(n,t.contextElement))),f==null)if(t!=null&&t.httpArgs!=null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.httpArgs.url)===!1)c=document.createElement("div"),c.setAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID,n),c.setAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_ResourceUrl,t.httpArgs.url),f=c;else throw Error("Cannot load placeholder - no placeholderID or loadable resource url present.");return l===!0?(f.setAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState,EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.CircularReference),r(null)):(o=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadArgs,t),o.httpArgs=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestArgs,o.httpArgs),o.httpArgs.headers=o.httpArgs.headers.map(function(n){return EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestHeader,n)}),o.PlaceholderID=n,u=new e,u.placeholder=new EVUI.Modules.HtmlLoader.HtmlPlaceholder(u),u.parentSession=i,u.placeholderArgs=o,u.placeholderElement=f,u.placeholderID=n,u.eventStream=nt(u,r),i!=null&&(i.childSessions==null&&(i.childSessions=[]),i.childSessions.push(u)),u.loadState=EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Pending,u)},l=function(n,t){n.eventStream.eventState=n.placeholderArgs.context;n.eventStream.processInjectedEventArgs=function(t){var i=new EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadEventArgs;return i.eventName=t.name,i.eventType=t.key,i.cancel=t.cancel,i.pause=t.pause,i.resume=t.resume,i.stopPropagation=t.stopPropagation,i.context=t.state,i.placeholder=n.placeholder,i};n.eventStream.processReturnedEventArgs=function(t,i,r){r.key===EVUI.Modules.HtmlLoader.Constants.Event_OnLoadChildren&&(n.selectedChildPlaceholders=p(n.allChildPlaceholders))};n.eventStream.onComplete=function(){if(typeof t=="function")return t(n.placeholder)};n.eventStream.onError=function(n,t){EVUI.Modules.Core.Utils.log(t.getErrorMessage())}},b=function(n){n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnLoad,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnLoad,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(typeof n.placeholderArgs.onLoad=="function")return n.placeholderArgs.onLoad.call(this,t)}});n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnLoad,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnLoad,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onLoad=="function")return t.onLoad.call(t,n)}})},k=function(n){n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnLoadChildren,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnLoadChildren,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(typeof n.placeholderArgs.onLoadChildren=="function")return n.placeholderArgs.onLoadChildren.call(this,t)}});n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnLoadChildren,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnLoadChildren,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onLoadChildren=="function")return t.onLoadChildren.call(t,n)}})},d=function(n){n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnInject,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnInject,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(typeof n.placeholderArgs.onInject=="function")return n.placeholderArgs.onInject.call(this,t)}});n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnInject,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnInject,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onInject=="function")return t.onInject.call(t,n)}})},g=function(n){n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnLoaded,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnLoaded,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(typeof n.placeholderArgs.onLoaded=="function")return n.placeholderArgs.onLoaded.call(this,t)}});n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnLoaded,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnLoaded,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onLoaded=="function")return t.onLoaded.call(t,n)}})},a=function(n){n.parentSession==null&&(n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnComplete,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnComplete,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(t){if(typeof n.placeholderArgs.onComplete=="function")return n.placeholderArgs.onComplete.call(this,t)}}),n.eventStream.addStep({key:EVUI.Modules.HtmlLoader.Constants.Event_OnComplete,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Event_OnComplete,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onComplete=="function")return t.onComplete.call(t,n)}}))},nt=function(n,i){var r=new EVUI.Modules.EventStream.EventStream;return n.eventStream=r,n.eventStream.context=n.placeholderArgs,n.eventStream.bubblingEvents=y,l(n,i),b(n),r.addStep({key:EVUI.Modules.HtmlLoader.Constants.Job_GetHtml,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Job_GetHtml,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(i){var u=EVUI.Modules.Core.Utils.getElementAttributes(n.placeholderElement),f=u.getValue(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState),e,r;if(f!=null&&f.toLowerCase()===EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Loaded&&n.placeholderArgs.forceReload===!1)return i.cancel();e=u.getValue(EVUI.Modules.HtmlLoader.Constants.Attr_ResourceUrl);r=new EVUI.Modules.HtmlLoader.HtmlRequestArgs;r.url=e;r.httpArgs=n.placeholderArgs.httpArgs;t.loadHtml(r,function(t){if(t!=null){var u=tt(t);n.loadedFragment=u;n.html=t;n.url=r.url;n.placeholderArgs.recursive===!0?(n.allChildPlaceholders=c(u,n.placeholderArgs.forceReload,n.placeholderArgs.ignoreOnDemand),n.selectedChildPlaceholders=n.allChildPlaceholders.slice()):(n.allChildPlaceholders=[],n.selectedChildPlaceholders=[])}return i.resolve()})}}),k(n),r.addStep({key:EVUI.Modules.HtmlLoader.Constants.Job_LoadChildren,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Job_LoadChildren,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){var s=n.selectedChildPlaceholders.length,i,e,r,o;if(s===0)return t.resolve();for(i=[],e=0,r=0;r<s;r++){var u=n.selectedChildPlaceholders[r],h=EVUI.Modules.Core.Utils.getElementAttributes(u),c=h.getValue(EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID);EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(c)!==!0&&(o=f(u,n.placeholderArgs,n,function(){e++;e===n.childSessions.length&&t.resolve()}),o!=null)&&(i.push(u),u.setAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState,EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Loading),n.loadState=EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Loading,o.eventStream.execute())}return n.selectedChildPlaceholders=i,i.length===0?t.resolve():void 0}}),d(n),r.addStep({key:EVUI.Modules.HtmlLoader.Constants.Job_InjectHtml,name:EVUI.Modules.HtmlLoader.Constants.StepPrefix+"."+EVUI.Modules.HtmlLoader.Constants.Job_InjectHtml,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(t){var i,r;n.loadedFragment!=null?(i=new EVUI.Modules.Dom.DomHelper(n.placeholderElement),i.empty(),r=i.append(n.loadedFragment),n.loadedContent=r.elements,i.attr(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState,EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Loaded),n.loadState=EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Loaded):(n.placeholderElement.setAttribute(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState,EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Failed),n.loadState=EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.Failed);t.resolve()}}),g(n),a(n),r},tt=function(n){var t,r,u,f;if(i.domTree!=null)return t=i.domTree.htmlToDocumentFragment(n),t==null&&(t=document.createDocumentFragment()),t;for(r=document.createElement("div"),r.innerHTML=n,u=document.createDocumentFragment();r.childNodes.length>0;)f=r.childNodes[0],u.append(f);return u},it=function(){(i==null||typeof i!="object")&&(i=new EVUI.Modules.HtmlLoader.HtmlLoaderControllerServices);(i.httpManager==null||typeof i.httpManager!="object")&&Object.defineProperty(i,"httpManager",{get:function(){return EVUI.Modules.Http.Http},configurable:!1,enumerable:!0});(i.domTree==null||typeof i.domTree!="object")&&Object.defineProperty(i,"domTree",{get:function(){return EVUI.Modules.DomTree==null?null:EVUI.Modules.DomTree.Converter},configurable:!1,enumerable:!0})};this.onLoad=function(){};this.onInject=function(){};this.onLoadChildren=function(){};this.onLoaded=function(){};this.onComplete=function(){};e=function(){this.id=v++;this.placeholder=null;this.parentSession=null;this.placeholderArgs=null;this.eventStream=null;this.childSessions=[];this.html=null;this.url=null;this.loadedFragment=null;this.loadedContent=null;this.placeholderElement=null;this.allChildPlaceholders=null;this.selectedChildPlaceholders=null;this.placeholderID=null;this.loadState=null};it()};EVUI.Modules.HtmlLoader.HtmlRequestArgs=function(){this.url=null;this.httpArgs=new EVUI.Modules.Http.HttpRequestArgs};EVUI.Modules.HtmlLoader.HtmlPartialLoadRequest=function(n,t){this.url=n==null?undefined:n;this.html=undefined;this.key=t==null?undefined:t};EVUI.Modules.HtmlLoader.HtmlPartialLoadArgs=function(){var n=[];this.htmlPartialLoadRequests=null;Object.defineProperty(this,"htmlPartialLoadRequests",{get:function(){return n},set:function(t){if(EVUI.Modules.Core.Utils.isArray(t)===!1)throw new Error("HtmlPartialLoadRequests must be an array.");n=t},configurable:!1,enumerable:!0});this.httpArgs=new EVUI.Modules.Http.HttpRequestArgs};EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadEventArgs=function(){this.placeholder=null;this.context=null;this.eventName=null;this.eventType=null;this.pause=function(){};this.resume=function(){};this.cancel=function(){};this.stopPropagation=function(){}};EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadArgs=function(){var n=null;this.placeholderID=null;this.recursive=!0;this.ignoreOnDemand=!1;this.forceReload=!1;this.httpArgs=new EVUI.Modules.Http.HttpRequestArgs;this.contextElement=null;Object.defineProperty(this,"contextElement",{get:function(){return n},set:function(t){var i=EVUI.Modules.Core.Utils.getValidElement(t);if(i!=null&&(t=i),t!=null&&EVUI.Modules.Core.Utils.isElement(t)===!1&&t instanceof Document==!1&&t instanceof DocumentFragment==!1)throw new Error("contextElement must be derived from Element.");n=t},configurable:!1,enumerable:!0});this.onLoad=function(){};this.onLoadChildren=function(){};this.onInject=function(){};this.onLoaded=function(){};this.onComplete=function(){}};EVUI.Modules.HtmlLoader.HtmlPlaceholder=function(n){if(n==null)throw new Error("Object expected.");var t=n,r=null,i=null;this.placeholderID=null;Object.defineProperty(this,"placeholderID",{get:function(){return t.placeholderID},configurable:!1,enumerable:!0});this.placeholderElement=null;Object.defineProperty(this,"placeholderElement",{get:function(){return t.placeholderElement},configurable:!1,enumerable:!0});this.html=null;Object.defineProperty(this,"html",{get:function(){return t.html},configurable:!1,enumerable:!0});this.url=null;Object.defineProperty(this,"url",{get:function(){return t.url},configurable:!1,enumerable:!0});this.parentPlaceholder=null;Object.defineProperty(this,"parentPlaceholder",{get:function(){return t.parentSession!=null?t.parentSession.placeholder:null},configurable:!1,enumerable:!0});this.loadedContent=null;Object.defineProperty(this,"loadedContent",{get:function(){return r!=null?r:(t.loadedContent!=null&&t.loadedContent.length>0&&(r=Object.freeze(t.loadedContent.slice())),r)},configurable:!1,enumerable:!0});this.loadArgs=null;Object.defineProperty(this,"loadArgs",{get:function(){return t.placeholderArgs},configurable:!1,enumerable:!0});this.children=null;Object.defineProperty(this,"children",{get:function(){return i!=null?i:(t.childSessions!=null&&t.childSessions.length&&(i=t.childSessions.slice(),i.sort(function(n,t){return n.id-t.id}),i=i.map(function(n){return n.placeholder})),i)},configurable:!1,enumerable:!0});this.loadState=null;Object.defineProperty(this,"loadState",{get:function(){return t.loadState},configurable:!1,enumerable:!0})};EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState={OnDemand:"ondemand",Loaded:"loaded",Failed:"failed",CircularReference:"circular",Pending:"pending",Loading:"loading"};Object.freeze(EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState);EVUI.Modules.HtmlLoader.HtmlLoaderControllerServices=function(){this.httpManager=null;this.domTree=null};EVUI.Modules.HtmlLoader.Manager=null,function(){var n=null;Object.defineProperty(EVUI.Modules.HtmlLoader,"Manager",{get:function(){return n==null&&(n=new EVUI.Modules.HtmlLoader.HtmlLoaderController),n},configurable:!1,enumerable:!0})}();EVUI.Constructors.HtmlLoader=EVUI.Modules.HtmlLoader.HtmlLoaderController;delete $evui.htmlLoader;$evui.htmlLoader=null;Object.defineProperty($evui,"htmlLoader",{get:function(){return EVUI.Modules.HtmlLoader.Manager},enumerable:!0});$evui.loadHtml=function(n,t){return $evui.htmlLoader.loadHtml(n,t)};$evui.loadHtmlAsync=function(n){return $evui.htmlLoader.loadHtmlAsync(n)};$evui.loadHtmlPartials=function(n,t){return $evui.htmlLoader.loadAllPlacehoders(n,t)};$evui.loadHtmlPartialsAsync=function(n){return $evui.htmlLoader.loadHtmlPartialsAsync(n)};$evui.loadPlaceholder=function(n,t){return $evui.htmlLoader.loadPlaceholder(n,t)};$evui.loadPlaceholderAsync=function(n){return $evui.htmlLoader.loadPlaceholderAsync(n)};$evui.loadAllPlaceholders=function(n,t){return $evui.htmlLoader.loadAllPlaceholders(n,t)};$evui.loadAllPlaceholdersAsync=function(n){return $evui.htmlLoader.loadAllPlaceholdersAsync(n)};Object.freeze(EVUI.Modules.HtmlLoader);EVUI.Modules.Http={};EVUI.Modules.Http.Dependencies={Core:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Http.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Http.Dependencies);EVUI.Modules.Http.Constants={};EVUI.Modules.Http.Constants.Fn_HttpCallback=function(){};EVUI.Modules.Http.Constants.Event_OnBeforeSend="beforesend";EVUI.Modules.Http.Constants.Event_OnSuccess="success";EVUI.Modules.Http.Constants.Event_OnError="error";EVUI.Modules.Http.Constants.Event_OnComplete="complete";EVUI.Modules.Http.Constants.Event_OnAllComplete="allcomplete";EVUI.Modules.Http.Constants.Job_OpenRequest="job.open";EVUI.Modules.Http.Constants.Job_SendRequest="job.send";EVUI.Modules.Http.Constants.Job_RequestComplete="job.requestcomplete";EVUI.Modules.Http.Constants.StepPrefix="evui.http";EVUI.Modules.Http.Constants.Fn_Event_Handler=function(){};Object.freeze(EVUI.Modules.Http.Constants);EVUI.Modules.Http.HttpManager=function(){var f,o,t;if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Http.Dependencies);var n=this,i=[],r=[],u=new EVUI.Modules.EventStream.BubblingEventManager;this.send=function(n,t){typeof t!="function"&&(t=function(){});var i=f(n),r=null;i.eventStream.getPromiseResolutionValue=function(){return r=e(i)};i.eventStream.executeAsync().then(function(n){return t(n)}).catch(function(){return t(r)})};this.sendAsync=function(n){var t=f(n);return t.eventStream.getPromiseResolutionValue=function(){return e(t)},t.eventStream.executeAsync()};f=function(n){if(n==null)throw new Error("requestArgs cannot be null.");n=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestArgs,n);n.headers!=null&&(n.headers=n.headers.map(function(n){return EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestHeader,n)}));var t=s(n);return i.push(t),h(t),t};this.getAllActiveRequests=function(){for(var t=[],r=i.length,n=0;n<r;n++)t.push(new EVUI.Modules.Http.HttpRequestInstance(i[n]));return t};this.addEventListener=function(n,t,i){return EVUI.Modules.Core.Utils.isObject(i)===!1&&(i=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),i.eventType=EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent,u.addEventListener(n,t,i)};this.removeEventListener=function(n,t){return u.removeEventListener(n,t)};var s=function(n){var i=new o;return i.eventStream=new EVUI.Modules.EventStream.EventStream,i.eventStream.context=n,i.httpRequestArgs=n,i.requestID=EVUI.Modules.Core.Utils.makeGuid(),i.xmlHttpRequest=new XMLHttpRequest,i.requestStatus=t.NotStarted,i.eventStream.canSeek=!0,i.eventStream.endExecutionOnEventHandlerCrash=!1,i.eventStream.eventState=n.context==null?{}:n.context,i.eventStream.bubblingEvents=u,i.eventStream.onError=function(n,r){i.error=r;i.requestStatus=t.Exception;i.xmlHttpRequest.readyState!==XMLHttpRequest.DONE&&i.xmlHttpRequest.abort();i.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnComplete)},i.eventStream.processInjectedEventArgs=function(n){var f=i.httpRequestArgs,u,e,r;return f.context=i.eventStream.eventState,u=null,n.key===EVUI.Modules.Http.Constants.Event_OnComplete&&(u=i.xmlHttpRequest),n.key===EVUI.Modules.Http.Constants.Event_OnError&&(u=i.xmlHttpRequest),n.key===EVUI.Modules.Http.Constants.Event_OnSuccess&&(u=i.xmlHttpRequest),e=i.requestStatus===t.Exception||i.requestStatus===t.Failed||i.requestStatus===t.TimedOut?i.error:null,r=new EVUI.Modules.Http.HttpEventArgs(f,u,e,i.response),r.eventType=n.key,r.eventName=n.name,r.stopPropagation=function(){n.stopPropagation()},r.requestStatus=i.requestStatus,r.cancel=function(){i.xmlHttpRequest.status!==XMLHttpRequest.DONE&&(i.xmlHttpRequest.abort(),i.requestStatus=t.Canceled);n.key!==EVUI.Modules.Http.Constants.Event_OnComplete&&n.key!==EVUI.Modules.Http.Constants.Event_OnAllComplete&&i.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnComplete)},r.pause=function(){n.pause()},r.resume=function(){n.resume()},r},i.eventStream.processReturnedEventArgs=function(n){i.eventStream.eventState=n.context},i},h=function(i){var r=i.eventStream;r.addStep({key:EVUI.Modules.Http.Constants.Event_OnBeforeSend,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnBeforeSend,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(typeof i.httpRequestArgs.onBeforeSend=="function")return i.httpRequestArgs.onBeforeSend(n)}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnBeforeSend,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnBeforeSend,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(t){if(typeof n.onBeforeSend=="function")return n.onBeforeSend.call(n,t)}});r.addStep({key:EVUI.Modules.Http.Constants.Job_OpenRequest,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Job_OpenRequest,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){var u,r,h,o,e,s,f;i.requestStatus=t.Opened;u=i.xmlHttpRequest;r=i.httpRequestArgs;try{if(u.open(r.method,r.url,!0),r.withCredentials===!0&&(u.withCredentials=!0),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.contentType)===!1&&u.setRequestHeader("Content-Type",r.contentType),typeof r.timeout=="number"&&r.timeout>0&&(u.timeout=r.timeout),EVUI.Modules.Core.Utils.isArray(r.headers)===!0)for(h=r.headers.length,o=0;o<h;o++)(e=r.headers[o],e!=null&&typeof e=="object")&&(s=e.key,f=e.value,typeof s=="string"||typeof s=="number")&&(f==null||typeof f=="string"||typeof f=="number"||typeof f=="boolean")&&u.setRequestHeader(s.toString(),f.toString());if(typeof r.responseType=="string")switch(r.responseType.toLowerCase()){case EVUI.Modules.Http.HttpResponseType.ArrayBuffer:u.responseType="arraybuffer";break;case EVUI.Modules.Http.HttpResponseType.Blob:u.responseType="blob";break;case EVUI.Modules.Http.HttpResponseType.HTML:case EVUI.Modules.Http.HttpResponseType.XML:case EVUI.Modules.Http.HttpResponseType.Document:u.responseType="document";break;case EVUI.Modules.Http.HttpResponseType.JSON:u.responseType="json";break;case EVUI.Modules.Http.HttpResponseType.Text:u.responseType="text";break;default:u.responseType=r.responseType}}catch(c){return i.error=new EVUI.Modules.EventStream.EventStreamError("Failed to construct XMLHttpRequest.",c,EVUI.Modules.EventStream.EventStreamStage.Job,EVUI.Modules.Http.Constants.Job_OpenRequest),i.requestStatus=t.Exception,n.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnError),n.resolve()}n.resolve()}});r.addStep({key:EVUI.Modules.Http.Constants.Job_SendRequest,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Job_SendRequest,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){try{var r=!1,u=!1,f=!1;i.xmlHttpRequest.addEventListener("load",function(){var u=i.xmlHttpRequest.status;r=!0;u>=200&&u<300||u===304?(i.response=i.xmlHttpRequest.response,n.resolve()):(i.response=i.xmlHttpRequest.response,i.error=new EVUI.Modules.EventStream.EventStreamError("HTTP Error: Server Returned "+i.xmlHttpRequest.status,null,EVUI.Modules.EventStream.EventStreamStage.Job,EVUI.Modules.Http.Constants.Job_SendRequest),i.requestStatus=t.Failed,n.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnError),n.resolve())},{once:!0});i.xmlHttpRequest.addEventListener("loadend",function(){r===!1&&u===!1&&f===!1&&(i.response=i.xmlHttpRequest.response,i.error=new EVUI.Modules.EventStream.EventStreamError("HTTP Error: An unknown error occurred.",null,EVUI.Modules.EventStream.EventStreamStage.Job,EVUI.Modules.Http.Constants.Job_SendRequest),i.requestStatus=t.Aborted,n.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnComplete),n.resolve())},{once:!0});i.xmlHttpRequest.addEventListener("timeout",function(){f=!0;i.response=i.xmlHttpRequest.response;i.error=new EVUI.Modules.EventStream.EventStreamError("HTTP Error: Request timed out after  "+i.xmlHttpRequest.timeout+" milliseconds.",null,EVUI.Modules.EventStream.EventStreamStage.Job,EVUI.Modules.Http.Constants.Job_SendRequest);i.requestStatus=t.TimedOut;n.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnError);n.resolve()},{once:!0});i.xmlHttpRequest.addEventListener("error",function(){u=!0;i.response=i.xmlHttpRequest.response;i.error=new EVUI.Modules.EventStream.EventStreamError("HTTP Error: An unknown error occurred.",null,EVUI.Modules.EventStream.EventStreamStage.Job,EVUI.Modules.Http.Constants.Job_SendRequest);i.requestStatus=t.Failed;n.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnError);n.resolve()},{once:!0});i.httpRequestArgs.body==null?i.xmlHttpRequest.send():i.xmlHttpRequest.send(i.httpRequestArgs.body)}catch(e){return i.error=new EVUI.Modules.EventStream.EventStreamError("Failed to send XMLHttpRequest.",e,EVUI.Modules.EventStream.EventStreamStage.Job,EVUI.Modules.Http.Constants.Job_SendRequest),i.requestStatus=t.Exception,n.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnError),n.resolve()}}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnSuccess,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnSuccess,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(typeof i.httpRequestArgs.onSuccess=="function")return i.httpRequestArgs.onSuccess(n)}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnSuccess,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnSuccess,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(t){if(n.onSuccess==="function")return n.onSuccess.call(n,t)}});r.addStep({key:EVUI.Modules.Http.Constants.Job_RequestComplete,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Job_RequestComplete,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){i.eventStream.seek(EVUI.Modules.Http.Constants.Event_OnComplete);n.resolve()}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnError,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnError,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(typeof i.httpRequestArgs.onError=="function")return i.httpRequestArgs.onError(n)}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnError,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnError,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(t){if(typeof n.onError=="function")return n.onError.call(n,t)}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnComplete,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnComplete,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(typeof i.httpRequestArgs.onComplete=="function")return i.httpRequestArgs.onComplete(n)}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnComplete,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnComplete,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(t){if(typeof n.onComplete=="function")return n.onComplete.call(n,t)}});r.addStep({key:EVUI.Modules.Http.Constants.Event_OnAllComplete,name:EVUI.Modules.Http.Constants.StepPrefix+"."+EVUI.Modules.Http.Constants.Event_OnAllComplete,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(){return c(i)}})},e=function(n){var t=new EVUI.Modules.Http.CompletedHttpRequest(n.xmlHttpRequest);return t.error=n.error,t.httpRequestArgs=n.httpRequestArgs,t.requestID=n.requestID,t.xmlHttpRequest=n.xmlHttpRequest,t.response=n.response,t.statusCode=n.xmlHttpRequest.status,t.requestStatus=n.requestStatus,t},c=function(t){var s=i.indexOf(t),f,o,u,h;if(s>-1&&i.splice(s,1),f=r.push(t),i.length===0){for(o=[],u=0;u<f;u++)h=r[u],o.push(e(h)),r.splice(u,1),f--,u--;if(typeof n.onAllComplete=="function")return n.onAllComplete.call(n,o)}};this.onBeforeSend=function(){};this.onSuccess=function(){};this.onError=function(){};this.onComplete=function(){};this.onAllComplete=function(){};o=function(){this.requestID=null;this.eventStream=null;this.httpRequestArgs=null;this.xmlHttpRequest=null;this.requestStatus=t.NotStarted;this.error=null;this.response=null};t=EVUI.Modules.Http.HttpRequestStatus};EVUI.Modules.Http.HttpRequestArgs=function(){this.url=null;this.method=null;this.headers=null;this.body=null;this.contentType=null;this.withCredentials=!1;this.responseType=null;this.timeout=null;this.context=null;this.onBeforeSend=function(){};this.onSuccess=function(){};this.onError=function(){};this.onComplete=function(){}};EVUI.Modules.Http.HttpRequestHeader=function(n,t){this.key=n;this.value=t};EVUI.Modules.Http.HttpEventArgs=function(n,t,i,r){if(n instanceof EVUI.Modules.Http.HttpRequestArgs==!1)throw new Error("Request must be an instance of HttpRequestArgs");var f=n,u=t,e=i,o=r;this.request=null;Object.defineProperty(this,"request",{get:function(){return f},configurable:!1,enumerable:!0});this.xmlHttpRequest=null;Object.defineProperty(this,"xmlHttpRequest",{get:function(){return u},configurable:!1,enumerable:!0});this.error=null;Object.defineProperty(this,"error",{get:function(){return e},configurable:!1,enumerable:!0});this.response=null;Object.defineProperty(this,"response",{get:function(){return o},configurable:!1,enumerable:!0});this.statusCode=0;Object.defineProperty(this,"statusCode",{get:function(){return u==null?0:u.status},configurable:!1,enumerable:!0});this.success=!1;Object.defineProperty(this,"success",{get:function(){return u==null?!1:u.status>=200&&u.status<300||u.status===304},configurable:!1,enumerable:!0});this.requestStatus=EVUI.Modules.Http.HttpRequestStatus.NotStarted;this.eventName=null;this.eventType=null;this.pause=function(){};this.resume=function(){};this.cancel=function(){};this.stopPropagation=function(){};this.context={}};EVUI.Modules.Http.CompletedHttpRequest=function(n){var i=this,r=n,t=null;this.requestID=null;this.success=!1;Object.defineProperty(this,"success",{get:function(){return i.statusCode>=200&&i.statusCode<300||i.statusCode===304},configurable:!1,enumerable:!0});this.response=null;this.httpRequestArgs=null;this.xmlHttpRequest=null;Object.defineProperty(this,"xmlHttpRequest",{get:function(){return r},configurable:!1,enumerable:!0});this.error=null;this.requestStatus=EVUI.Modules.Http.HttpRequestStatus.NotStarted;this.statusCode=0;this.responseHeaders=null;Object.defineProperty(this,"responseHeaders",{get:function(){var f,e,o,u,n,i;if(t!=null)return t;if(t==null){if(r.readyState!==XMLHttpRequest.DONE)return null;if(t=[],f=r.getAllResponseHeaders(),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f)===!0)return t;for(e=f.split(/\r\n/g),o=e.length,u=0;u<o;u++)if(n=e[u],i=n.indexOf(":"),i!==-1){var s=n.substring(0,i).trim(),h=i+1>=n.length?"":n.substring(i+1).trim(),c=new EVUI.Modules.Http.HttpRequestHeader(s,h);t.push(c)}return t}},configurable:!1,enumerable:!0})};EVUI.Modules.Http.HttpRequestInstance=function(n){var t=n,i=EVUI.Utils.ShallowExtend(new EVUI.Modules.Http.HttpRequestArgs,n.HttpRequestArgs);this.requestID=null;Object.defineProperty(this,"requestID",{get:function(){return t.requestID},enumerable:!0});this.eventStreamStatus=EVUI.Resources.EventStreamStatus.NotStarted;Object.defineProperty(this,"eventStreamStatus",{get:function(){return t.eventStream.getStatus()},enumerable:!0});this.request=null;Object.defineProperty(this,"request",{get:function(){return i},enumerable:!0});this.xmlHttpRequest=null;Object.defineProperty(this,"xmlHttpRequest",{get:function(){return t.xmlHttpRequest},enumerable:!0});this.requestStatus=EVUI.Modules.Http.HttpRequestStatus.NotStarted;Object.defineProperty(this,"requestStatus",{get:function(){return t.requestStatus},enumerable:!0});this.error=null;Object.defineProperty(this,"error",{get:function(){return t.error},enumerable:!0});this.response=null;Object.defineProperty(this,"response",{get:function(){return t.response},enumerable:!0});this.forceResume=function(){return t.EventStream.getStatus()===EVUI.Resources.EventStreamStatus.Paused?t.eventStream.resume():!1}};EVUI.Modules.Http.HttpRequestStatus={NotStarted:0,Opened:1,Sent:2,Complete:3,Canceled:4,Failed:5,Exception:6,TimedOut:7,Aborted:8};Object.freeze(EVUI.Modules.Http.HttpRequestStatus);EVUI.Modules.Http.HttpResponseType={Unknown:"unknown",Blob:"blob",ArrayBuffer:"arraybuffer",XML:"xml",HTML:"html",Text:"text",JSON:"json",Document:"document"};Object.freeze(EVUI.Modules.Http.HttpResponseType);EVUI.Modules.Http.Http=null,function(){var t=EVUI.Modules.Http.HttpManager,n=null;Object.defineProperty(EVUI.Modules.Http,"Http",{get:function(){return n==null&&(n=new t),n},enumerable:!0,configurable:!1})}();EVUI.Constructors.Http=EVUI.Modules.Http.HttpManager;delete $evui.httpEventStream;$evui.httpManager=null;Object.defineProperty($evui,"httpManager",{get:function(){return EVUI.Modules.Http.Http},enumerable:!0});$evui.http=function(n,t){$evui.httpManager.send(n,t)};$evui.httpAsync=function(n){return $evui.httpManager.sendAsync(n)};Object.freeze(EVUI.Modules.Http);EVUI.Modules.IFrames={};EVUI.Modules.IFrames.Dependencies={Core:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0}),Dom:Object.freeze({version:"1.0",required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.IFrames.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.IFrames.Dependencies);EVUI.Modules.IFrames.Constants={};EVUI.Modules.IFrames.Constants.Fn_IFrameSelector=function(){};EVUI.Modules.IFrames.Constants.Fn_AskCallback=function(){};EVUI.Modules.IFrames.Constants.Fn_IFrameEventHandler=function(){};EVUI.Modules.IFrames.Constants.PlaceholderIFrameContextID="evui.iframe.placeholder";EVUI.Modules.IFrames.Constants.Event_OnMessage="message";EVUI.Modules.IFrames.Constants.Event_OnHandle="handle";EVUI.Modules.IFrames.Constants.Event_OnAsk="ask";EVUI.Modules.IFrames.Constants.Event_OnSend="send";EVUI.Modules.IFrames.Constants.Job_Send="job.send";EVUI.Modules.IFrames.Constants.Job_Ask="job.ask";EVUI.Modules.IFrames.Constants.StepPrefix="evui.iframes";Object.freeze(EVUI.Modules.IFrames.Constants);EVUI.Modules.IFrames.IFrameManager=function(){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.IFrames.Dependencies);var i=this,y="evui.iframe.message",n=null,p=!1,t=[],u=5e3,f=new EVUI.Modules.EventStream.BubblingEventManager,e=function(){this.iFrame=null;this.handle=null;this.messageSessions=[]},nt=function(){var n=this,t=null,i=null;this.windowType=EVUI.Modules.IFrames.WindowType.None;this.contextID=null;this.element=null;this.messageHandlers=[];this.bubblingEvents=new EVUI.Modules.EventStream.BubblingEventManager;this.origin=null;Object.defineProperty(this,"origin",{get:function(){return n.windowType===EVUI.Modules.IFrames.WindowType.Child&&(i==null||n.element!=null&&n.element.src!==t)&&(i=a(n.element.src),t=n.element.src),i},set:function(n){i=n}});this.url=null;Object.defineProperty(this,"url",{get:function(){return n.windowType===EVUI.Modules.IFrames.WindowType.Child&&n.element!=null&&n.element.src!==t&&(i=a(n.element.src),t=n.element.src),t},set:function(n){t=n}});this.onSend=function(){};this.onMessage=function(){};this.send=function(n,t,i,r){tt(this,n,t,i,r)};this.addMessageHandler=function(n,t){if(this.contextID===EVUI.Modules.IFrames.Constants.PlaceholderIFrameContextID)throw Error("Cannot add or remove message handlers to a placeholder IFrame entry.");it(this,n,t)};this.removeMessageHandler=function(n){if(this.contextID===EVUI.Modules.IFrames.Constants.PlaceholderIFrameContextID)throw Error("Cannot add or remove message handlers to a placeholder IFrame entry.");return rt(this,n)};this.ask=function(n,t,i,r){if(this.contextID===EVUI.Modules.IFrames.Constants.PlaceholderIFrameContextID)throw Error("Cannot ask from a placeholder IFrame entry.");w(this,n,t,i,r)};this.askAsync=function(n,t,i){if(this.contextID===EVUI.Modules.IFrames.Constants.PlaceholderIFrameContextID)throw Error("Cannot ask from a placeholder IFrame entry.");return ut(this,n,t,i)};this.remove=function(){return ft(this)}},o=function(){this.sessionID=null;this.messageWapper=null;this.entry=null;this.eventStream=null;this.askArgs=null;this.askCallback=null;this.askCallbackFired=!1},s=function(){this.metadata=null;this.data=null},h=function(){this.signature=y;this.sessionID=null;this.askSessionID=null;this.messageCode=null;this.senderName=null};this.parentWindow=null;Object.defineProperty(this,"parentWindow",{get:function(){return n==null?null:n.iFrame},enumerable:!0,configurable:!1});this.defaultAskTimeout=5e3;Object.defineProperty(this,"defaultAskTimeout",{get:function(){return u},set:function(n){if(typeof n!="number"||n<0)throw Error("defaultAskTimeout must be a positive number.");u=n},configurable:!1,enumerable:!0});this.getChild=function(n){var r,f,i,u;if(typeof n=="string")return(r=et(n),r==null)?null:r;if(typeof n=="function"){for(f=t.length,i=0;i<f;i++)if(u=t[i],n(u.iFrame)===!0)return u.iFrame;return null}throw Error("Invalid input, string or function expected.");};this.getChildren=function(n){var r,f,i,u;if(typeof n=="function"){for(r=[],f=t.length,i=0;i<f;i++)u=t[i],n(u.iFrame)===!0&&r.push(u.iFrame);return r}return t.map(function(n){return n.iFrame})};this.onMessage=function(){};this.onSend=function(){};this.addIFrame=function(u){var f=new EVUI.Modules.IFrames.IFrameAddRequest,v,y,h,k,o,p,s;if(r(u)===!0?(f.element=u,f.iframeType=EVUI.Modules.IFrames.WindowType.Child,f.url=u.src):f=EVUI.Modules.Core.Utils.shallowExtend(f,u),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f.url)===!1&&n!=null)return n.handle.url==null&&(n.handle.url=f.url,n.handle.origin=a(f.url)),l(f,n.iFrame),n.iFrame;if(typeof f.element=="string"){var d=new EVUI.Modules.Dom.DomHelper(f.element),w=d.elements.filter(function(n){return r(n)}),b=w.length;if(b===0)throw Error("Invalid arguments - no url or valid iframe element selector provided, no way to establish cross-window communication.");for(v=[],o=0;o<b;o++)y=i.addIFrame(w[o]),y!=null&&v.push(y);return v}if(r(f.element)===!1)throw Error("Invalid arguments - no parent window or iframe element provided, no way to establish cross-window communication.");for(h=null,k=t.length,o=0;o<k;o++)if(p=t[o],p.handle.element===f.element){h=p;break}return h!=null?(l(f,h.iFrame),h.iFrame):(s=new e,s.handle=c(f,EVUI.Modules.IFrames.WindowType.Child),s.iFrame=new EVUI.Modules.IFrames.IFrame(s.handle),l(f,s.iFrame),t.push(s),s.iFrame)};this.addEventListener=function(n,t,i){return EVUI.Modules.Core.Utils.isObject(i)===!1&&(i=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),i.eventType=EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent,f.addEventListener(n,t,i)};this.removeEventListener=function(n,t){return f.removeEventListener(n,t)};var c=function(n,t){var i=new nt;return i.contextID=EVUI.Modules.Core.Utils.makeGuid(),i.element=n.element,i.url=r(n.element)===!0?n.element.src:null,i.windowType=t,i},tt=function(n,t,i,r,u){var c=g(n),e,f;c==null&&d(n.element);e=new EVUI.Modules.IFrames.SendMessageArgs;typeof i=="object"?e=EVUI.Modules.Core.Utils.shallowExtend(e,i):typeof i=="string"&&(e.messageCode=i);e.senderName=r;f=new o;f.sessionID=EVUI.Modules.Core.Utils.makeGuid();f.entry=c;f.messageWapper=new s;f.messageWapper.data=t;f.messageWapper.metadata=new h;f.messageWapper.metadata.askSessionID=u;f.messageWapper.metadata.messageCode=e.messageCode;f.messageWapper.metadata.sessionID=f.sessionID;f.messageWapper.metadata.senderName=e.senderName;b(f)},it=function(n,t,i){var r;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)throw Error("MessageCode must be a non-whitespace string.");if(typeof i!="function"&&i!=null)throw Error("Handler must be a function.");if(r=v(n,t),r!=null)throw Error('IFrame already has a message handler for "'+t+'".');r=new EVUI.Modules.IFrames.IFrameMessageListener(t,i);n.messageHandlers.push(r)},rt=function(n,t){var r=v(n,t),i;if(r==null)return!1;i=n.messageHandlers.indexOf(r);i!==-1&&n.messageHandlers.splice(i,1);!0},w=function(n,t,i,r,f){var l,c,e;if(typeof f!="function"&&(typeof i=="function"&&(f=i),typeof r=="function"&&(f=r)),typeof f!="function")throw Error("Ask operation must have a callback.");if(l=g(n),l==null)throw Error("Cannot ask from unregistered iframe.");c=new EVUI.Modules.IFrames.AskArgs;typeof i=="object"?c=EVUI.Modules.Core.Utils.shallowExtend(c,i):typeof i=="string"&&(c.messageCode=i);c.senderName=r;(typeof c.responseTimeout!="number"||c.responseTimeout<0)&&(c.responseTimeout=u);e=new o;e.sessionID=EVUI.Modules.Core.Utils.makeGuid();e.entry=l;e.askArgs=c;e.askCallback=f;e.messageWapper=new s;e.messageWapper.data=t;e.messageWapper.metadata=new h;e.messageWapper.metadata.askSessionID=EVUI.Modules.Core.Utils.makeGuid();e.messageWapper.metadata.messageCode=c.messageCode;e.messageWapper.metadata.sessionID=e.sessionID;e.messageWapper.metadata.senderName=c.senderName;b(e)},ut=function(n,t,i,r){return new Promise(function(u){w(n,t,i,r,function(n){u(n)})})},ft=function(n){for(var r,u=t.length,i=0;i<u;i++)if(r=t[i],r.handle===n)return t.splice(i,1),!0;return!1},l=function(n,t){typeof n.onMessage=="function"&&(t.onMessage=n.onMessage);typeof n.onSend=="function"&&(t.onSend=n.onSend)},et=function(n){for(var r,u=t.length,i=0;i<u;i++)if(r=t[i],r.contextID===n)return r;return null},a=function(n){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return null;try{var t=document.createElement("a");return t.href=n,t.origin}catch(i){return null}},ot=function(t){if(p!==!0){if(p=!0,parent!==window){var i=new EVUI.Modules.IFrames.IFrameAddRequest;i.element=parent;i.iframeType=EVUI.Modules.IFrames.WindowType.Parent;n=new e;n.handle=c(i,EVUI.Modules.IFrames.WindowType.Parent);n.iFrame=new EVUI.Modules.IFrames.IFrame(n.handle)}addEventListener("message",function(n){var u,i,r;if(n.origin!=null&&t.versionState!=="overwritten"&&(u=n.origin,ct(u)!==!1)&&n.data!=null&&n.data.metadata!=null&&n.data.metadata.signature===y){if(i=lt(n.source),i==null){if(r=at(n.source),r==null)return;i==null&&(i=d(r))}st(n,i)}})}},st=function(n,t){var u=new s,r,f,e;u.metadata=new h;u.metadata.sessionID=n.data.metadata.sessionID;u.metadata.messageCode=n.data.metadata.messageCode;u.metadata.askSessionID=n.data.metadata.askSessionID;u.data=n.data.data;r=new o;r.entry=t;r.sessionID=EVUI.Modules.Core.Utils.makeGuid();r.messageWapper=u;k(r,!0);f=r.eventStream;e=vt(r.entry,r.messageWapper.metadata.askSessionID);e!=null&&e.askArgs!=null&&typeof e.askCallback=="function"&&r.askCallbackFired===!1?(e.askCallbackFired=!0,f.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,key:EVUI.Modules.IFrames.Constants.Event_OnAsk,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Event_OnAsk,handler:function(n){return e.askCallback(n.message.data)}})):(f.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,key:EVUI.Modules.IFrames.Constants.Event_OnMessage,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Event_OnMessage,handler:function(n){if(typeof t.handle.onMessage=="function")return t.handle.onMessage.call(this,n)}}),f.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,key:EVUI.Modules.IFrames.Constants.Event_OnMessage,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Event_OnMessage,handler:function(n){if(typeof i.onMessage=="function")return i.onMessage.call(i,n)}}),f.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,key:EVUI.Modules.IFrames.Constants.Event_OnHandle,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Event_OnHandle,handler:function(n){var t=v(r.entry.handle,r.messageWapper.metadata.messageCode);if(t!=null&&typeof t.handler=="function")return t.handler(n)}}));f.execute()},b=function(t){k(t);var r=t.eventStream;r.addStep({key:EVUI.Modules.IFrames.Constants.Event_OnSend,type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Event_OnSend,handler:function(n){if(typeof t.entry.handle.onSend=="function")return t.entry.handle.onSend(n)}});r.addStep({key:EVUI.Modules.IFrames.Constants.Event_OnSend,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Event_OnSend,handler:function(n){if(typeof i.onSend=="function")return i.onSend.call(i,n)}});r.addStep({key:EVUI.Modules.IFrames.Constants.Job_Send,type:EVUI.Modules.EventStream.EventStreamStepType.Job,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Job_Send,handler:function(i){var r=null;if(t.entry===n){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.handle.origin)===!0)return i.reject("Parent window origin unset.");r=parent}else t.entry.handle.element.contentWindow!=null&&(r=t.entry.handle.element.contentWindow);if(r!=null)r.postMessage(t.messageWapper,t.entry.handle.origin);else return i.reject("Could not resolve message target.");i.resolve()}});t.askArgs!=null&&(t.entry.messageSessions.push(t),r.addStep({key:EVUI.Modules.IFrames.Constants.Job_Ask,type:EVUI.Modules.EventStream.EventStreamStepType.Job,name:EVUI.Modules.IFrames.Constants.StepPrefix+"."+EVUI.Modules.IFrames.Constants.Job_Ask,handler:function(n){var i=function(i){var r=t.entry.messageSessions.indexOf(t);return r!==-1&&t.entry.messageSessions.splice(r,1),i instanceof Error?n.reject("Ask callback crashed.",i):n.resolve(i)};setTimeout(function(){if(t.askCallbackFired===!1){t.askCallbackFired=!0;try{var n=t.askCallback(undefined);EVUI.Modules.Core.Utils.isPromise(n)===!0?n.then(function(n){i(n)}).catch(function(n){i(n)}):i(n)}catch(r){i(r)}}else i()},t.askArgs.responseTimeout)}}));r.execute()},yt=function(){},pt=function(){},k=function(n,t){var i=new EVUI.Modules.EventStream.EventStream;i.context=n.entry.iFrame;i.bubblingEvents=[n.entry.handle.bubblingEvents,f];i.processInjectedEventArgs=function(r){var f=ht(n.messageWapper,n.entry.handle.windowType),u=new EVUI.Modules.IFrames.IFrameEventArgs(n.entry.iFrame,f);return u.cancel=r.cancel,u.context=i.eventState,u.eventType=r.key,u.eventName=r.name,u.pause=r.pause,u.resume=r.resume,u.stopPropagation=r.stopPropagation,u.respond=function(t,i,r){EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.messageWapper.metadata.askSessionID)===!1?n.entry.handle.send(t,i,r,n.messageWapper.metadata.askSessionID):n.entry.handle.send(t,i,r)},t!==!0&&delete u.respond,u};i.processReturnedEventArgs=function(n){i.eventState=n.state};i.canSeek=!1;n.eventStream=i},ht=function(n,t){var i=new EVUI.Modules.IFrames.IFrameMessage;return i.messageSenderType=t,i.messageCode=n.metadata.messageCode,i.data=n.data,i},ct=function(i){var r,f,u;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i)===!0)return!1;if((r=i.toLowerCase(),r===location.origin.toLowerCase())||n!=null&&n.handle.origin===r)return!0;for(f=t.length,u=0;u<f;u++)if(t[u].handle.origin===r)return!0;return!1},lt=function(i){var f,r,u;if(n!=null&&parent!==window&&parent===i)return n;for(f=t.length,r=0;r<f;r++)if(u=t[r],u.handle.element.contentWindow===i)return u;return null},at=function(n){for(var i,r=new EVUI.Modules.Dom.DomHelper("iframe"),u=null,f=r.elements.length,t=0;t<f;t++)if(i=r.elements[t],i.contentWindow===n){u=i;break}return u},d=function(n){var r=new EVUI.Modules.IFrames.IFrameAddRequest,t,u,i;return r.element=n,t=c(r,EVUI.Modules.IFrames.WindowType.Child),t.contextID=EVUI.Modules.IFrames.Constants.PlaceholderIFrameContextID,u=new EVUI.Modules.IFrames.IFrame(t),i=new e,i.handle=t,i.iFrame=u,i},r=function(n){return EVUI.Modules.Core.Utils.isElement(n)===!0&&n.tagName.toLowerCase()==="iframe"},wt=function(n){return n instanceof Window&&n===parent&&parent!==window},vt=function(n,t){for(var r,u=n.messageSessions.length,i=0;i<u;i++)if(r=n.messageSessions[i],r.messageWapper.metadata.askSessionID===t)return r;return null},v=function(n,t){var u,i,r;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)return null;for(u=n.messageHandlers.length,i=0;i<u;i++)if(r=n.messageHandlers[i],r.messageCode===t)return r;return null},g=function(i){var f,r,u;if(i===n.handle)return n;for(f=t.length,r=0;r<f;r++)if(u=t[r],u.handle===i)return u;return null};ot(EVUI.Modules.IFrames)};EVUI.Modules.IFrames.IFrameMessage=function(){this.messageSenderType=EVUI.Modules.IFrames.WindowType.None;this.messageCode=null;this.data=null};EVUI.Modules.IFrames.WindowType={None:"none",Parent:"parent",Child:"child"};Object.freeze(EVUI.Modules.IFrames.WindowType);EVUI.Modules.IFrames.IFrame=function(n){if(n==null)throw Error("Invalid Arguments: Missing IFrameHandle.");if(n.element!==parent&&EVUI.Modules.Core.Utils.isElement(n.element)===!1&&n.element.tagName.toLowerCase()!=="iframe")throw Error("Invalid Arguments: Invalid IFrameHandle.");var t=n;this.windowType=EVUI.Modules.IFrames.WindowType.None;Object.defineProperty(this,"windowType",{get:function(){return t.windowType},configurable:!1,enumerable:!0});this.contextID=null;Object.defineProperty(this,"contextID",{get:function(){return t.contextID},configurable:!1,enumerable:!0});this.origin=null;Object.defineProperty(this,"origin",{get:function(){return t.origin},configurable:!1,enumerable:!0});this.element=null;Object.defineProperty(this,"element",{get:function(){return t.element},configurable:!1,enumerable:!0});this.url=null;Object.defineProperty(this,"url",{get:function(){return t.url},configurable:!1,enumerable:!0});this.onMessage=null;Object.defineProperty(this,"onMessage",{get:function(){return t.onMessage},set:function(n){t.onMessage=n},configurable:!1,enumerable:!0});this.onSend=null;Object.defineProperty(this,"onSend",{get:function(){return t.onSend},set:function(n){t.onSend=n},configurable:!1,enumerable:!0});this.send=function(n,i,r){t.send(n,i,r)};this.addMessageHandler=function(n,i){t.addMessageHandler(n,i)};this.removeMessageHandler=function(n){return t.removeMessageHandler(n)};this.getMessageHandler=function(n){for(var r,u=t.messageHandlers.length,i=0;i<u;i++)if(r=t.messageHandlers[i],r.messageCode===n)return r;return null};this.getMessageHandlers=function(){return t.messageHandlers.slice()};this.ask=function(n,i,r,u){t.ask(n,i,r,u)};this.askAsync=function(n,i,r){return t.askAsync(n,i,r)};this.remove=function(){return t.remove()};this.addEventListener=function(n,i,r){return EVUI.Modules.Core.Utils.isObject(r)===!1&&(r=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),r.eventType=EVUI.Modules.EventStream.EventStreamEventType.Event,t.bubblingEvents.addEventListener(n,i,r)};this.removeEventListener=function(n,i){return t.bubblingEvents.removeEventListener(n,i)}};EVUI.Modules.IFrames.IFrameEventArgs=function(n,t){var i=n,r=t;this.sendingIFrame=null;Object.defineProperty(this,"sendingIFrame",{get:function(){return i},enumerable:!0,configurable:!1});this.message=null;Object.defineProperty(this,"message",{get:function(){return r},enumerable:!0,configurable:!1});this.eventName=null;this.eventType=null;this.pause=function(){};this.resume=function(){};this.cancel=function(){};this.stopPropagation=function(){};this.context={}};EVUI.Modules.IFrames.IFrameAddRequest=function(){this.element=null;this.onMessage=null;this.onSend=null};EVUI.Modules.IFrames.ParentWindowAddRequest=function(){this.url=null;this.onMessage=null;this.onSend=null};EVUI.Modules.IFrames.SendMessageArgs=function(){this.messageCode=null;this.senderName=null};EVUI.Modules.IFrames.AskArgs=function(){this.messageCode=null;this.senderName=null;this.responseTimeout=-1};EVUI.Modules.IFrames.IFrameMessageListener=function(n,t){var r=n,i=t;this.messageCode=null;Object.defineProperty(this,"messageCode",{get:function(){return r},configurable:!1,enumerable:!0});this.handler=null;Object.defineProperty(this,"handler",{get:function(){return i},set:function(n){if(n==null||typeof t=="function")i=n;else throw Error("Function expected.");},enumerable:!0,configurable:!1})};EVUI.Modules.IFrames.Manager=null,function(){var n=null;Object.defineProperty(EVUI.Modules.IFrames,"Manager",{get:function(){return n==null&&(n=new EVUI.Modules.IFrames.IFrameManager),n},configurable:!1,enumerable:!0})}();EVUI.Constructors.IFrames=EVUI.Modules.IFrames.IFrameManager;delete $evui.iframes;$evui.iframes=null;Object.defineProperty($evui,"iframes",{get:function(){return EVUI.Modules.IFrames.Manager},enumerable:!0});$evui.addIFrame=function(n){return $evui.iframes.addIFrame(n)};Object.freeze(EVUI.Modules.IFrames);EVUI.Modules.Observers={};EVUI.Modules.Observers.Dependencies={Core:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Observers.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Observers.Dependencies);EVUI.Modules.Observers.ObjectObserver=function(n){var t;if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Observers.Dependencies);t=null;this.getChanges=function(n){var i=e(n),r=i.changedProperties.slice();return t.reset(),r};this.getChildObserver=function(n,r){var f;if(t==null||t.root==null)return new EVUI.Modules.Observers.ObjectObserver;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return r===!0?EVUI.Modules.Observers.ObjectObserver(i(t.root)):null;var e=EVUI.Modules.Core.Utils.getValuePathSegments(n),o=e.length,u=t.root.propDic[e[0]];if(u==null)return null;for(f=1;f<o;f++)if(u=u.propDic[e[f]],u==null)return null;return r===!0&&(u=i(u,null)),new EVUI.Modules.Observers.ObjectObserver(u)};this.getObservedProperties=function(){return i(t.root,null)};var f=function(i){var f=new EVUI.Modules.Observers.ObservedProperty;f.hostObject=null;f.name=null;f.originalValue=n;f.propDic={};f.propList=[];t=new u;t.root=f;t.diffing=!1;t.setState=!0;t.parentStack.push(i);r(i,f,t)},e=function(n){return(t.diffing=!0,t.setState=n,t.root==null)?session:(t.parentStack.push(t.root.originalValue),r(t.root.originalValue,t.root,t),t)},i=function(n,t){var r=new EVUI.Modules.Observers.ObservedProperty,u,f,e;if(t==null){if(n.originalValue==null||typeof n.originalValue!="object")throw Error("Cannot observe a null reference or non-object.");r.originalValue=n.originalValue}else r.originalValue=n.originalValue,r.hostObject=n.hostObject,r.name=n.name,r.path=t.path==null?n.name:t.path+"."+n.name;if(n.propDic==null)return r;for(r.propList=[],r.propDic={},r.numProps=n.numProps,u=0;u<n.numProps;u++)f=n.propList[u],r.propList.push(f),e=n.propDic[f],r.propDic[f]=i(e,r);return r},r=function(n,t,i){var c,l,p,a,w,u,b,f,h,e,y,k;if(n!=null&&!(n instanceof Node)&&n!==window){if(c=[],l={},EVUI.Modules.Core.Utils.isArray(n)===!0)for(p=n.length,f=0;f<p;f++)u=f.toString(),l[u]=!0,c.push(u);else for(a=EVUI.Modules.Core.Utils.getProperties(n),w=a.length,f=0;f<w;f++)u=a[f],l[u]=!0,c.push(u);if(t.propDic!=null)for(f=0;f<t.numProps;f++)(u=t.propList[f],l[u]!==!0)&&c.push(u);for(b=c.length,f=0;f<b;f++){var u=c[f],v=!1,s=n[u],o=t.propDic[u];if(o==null&&(h=new EVUI.Modules.Observers.ObservedProperty,h.hostObject=n,h.name=u,h.path=t.path!=null?t.path+"."+u:u,h.originalValue=s,t.propDic==null&&(t.propDic={},t.propList=[]),i.setState===!0&&(t.propDic[u]=h,t.numProps=t.propList.push(u)),i.diffing===!0&&(e=new EVUI.Modules.Observers.ObservedChangedProperty,e.hostObject=h.hostObject,e.name=h.name,e.newValue=s,e.originalValue=undefined,e.path=h.path,e.type=EVUI.Modules.Observers.ObservedObjectChangeType.Added,i.changedProperties.push(e)),o=h,v=!0),i.diffing===!0&&v===!1&&s!==o.originalValue&&(e=new EVUI.Modules.Observers.ObservedChangedProperty,e.hostObject=o.hostObject,e.name=o.name,e.newValue=s,e.originalValue=o.originalValue,e.path=o.path,e.type=s===undefined?EVUI.Modules.Observers.ObservedObjectChangeType.Removed:EVUI.Modules.Observers.ObservedObjectChangeType.Changed,i.changedProperties.push(e)),i.setState===!0&&v===!1){if(s===undefined){delete t.propDic[u];y=t.propList.indexOf(u);y!==-1&&(t.propList.splice(y,1),t.numProps--);continue}else s!==o.originalValue&&(o.originalValue=s);o.hostObject!==n&&(o.hostObject=n)}if(s!=null&&typeof s=="object"){if(k=i.parentStack.indexOf(s),k!==-1)continue;i.parentStack.push(s);o.propDic==null&&(o.propDic={},o.propList=[]);r(s,o,i);i.parentStack.pop()}}}},u=function(){this.root=null;this.changedProperties=[];this.diffing=!1;this.setState=!1;this.parentStack=[];this.reset=function(){this.changedProperties.splice(0,this.changedProperties.length);this.diffing=!1;this.setState=!1;this.parentStack.splice(0,this.parentStack.length)}};if(n==null||typeof n!="object")throw Error("Cannot observe a null reference or non-object.");EVUI.Modules.Core.Utils.instanceOf(n,EVUI.Modules.Observers.ObservedProperty)===!0?(t=new u,t.root=n):f(n)};EVUI.Modules.Observers.ObservedObjectChangeType={None:"none",Added:"added",Removed:"removed",Changed:"changed"};Object.freeze(EVUI.Modules.Observers.ObservedObjectChangeType);EVUI.Modules.Observers.ObservedChangedProperty=function(){this.hostObject=null;this.name=null;this.originalValue=null;this.newValue=null;this.path=null;this.type=EVUI.Modules.Observers.ObservedObjectChangeType.None};EVUI.Modules.Observers.ObservedProperty=function(){this.hostObject=null;this.name=null;this.originalValue=null;this.path=null;this.propDic=null;this.propList=null;this.numProps=0};EVUI.Modules.Observers.ObservedProperty.prototype.getChild=function(n){var i;if(typeof n!="string")return null;var r=EVUI.Modules.Core.Utils.getValuePathSegments(n),u=r.length,t=this.propDic[r[0]];if(t==null)return null;for(i=1;i<u;i++)if(t=t.propDic[r[i]],t==null)return null;return t};EVUI.Modules.Observers.ObservedProperty.prototype.hasChanged=function(){return this.hostObject==null?!0:this.originalValue!==this.hostObject[this.name]};EVUI.Modules.Observers.ObservedProperty.prototype.haveChildrenChanged=function(n){var t,u,i,f;if(this.hostObject==null)return!0;if(this.numProps===0)return!1;var e=this.originalValue,r=EVUI.Modules.Core.Utils.getProperties(e),o=r.length;for(t=0;t<o;t++){if(u=r[t],i=this.propDic[u],i==null)return!0;if(n===!0){if(f=i.haveChildrenChanged(!0),f===!0)return!0}else if(i.hasChanged()===!0)return!0}return!1};EVUI.Modules.Observers.ObservedProperty.prototype.getCurrentValue=function(){return this.hostObject==null?undefined:this.hostObject[this.name]};EVUI.Modules.Observers.ArrayObserver=function(n){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Observers.Dependencies);var t=EVUI.Modules.Core.Utils.getHashCode(EVUI.Modules.Core.Utils.makeGuid()).toString(36),r={},u=null,i=[];this.getChanges=function(n){var t=f(u),r=h(i,t);return n===!0&&(i=t),r};var f=function(n){for(var r,t,u=[],f=n.length,i=0;i<f;i++)r=n[i],t=new a,t.index=i,t.value=r,t.key=c(r),u.push(t);return u},h=function(n,i){for(var f,ht,c,h,p,d,v,w,ct,u,g,a,nt,lt,yt,et,b={},it={},ot={},rt=[],ut=[],k=[],y=[],ft=n.length,st=i.length,r=0;r<ft;r++){if(u=n[r],u.key==null)if(Object.isExtensible(u.value)===!0)u.value[t]===undefined?(p=Math.random().toString(36),u.value[t]=p,u.key=p,rt.push(u)):u.key=u.value[t];else{f=o(u,ut);f==null&&(f=new s,f.value=u.value,ut.push(f));f.indexes[r]=u;f.items.push(u);f.numItems++;k.push(f);continue}f=b[u.key];f==null&&(f=new s,f.value=u.value,f.key=u.key,b[u.key]=f);f.items.push(u);f.indexes[r]=u;f.numItems++;k.push(f)}for(ht=ft>st?ft:st,r=0;r<ht;r++){if(c=i[r],h=null,c!=null&&(h=e(c.key,b),h==null&&(p=c.value[t],p!=null&&(h=e(p,b)),h==null&&(d=typeof c.value,(d==="object"||d==="function"||d==="symbol")&&(h=o(c,ut)))),h==null)){v=new EVUI.Modules.Observers.ArrayIndexChange;v.changeType=EVUI.Modules.Observers.ArrayChangeType.Added;v.newIndex=r;v.oldIndex=-1;v.value=c.value;y.push(v);it[r]=v;continue}if(h!=null){if(h.found=!0,w=l(h,c),w==null)continue;w.changeType===EVUI.Modules.Observers.ArrayChangeType.Added&&(it[r]=w);y.push(w)}}for(ct=k.length,r=0;r<ct;r++)if(u=k[r],u.found===!1)for(g=0;g<u.numItems;g++)a=new EVUI.Modules.Observers.ArrayIndexChange,a.changeType=EVUI.Modules.Observers.ArrayChangeType.Removed,a.newIndex=-1,a.oldIndex=u.items[g].index,a.value=u.value,y.push(a),ot[a.oldIndex]=a;for(nt=0,lt=y.length,r=0;r<lt;r++){var tt=y[r],at=it[r]!=null,vt=ot[r]!=null;(at!==!0||vt!==!0)&&(at===!0&&nt++,vt===!0&&nt--,tt.changeType===EVUI.Modules.Observers.ArrayChangeType.Moved)&&tt.newIndex===tt.oldIndex+nt&&(tt.changeType=EVUI.Modules.Observers.ArrayChangeType.Shifted)}for(yt=rt.length,r=0;r<yt;r++)et=rt[r],et.key=null,delete et.value[t];return y},e=function(n,t){return t==null?undefined:t[n]},o=function(n,t){for(var r,u=t.length,i=0;i<u;i++)if(r=t[i],r.value===n.value)return r;return null},c=function(n){var u=typeof n,t,i;return n===null?"null":n===undefined?"undefined":u==="object"||u==="symbol"||u==="function"?null:(n=n.toString(),t=u+"-"+n,t.length>43&&(i=r[t],i==null&&(i=EVUI.Modules.Core.Utils.getHashCode(t).toString(36),r[i]=t),t=i),t)},l=function(n,t){var i=new EVUI.Modules.Observers.ArrayIndexChange,r;if(i.newIndex=t.index,i.value=t.value,n.indexes[t.index]!=null){for(delete n.indexes[t.index],r=0;r<n.numItems;r++)n.items[r].index===t.index&&(n.items.splice(r,1),n.numItems--);return null}return n.numItems===0?(i.oldIndex=-1,i.changeType=EVUI.Modules.Observers.ArrayChangeType.Added,i):(i.oldIndex=n.items[0].index,i.changeType=EVUI.Modules.Observers.ArrayChangeType.Moved,n.items.splice(1,0),n.numItems--,delete n.indexes[i.oldIndex],i)},a=function(){this.index=-1;this.value=null;this.key=null},s=function(){this.value=null;this.key=null;this.indexes={};this.items=[];this.numItems=0;this.found=!1};if(EVUI.Modules.Core.Utils.isArray(n)===!1)throw Error("Array expected.");u=n;i=f(n)};EVUI.Modules.Observers.ArrayChangeType={None:"none",Added:"add",Removed:"remove",Moved:"move",Shifted:"shift"};Object.freeze(EVUI.Modules.Observers.ArrayChangeType);EVUI.Modules.Observers.ArrayIndexChange=function(){this.oldIndex=-1;this.newIndex=-1;this.value=null;this.changeType=EVUI.Modules.Observers.ArrayChangeType.None};$evui.observe=function(n){return new EVUI.Modules.Observers.ObjectObserver(n)};$evui.observeArray=function(n){return new EVUI.Modules.Observers.ArrayObserver(n)};Object.freeze(EVUI.Modules.Observers);EVUI.Modules.Panes={};EVUI.Modules.Panes.Constants={};EVUI.Modules.Panes.Constants.Fn_PaneSelector=function(){return!0};EVUI.Modules.Panes.Constants.Fn_LoadCallback=function(){};EVUI.Modules.Panes.Constants.Fn_PaneOperationCallback=function(){};EVUI.Modules.Panes.Constants.Fn_PaneEventHandler=function(){};EVUI.Modules.Panes.Constants.CSS_Pane_Style="evui-pane-style";EVUI.Modules.Panes.Constants.CSS_Position="evui-pane-position";EVUI.Modules.Panes.Constants.CSS_ClippedX="evui-pane-clipped-x";EVUI.Modules.Panes.Constants.CSS_ClippedY="evui-pane-clipped-y";EVUI.Modules.Panes.Constants.CSS_ScrollX="evui-pane-scroll-x";EVUI.Modules.Panes.Constants.CSS_ScrollY="evui-pane-scroll-y";EVUI.Modules.Panes.Constants.CSS_Flipped="evui-pane-flipped";EVUI.Modules.Panes.Constants.CSS_Moved="evui-pane-moved";EVUI.Modules.Panes.Constants.CSS_Resized="evui-pane-resized";EVUI.Modules.Panes.Constants.CSS_Backdrop="evui-pane-backdrop";EVUI.Modules.Panes.Constants.CSS_Transition_Show="evui-pane-transition-show";EVUI.Modules.Panes.Constants.CSS_Transition_Hide="evui-pane-transition-hide";EVUI.Modules.Panes.Constants.CSS_Transition_Move="evui-pane-transition-move";EVUI.Modules.Panes.Constants.CSS_Transition_Resize="evui-pane-transition-resize";EVUI.Modules.Panes.Constants.Attribute_Template="evui-pane-template";EVUI.Modules.Panes.Constants.Attribute_ID="evui-pane-id";EVUI.Modules.Panes.Constants.Attribute_Focus="evui-pane-focus";EVUI.Modules.Panes.Constants.Attribute_Close="evui-pane-close";EVUI.Modules.Panes.Constants.Attribute_Drag="evui-pane-drag-handle";EVUI.Modules.Panes.Constants.Attribute_SourceURL="evui-pane-src";EVUI.Modules.Panes.Constants.Attribute_PlaceholderID="evui-pane-placeholder-id";EVUI.Modules.Panes.Constants.Attribute_UnloadOnHide="evui-pane-unload";EVUI.Modules.Panes.Constants.Attribute_Context="evui-pane-cxt";EVUI.Modules.Panes.Constants.Attribute_Selector="evui-pane-selector";EVUI.Modules.Panes.Constants.Attribute_ShowArgs="evui-pane-show";EVUI.Modules.Panes.Constants.Event_OnShow="show";EVUI.Modules.Panes.Constants.Event_OnHide="hide";EVUI.Modules.Panes.Constants.Event_OnUnload="unload";EVUI.Modules.Panes.Constants.Event_OnLoad="load";EVUI.Modules.Panes.Constants.Event_OnMove="move";EVUI.Modules.Panes.Constants.Event_OnResize="resize";EVUI.Modules.Panes.Constants.Event_OnShown="shown";EVUI.Modules.Panes.Constants.Event_OnHidden="hidden";EVUI.Modules.Panes.Constants.Event_OnLoaded="loaded";EVUI.Modules.Panes.Constants.Event_OnUnloaded="unloaded";EVUI.Modules.Panes.Constants.Event_OnMoved="moved";EVUI.Modules.Panes.Constants.Event_OnResized="resized";EVUI.Modules.Panes.Constants.Event_OnInitialize="init";EVUI.Modules.Panes.Constants.Event_OnPosition="position";EVUI.Modules.Panes.Constants.Job_Complete="job.complete";EVUI.Modules.Panes.Constants.Job_Preload="job.preload";EVUI.Modules.Panes.Constants.Job_Load="job.load";EVUI.Modules.Panes.Constants.Job_Initialize="job.init";EVUI.Modules.Panes.Constants.Job_Hide="job.hide";EVUI.Modules.Panes.Constants.Job_InitialPosition="job.initialposition";EVUI.Modules.Panes.Constants.Job_FinalPosition="job.finalposition";EVUI.Modules.Panes.Constants.Job_Unload="job.unload";EVUI.Modules.Panes.Constants.Job_Move="job.move";EVUI.Modules.Panes.Constants.Job_Resize="job.resize";EVUI.Modules.Panes.Constants.CssPrefix="evui-pane";EVUI.Modules.Panes.Constants.StepPrefix="evui.pane";EVUI.Modules.Panes.Constants.GlobalZIndex=null;EVUI.Modules.Panes[Symbol.for("evui-panes")]=null,function(){var n=null;Object.defineProperty(EVUI.Modules.Panes.Constants,"GlobalZIndex",{get:function(){return n},set:function(t){typeof t=="number"&&(n=t<0?0:t)},configurable:!1,enumerable:!0})}();Object.freeze(EVUI.Modules.Panes.Constants);EVUI.Modules.Panes.Dependencies={Core:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0}),Styles:Object.freeze({required:!0}),Dom:Object.freeze({required:!0}),Observers:Object.freeze({required:!0}),HtmlLoader:Object.freeze({required:!1}),Http:Object.freeze({required:!1})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Panes.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Panes.Dependencies);EVUI.Modules.Panes.PaneManager=function(n){var ot;if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Panes.Dependencies);EVUI.Modules.Panes.Constants.GlobalZIndex==null&&(ot=EVUI.Modules.Core.Settings.defaultMinimumZIndex,typeof ot!="number"&&(ot=100),EVUI.Modules.Panes.Constants.GlobalZIndex=ot);EVUI.Modules.Panes[Symbol.for("evui-panes")]==null&&(EVUI.Modules.Panes[Symbol.for("evui-panes")]=EVUI.Modules.Core.Utils.makeGuid());var t=this,lr=0,e=[],i=null,s=null,a=null,h=null,ui=["positionClass","abosolutePosition","relativePosition","anchors","documentFlow","fullscreen","centered","context","hideTransition","showTransition","clipSettings","backdropSettings"],fi=["element","selector","contextElement","httpArgs","placeholderArgs","context"],ar=["context"],bt=new EVUI.Modules.EventStream.BubblingEventManager,ei=function(){this.httpManager=null;this.htmlLoader=null;this.stylesheetManager=null;this.backdropManager=null},vr=function(){this.pane=null;this.paneCSSName=null;this.eventStream=null;this.bubblingEvents=new EVUI.Modules.EventStream.BubblingEventManager;this.paneStateFlags=EVUI.Modules.Panes.PaneStateFlags.None;this.paneAction=EVUI.Modules.Panes.PaneAction.None;this.paneActionSequence=[];this.eventBindings=[];this.manager=null;this.callbackStack=[];this.lastCalculatedPosition=null;this.lastResolvedShowArgs=null;this.lastResolvedLoadArgs=null;this.lastResizeArgs=null;this.transitionTimeoutID=-1;this.transitionSelector=null;this.transitionCallback=null;this.currentOperation=null;this.removed=!1;this.inlinedStyle=null},oi=function(){this.lowerPaneId=null;this.paneId=null;this.link=null};oi[Symbol.for("evui-panes")]=EVUI.Modules.Panes[Symbol.for("evui-panes")];var yr=function(){this.opSessions=[];this.action=EVUI.Modules.Panes.PaneAction.None},g=function(){this.sessionID=EVUI.Modules.Core.Utils.makeGuid();this.entry=null;this.action=null;this.currentAction=null;this.callback=null;this.showMode=EVUI.Modules.Panes.PaneShowMode.None;this.userShowArgs=null;this.userLoadArgs=null;this.userHideArgs=null;this.userUnloadArgs=null;this.userMoveArgs=null;this.userResizeArgs=null;this.resolvedShowArgs=null;this.resolvedLoadArgs=null;this.resolvedHideArgs=null;this.resolvedUnloadArgs=null;this.resolvedMoveArgs=null;this.resolvedResizeArgs=null;this.cancel=!1;this.continue=!1;this.wasCanceled=!1;this.continuedTo=null;this.callbackOrdinal=lr++;this.context=null;this.queuedOpSession=null;this.isQueued=!1},pr=function(){this.entry=null;this.userShowArgs=null;this.userLoadArgs=null;this.userHideArgs=null;this.userUnloadArgs=null;this.context=null},r={None:"none",Initialize:"init",Load:"load",Show:"show",Hide:"hide",Unload:"unload",Position:"position",CancelCurrent:"cancel",Continue:"continue",QueueCallback:"queuecallback",Move:"move",Resize:"resize",Queue:"queue"},wr=function(){var a=this,v=function(n,t){this.paneId=n;this.zIndex=t},y=EVUI.Modules.Core.Utils.makeGuid(),n=null,u=null,o=-1,s=null,r=null,t=EVUI.Modules.Styles.Constants.DefaultStyleSheetName,f=[];this.showBackdrop=function(n,t,i,u){if(typeof u!="function"&&(u=function(){}),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0||typeof t!="number")return u(!1);this.cancelTransition();var e=h(n);e==null?f.push(new v(n,t)):e.zIndex=t;r=n;w(i,t);l(i.backdropShowTransition,EVUI.Modules.Panes.Constants.CSS_Transition_Show,function(n){u(n)})};this.setBackdropZIndex=function(){var n=h(r),u=p(n);u!=null&&(i.stylesheetManager.removeRules(t,e(n.paneId)),i.stylesheetManager.setRules(t,e(r),{zIndex:u.zIndex}))};this.hideBackdrop=function(n,t,i){if(typeof i!="function"&&(i=function(){}),t==null)return i(!1);this.cancelTransition();r=n;l(t.backdropHideTransition,EVUI.Modules.Panes.Constants.CSS_Transition_Hide,function(t){var u=h(n),r=f.indexOf(u);r!==-1&&f.splice(r,1);b();i(t)})};this.cancelTransition=function(){if(o!==-1)try{typeof s=="function"&&s()}catch(n){EVUI.Modules.Core.Utils.log(n.stack)}finally{clearTimeout(o);s=null;o=-1}};var h=function(n){for(var i,r=f.length,t=0;t<r;t++)if(i=f[t],i.paneId===n)return i;return null},p=function(n){for(var t,r,u=null,e=Number.MAX_VALUE,o=f.length,i=0;i<o;i++)(t=f[i],t!==n)&&(r=n.zIndex-t.zIndex,r<e&&(u=t,e=r));return u},w=function(n,f){var h,o,s;if(n==null||n.showBackdrop===!1)return!1;(i.stylesheetManager.ensureSheet(t,{lock:!0}),c(),h={position:"fixed",top:"0px",left:"0px",height:"100vh",width:"100vw",backgroundColor:typeof n.backdropColor=="string"?n.backdropColor:"#000000",opacity:typeof n.backdropOpacity=="number"?n.backdropOpacity:.75,zIndex:f},i.stylesheetManager.setRules(t,e(r),h),u.addClass([EVUI.Modules.Panes.Constants.CSS_Backdrop,r]),n.backdropCSS!=null)&&(o=e(r),typeof n.backdropCSS=="string"?(s=n.backdropCSS.match(/[\;\:]/g),s!=null&&s.length>0?i.stylesheetManager.setRules(t,o,n.backdropCSS):u.addClass(n.backdropCSS)):i.stylesheetManager.setRules(t,o,n.backdropCSS))},b=function(){var u,f,o;for(i.stylesheetManager.ensureSheet(t,{lock:!0}),c(),u={position:"absolute",top:"0px",left:"0px",height:"0px",width:"0px"};n.classList.length>0;)f=n.classList[0],n.classList.remove(f);n.classList.add(EVUI.Modules.Panes.Constants.CSS_Backdrop);o=e(r);i.stylesheetManager.removeRules(t,[o,EVUI.Modules.Panes.Constants.CSS_Backdrop]);i.stylesheetManager.setRules(t,EVUI.Modules.Panes.Constants.CSS_Backdrop,u)},l=function(n,f,h){var l,v;if(typeof h!="function"&&(h=function(){}),n==null)return h(!1);u==null&&c();l=e(r)+"."+f;n.keyframes!=null&&i.stylesheetManager.setRules(t,n.keyframes);typeof n.css=="string"?(v=n.css.match(/[\;\:]/g),v!=null&&v.length>0?(i.stylesheetManager.setRules(t,l,n.css),u.addClass([f,r])):(f=n.css,u.addClass([n.css,r]))):(i.stylesheetManager.setRules(t,l,n.css),u.addClass([f,r]));s=function(){u.removeClass([f]);i.stylesheetManager.removeRules(t,l);h(!0)};o=setTimeout(function(){a.cancelTransition()},n.duration)},e=function(n){return"."+n+"."+EVUI.Modules.Panes.Constants.CSS_Backdrop},c=function(){n==null&&(n=document.createElement("div"),n.classList.add(EVUI.Modules.Panes.Constants.CSS_Backdrop),n.id=y,u=new EVUI.Modules.Dom.DomHelper(n));n.isConnected===!1&&(n.parentElement!=null&&n.remove(),document.body.appendChild(n))}};this.addPane=function(n){if(n==null)throw Error("Object expected.");var t=tt(n);return t.link.pane};this.removePane=function(n){var t,i;return typeof n!="string"?!1:(t=c(n),t!=null)?(i=e.indexOf(t),i!==-1&&e.splice(i,1),t.link.removed=!0,!0):!1};this.getPane=function(n,t){var u,f,o,i,r;if(typeof n=="string")return u=c(n),u!=null?u.link.pane:null;if(typeof n=="function"){for(f=[],o=e.length,i=0;i<o;i++)if(r=e[i],n(r.link.pane)===!0)if(t!==!0)f.push(r.link.pane);else return r.link.pane;return f}return null};this.isPaneVisible=function(n){var t=this.getPane(n);return t==null?!1:t.isVisible};this.getVisiblePanes=function(){return this.getPane(function(n){return n.isVisible})};this.getPanes=function(){return this.getPane(function(){return!0})};this.getTopZIndex=function(){return tr()};this.showPane=function(n,t,i){var f=null,u,e,r;if(typeof n=="string"){if(f=c(n),f==null)throw Error('No pane exists with an id of "'+n+'"');}else if(n instanceof Event)u=st(n),f=u.entry,e=!1,EVUI.Modules.Core.Utils.isObject(t)===!1&&(typeof t=="function"&&(i=t,t=null),t=u.userShowArgs,EVUI.Modules.Core.Utils.isObject(t)===!0&&(e=!0,t.context=u.context),EVUI.Modules.Core.Utils.isObject(u.userLoadArgs)===!0&&(e===!0?t.loadArgs=u.userLoadArgs:(t=new EVUI.Modules.Panes.PaneShowArgs,t.loadArgs=u.userLoadArgs,t.context=u.context),t.loadArgs.context=u.context));else if(EVUI.Modules.Core.Utils.isObject(n)===!0)f=tt(n);else throw Error("String or object expected.");if(f==null)throw Error("No pane with an ID of "+n+" exists.");typeof t=="function"&&(i=t,t=null);t==null&&(t=new EVUI.Modules.Panes.PaneShowArgs,t.loadArgs=new EVUI.Modules.Panes.PaneLoadArgs);r=new g;r.entry=f;r.action=EVUI.Modules.Panes.PaneAction.Show;r.currentAction=EVUI.Modules.Panes.PaneAction.Show;r.callback=typeof i=="function"?i:function(){};r.userShowArgs=t;r.userLoadArgs=t.loadArgs;r.resolvedShowArgs=v(f,t);r.resolvedLoadArgs=r.resolvedShowArgs.loadArgs;k(r)};this.showPaneAsync=function(n,i){return new Promise(function(r){t.showPane(n,i,function(n){r(n)})})};this.hidePane=function(n,t,i){var u=null,f,r;if(typeof n=="string"?u=rt(n,!1):n instanceof Event?(f=st(n,!0),u=f.entry,EVUI.Modules.Core.Utils.isObject(t)===!1&&(typeof t=="function"&&(i=t,t=null),t=f.userHideArgs,EVUI.Modules.Core.Utils.isObject(t)===!0&&(t.context=f.context))):EVUI.Modules.Core.Utils.isObject(n)===!0&&(u=rt(n.id,!1)),u==null)throw Error("No pane with an ID of "+n+" exists.");typeof t=="function"&&(i=t,t=null);t==null&&(t=new EVUI.Modules.Panes.PaneHideArgs,t.unloadArgs=new EVUI.Modules.Panes.PaneUnloadArgs);r=new g;r.entry=u;r.action=EVUI.Modules.Panes.PaneAction.Hide;r.currentAction=EVUI.Modules.Panes.PaneAction.Hide;r.callback=typeof i=="function"?i:function(){};r.userHideArgs=t;r.userUnloadArgs=t!=null?t.unloadArgs:null;r.resolvedHideArgs=hi(u,t);r.resolvedUnloadArgs=r.resolvedHideArgs.unloadArgs;k(r)};this.hidePaneAsync=function(n,i){return new Promise(function(r){t.hidePane(n,i,function(n){r(n)})})};this.loadPane=function(n,t,i){var u=null,f,r;if(typeof n=="string"){if(u=c(n),u==null)throw Error('No pane exists with an id of "'+n+'"');}else if(n instanceof Event)f=st(n),u=f.entry,EVUI.Modules.Core.Utils.isObject(t)===!1&&(typeof t=="function"&&(i=t,t=null),t=f.userLoadArgs,t!=null&&(t.context=f.context));else if(EVUI.Modules.Core.Utils.isObject(n)===!0)u=tt(n);else throw Error("String or object expected.");if(u==null)throw Error("No pane with an ID of "+n+" exists.");typeof t=="function"&&(i=t,t=null);t==null&&(t=new EVUI.Modules.Panes.PaneLoadArgs);r=new g;r.entry=u;r.action=EVUI.Modules.Panes.PaneAction.Load;r.currentAction=EVUI.Modules.Panes.PaneAction.Load;r.callback=typeof i=="function"?i:function(){};r.userLoadArgs=t;r.resolvedLoadArgs=nt(u.link.pane.loadSettings,t);k(r)};this.loadPaneAsync=function(n,i){return new Promise(function(r){t.loadPane(n,i,function(n){r(n)})})};this.unloadPane=function(n,t,i){var u=null,f,r;if(typeof n=="string"?u=c(n):n instanceof Event?(f=st(n,!0),u=f.entry,EVUI.Modules.Core.Utils.isObject(t)===!1&&(typeof t=="function"&&(i=t,t=null),t=f.userUnloadArgs,t!=null&&(t.context=f.context))):EVUI.Modules.Core.Utils.isObject(n)===!0&&(n=n.id,u=rt(n,!1)),u==null)throw Error("No pane with an ID of "+n+" exists.");typeof t=="function"&&(i=t,t=null);t==null&&(t=new EVUI.Modules.Panes.PaneUnloadArgs);r=new g;r.entry=u;r.action=EVUI.Modules.Panes.PaneAction.Unload;r.currentAction=EVUI.Modules.Panes.PaneAction.Unload;r.callback=typeof i=="function"?i:function(){};r.userUnloadArgs=t;r.resolvedUnloadArgs=kt(u,t);k(r)};this.unloadPaneAsync=function(n,i){return new Promise(function(r){t.unloadPane(n,i,function(n){r(n)})})};this.movePane=function(n,t,i){var r=null,f,e,u;if(EVUI.Modules.Core.Utils.isObject(t)===!1)throw Error("No move destination set.");else if(f=typeof t.top=="number",e=typeof t.left=="number",f===!1&&e===!1)throw Error("Invalid move destination.");if(typeof n=="string"){if(r=c(n),r==null)throw Error('No pane exists with an id of "'+n+'"');}else if(EVUI.Modules.Core.Utils.isObject(n)===!0)r=tt(n);else throw Error("String or object expected.");if(r==null)throw Error("No pane with an ID of "+n+" exists.");if(r.link.pane.isVisible===!1)throw Error("Pane must be visible to be moved.");if(r.link.currentOperation!=null&&(r.link.currentOperation.action===EVUI.Modules.Panes.PaneAction.Unload||r.link.currentOperation.action===EVUI.Modules.Panes.PaneAction.Hide))throw Error("Pane is currently being hidden or unloaded and cannot be moved.");u=new g;u.entry=r;u.action=EVUI.Modules.Panes.PaneAction.Move;u.currentAction=EVUI.Modules.Panes.PaneAction.Move;u.callback=typeof i=="function"?i:function(){};u.userMoveArgs=t;u.resolvedMoveArgs=ci(r,t);k(u)};this.movePaneAsync=function(n,i){return new Promise(function(r){t.movePane(n,i,function(n){r(n)})})};this.resizePane=function(n,t,i){var r=null,u;if(EVUI.Modules.Core.Utils.isObject(t)===!1)throw Error("Object expected - no resize dimensions set.");else{var f=typeof t.top=="number",e=typeof t.left=="number",o=typeof t.bottom=="number",s=typeof t.right=="number";if(f===!1&&e===!1&&o===!1&&s===!1)throw Error("Invalid resize dimensions.");}if(typeof n=="string"){if(r=c(n),r==null)throw Error('No pane exists with an id of "'+n+'"');}else if(EVUI.Modules.Core.Utils.isObject(n)===!0)r=tt(n);else throw Error("String or object expected.");if(r==null)throw Error("No pane with an ID of "+n+" exists.");if(r.link.pane.isVisible===!1)throw Error("Pane must be visible to be resized.");if(r.link.currentOperation!=null&&(r.link.currentOperation.action===EVUI.Modules.Panes.PaneAction.Unload||r.link.currentOperation.action===EVUI.Modules.Panes.PaneAction.Hide))throw Error("Pane is currently being hidden or unloaded and cannot be resized.");t==null&&(t=new EVUI.Modules.Panes.PaneMoveArgs);u=new g;u.entry=r;u.action=EVUI.Modules.Panes.PaneAction.Resize;u.currentAction=EVUI.Modules.Panes.PaneAction.Resize;u.callback=typeof i=="function"?i:function(){};u.userResizeArgs=t;u.resolvedResizeArgs=dt(r,t);k(u)};this.resizePaneAsync=function(n,i){return new Promise(function(r){t.resizePane(n,i,function(n){r(n)})})};this.addEventListener=function(n,t,i){return EVUI.Modules.Core.Utils.isObject(i)===!1&&(i=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),i.eventType=EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent,bt.addEventListener(n,t,i)};this.removeEventListener=function(n,t){return bt.removeEventListener(n,t)};this.onLoad=function(){};this.onLoaded=function(){};this.onInitialize=function(){};this.onShow=function(){};this.onPosition=function(){};this.onShown=function(){};this.onHide=function(){};this.onHidden=function(){};this.onUnload=function(){};this.onUnloaded=function(){};this.onMove=function(){};this.onMoved=function(){};this.onResize=function(){};this.onResized=function(){};var v=function(n,t){var i=new EVUI.Modules.Panes.PaneShowArgs,r,h,c,f,e,u;EVUI.Modules.Core.Utils.shallowExtend(i,n.link.pane.showSettings,ui);EVUI.Modules.Core.Utils.shallowExtend(i,t,ui);t!=null&&t.context!==undefined&&(i.context=t.context);EVUI.Modules.Core.Utils.isObject(t.loadArgs)===!0&&(i.loadArgs=nt(n.link.pane.loadSettings,t.loadArgs),t.loadArgs.hasOwnProperty("context")===!1&&(i.loadArgs.context=t.context));r=n.link.pane.showSettings==null?{}:n.link.pane.showSettings;i.showTransition=y(r.showTransition,t.showTransition);i.clipSettings=tu(r.clipSettings,t.clipSettings);i.backdropSettings=iu(r.backdropSettings,t.backdropSettings);var o=at(t),l=at(n.link.pane.showSettings),s=null;if(o===EVUI.Modules.Panes.PaneShowMode.None&&l!==EVUI.Modules.Panes.PaneShowMode.None)s=l;else if(o!==EVUI.Modules.Panes.PaneShowMode.None)s=o;else return i;switch(s){case EVUI.Modules.Panes.PaneShowMode.AbsolutePosition:i.absolutePosition=br(r.absolutePosition,t.absolutePosition);break;case EVUI.Modules.Panes.PaneShowMode.Anchored:i.anchors=kr(r.anchors,t.anchors);break;case EVUI.Modules.Panes.PaneShowMode.Centered:h=r.center;typeof t.center=="boolean"&&(h=t.center);i.center=h;break;case EVUI.Modules.Panes.PaneShowMode.DocumentFlow:i.documentFlow=dr(r.documentFlow,t.documentFlow);break;case EVUI.Modules.Panes.PaneShowMode.Fullscreen:c=r.fullscreen;typeof t.fullscreen=="boolean"&&(c=t.fullscreen);i.fullscreen=c;break;case EVUI.Modules.Panes.PaneShowMode.PositionClass:if(f={},EVUI.Modules.Core.Utils.isArray(r.positionClass)===!0)for(e=r.positionClass.length,u=0;u<e;u++)f[r.positionClass[u]]=!0;else EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r.positionClass)===!1&&(f[r.positionClass]=!0);if(EVUI.Modules.Core.Utils.isArray(t.positionClass)===!0)for(e=t.positionClass.length,u=0;u<e;u++)f[t.positionClass[u]]=!0;else EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t.positionClass)===!1&&(f[t.positionClass]=!0);i.positionClass=Object.keys(f);break;case EVUI.Modules.Panes.PaneShowMode.RelativePosition:i.relativePosition=gr(r.relativePosition,t.relativePosition)}return i},br=function(n,t){var i=new EVUI.Modules.Panes.PaneAbsolutePosition,r=function(n,t,r){return(n==="top"||n==="left")&&r===i&&typeof t[n]!="number"?!1:!0};return EVUI.Modules.Core.Utils.shallowExtend(i,n,r),EVUI.Modules.Core.Utils.shallowExtend(i,t,r),i},kr=function(n,t){var i=new EVUI.Modules.Panes.PaneAnchors;return EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.shallowExtend(i,t),i.top=u(i.top),i.left=u(i.left),i.bottom=u(i.bottom),i.right=u(i.right),i},dr=function(n,t){var i=new EVUI.Modules.Panes.PaneDocumentFlow;return EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.shallowExtend(i,t),i.relativeElement=u(i.relativeElement),i},gr=function(n,t){var i=new EVUI.Modules.Panes.PaneRelativePosition;return EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.shallowExtend(i,t),i.relativeElement=u(i.relativeElement),i},nt=function(n,t){var i=new EVUI.Modules.Panes.PaneLoadArgs,o,f,e,r,s,h,c,l;if(EVUI.Modules.Core.Utils.shallowExtend(i,n,fi),EVUI.Modules.Core.Utils.shallowExtend(i,t,fi),o=wt(n),f=wt(t),t!=null&&t.context!==undefined&&(i.context=t.context),e=null,r=null,f===EVUI.Modules.Panes.PaneLoadMode.None&&o!==EVUI.Modules.Panes.PaneLoadMode.None)e=o,r=n;else if(f!==EVUI.Modules.Panes.PaneLoadMode.None)e=f,r=t;else return i;switch(e){case EVUI.Modules.Panes.PaneLoadMode.ExistingElement:i.element=u(r.element);break;case EVUI.Modules.Panes.PaneLoadMode.CSSSelector:i.contextElement=u(r.contextElement);i.selector=r.selector;break;case EVUI.Modules.Panes.PaneLoadMode.HTTP:s=EVUI.Modules.Core.Utils.isObject(n)?n.httpLoadArgs:null;h=EVUI.Modules.Core.Utils.isObject(t)?t.httpLoadArgs:null;i.httpLoadArgs=si(s,h);break;case EVUI.Modules.Panes.PaneLoadMode.Placeholder:c=EVUI.Modules.Core.Utils.isObject(n)?n.placeholderLoadArgs:null;l=EVUI.Modules.Core.Utils.isObject(t)?t.placeholderLoadArgs:null;i.placeholderLoadArgs=nu(c,l)}return i},si=function(n,t){var u=new EVUI.Modules.Http.HttpRequestArgs,e,r,f,i,o;if(EVUI.Modules.Core.Utils.shallowExtend(u,n,["headers"]),EVUI.Modules.Core.Utils.shallowExtend(u,t,["headers"]),e=[],r={},EVUI.Modules.Core.Utils.isObject(n)===!0&&EVUI.Modules.Core.Utils.isArray(n.headers)===!0)for(f=n.headers.length,i=0;i<f;i++)r[n.headers[i].key]=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestHeader,n.headers[i]);if(EVUI.Modules.Core.Utils.isObject(t)===!0&&EVUI.Modules.Core.Utils.isArray(t.headers)===!0)for(f=t.headers.length,i=0;i<f;i++)r[t.headers[i].key]=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Http.HttpRequestHeader,t.headers[i]);for(o in r)e.push(r[o]);return u.headers=e,u},nu=function(n,t){var i=new EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadArgs,r,f;return EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.shallowExtend(i,t),r=EVUI.Modules.Core.Utils.isObject(n)?n.httpArgs:null,f=EVUI.Modules.Core.Utils.isObject(t)?t.httpArgs:null,i.httpArgs=si(r,f),i.contextElement=u(i.contextElement),i},hi=function(n,t){var i=new EVUI.Modules.Panes.PaneHideArgs;return i.unload=n.link.pane.unloadOnHide,EVUI.Modules.Core.Utils.isObject(t)===!1&&(t={}),EVUI.Modules.Core.Utils.deepExtend(i,t,{filter:ar}),t!=null&&t.context!==undefined&&(i.context=t.context),i.hideTransition=y(n.link.pane.showSettings!=null?n.link.pane.showSettings.hideTransition:{},t.hideTransition),i.unloadArgs=kt(n,t==null?null:t.unloadArgs),i},kt=function(n,t){return EVUI.Modules.Core.Utils.deepExtend(new EVUI.Modules.Panes.PaneUnloadArgs,t)},ci=function(n,t){var i=new EVUI.Modules.Panes.PaneMoveArgs,e,r,u,f;return EVUI.Modules.Core.Utils.shallowExtend(i,t),e=n.link.pane.resizeMoveSettings==null?{}:n.link.pane.resizeMoveSettings,i.transition=y(e.moveTransition,t.transition),r=typeof i.top!="number",u=typeof i.left!="number",(r||u)&&(f=n.link.pane.getCurrentPosition(),r&&(i.top=f.top),u&&(i.left=f.left)),i},dt=function(n,t){var i=new EVUI.Modules.Panes.PaneResizeArgs,u,r;EVUI.Modules.Core.Utils.shallowExtend(i,t);u=n.link.pane.resizeMoveSettings==null?{}:n.link.pane.resizeMoveSettings;i.transition=y(u.resizeTransition,t.transition);var f=typeof i.top!="number",e=typeof i.left!="number",o=typeof i.bottom!="number",s=typeof i.right!="number";return(f||e||o||s)&&(r=n.link.pane.getCurrentPosition(),o&&(i.bottom=r.bottom),s&&(i.right=r.right),f&&(i.top=r.top),e&&(i.left=r.left)),i},y=function(n,t){var i=new EVUI.Modules.Panes.PaneTransition;return EVUI.Modules.Core.Utils.isObject(n)===!0&&(EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.isObject(n.css)===!0&&(i.css=EVUI.Modules.Core.Utils.deepExtend({},n.css))),EVUI.Modules.Core.Utils.isObject(t)===!0&&(EVUI.Modules.Core.Utils.shallowExtend(i,t),EVUI.Modules.Core.Utils.isObject(t.css)===!0&&(i.css=EVUI.Modules.Core.Utils.deepExtend(EVUI.Modules.Core.Utils.isObject(i.css)?i.css:{},t.css))),i},tu=function(n,t){var r=new EVUI.Modules.Panes.PaneClipSettings,i;return EVUI.Modules.Core.Utils.isObject(n)===!0&&(EVUI.Modules.Core.Utils.shallowExtend(r,n),EVUI.Modules.Core.Utils.isObject(n.clipBounds)===!0&&(i=u(n.clipBounds),r.clipBounds=i==null?EVUI.Modules.Core.Utils.shallowExtend({},n.clipBounds):i)),EVUI.Modules.Core.Utils.isObject(t)===!0&&(EVUI.Modules.Core.Utils.shallowExtend(r,t),EVUI.Modules.Core.Utils.isObject(t.clipBounds)===!0&&(i=u(t.clipBounds),r.clipBounds=i==null?EVUI.Modules.Core.Utils.shallowExtend({},t.clipBounds):i)),r},iu=function(n,t){var i=new EVUI.Modules.Panes.PaneBackdropSettings;return EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.shallowExtend(i,t),EVUI.Modules.Core.Utils.isObject(t)===!1&&(t={}),EVUI.Modules.Core.Utils.isObject(n)===!1&&(n={}),i.backdropShowTransition=y(n.backdropShowTransition,t.backdropShowTransition),i.backdropHideTransition=y(n.backdropHideTransition,t.backdropHideTransition),EVUI.Modules.Core.Utils.isObject(i.css)===!0&&(i.css=EVUI.Modules.Core.Utils.deepExtend({},i.css)),i},li=function(n,t){var i=new EVUI.Modules.Panes.PaneAutoHideSettings;return EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.shallowExtend(i,t),EVUI.Modules.Core.Utils.isObject(n)===!0&&EVUI.Modules.Core.Utils.isArray(n.autoHideKeys)===!0&&(i.autoHideKeys=n.autoHideKeys.slice()),EVUI.Modules.Core.Utils.isObject(t)===!0&&EVUI.Modules.Core.Utils.isArray(t.autoHideKeys)===!0&&(i.autoHideKeys=t.autoHideKeys.slice()),i},u=function(n,t){if(typeof n=="string")return document.querySelector(n);var i=EVUI.Modules.Core.Utils.getValidElement(n);return i!=null?i:t===!0&&EVUI.Modules.Core.Utils.isObject(n)&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.firstElementChild:null},ai=function(n,t){var i=new EVUI.Modules.Panes.PaneResizeMoveSettings;return EVUI.Modules.Core.Utils.shallowExtend(i,n),EVUI.Modules.Core.Utils.shallowExtend(i,t),EVUI.Modules.Core.Utils.isObject(i.moveTransition)===!0&&(i.moveTransition=y(n.moveTransition,t.moveTransition)),EVUI.Modules.Core.Utils.isObject(i.resizeTransition)===!0&&(i.moveTransition=y(n.resizeTransition,t.resizeTransition)),i},st=function(n,t){var i={},f=new pr,r=EVUI.Modules.Core.Utils.getElementAttributes(n.currentTarget),u=r.getValue(o(EVUI.Modules.Panes.Constants.Attribute_ID)),l,a,v,y,p,e,s,w,h;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(u)===!0&&(u=ru(n,r),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(u)===!0))throw Error("Ambiguous Pane event invocation - no "+EVUI.Modules.Panes.Constants.Attribute_ID+", "+EVUI.Modules.Panes.Constants.Attribute_PlaceholderID+", "+EVUI.Modules.Panes.Constants.Attribute_Selector+", or "+EVUI.Modules.Panes.Constants.Attribute_SourceURL+" attribute present on calling element.");if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(u)===!0)throw Error("Ambiguous Pane event invocation - no "+EVUI.Modules.Panes.Constants.Attribute_ID+" attribute present on calling element.");if(i.id=u,l=r.getValue(o(EVUI.Modules.Panes.Constants.Attribute_Template)),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(l)===!1&&(i.template=l),a=r.getValue(o(EVUI.Modules.Panes.Constants.Attribute_SourceURL)),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(a)===!1&&(i.loadSettings==null&&(i.loadSettings={}),i.loadSettings.httpLoadArgs={},i.loadSettings.httpLoadArgs.url=a,i.loadSettings.httpLoadArgs.method="GET"),v=r.getValue(o(EVUI.Modules.Panes.Constants.Attribute_PlaceholderID)),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(v)===!1&&(i.loadSettings==null&&(i.loadSettings={}),i.loadSettings.placeholderLoadArgs=new EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadArgs,i.loadSettings.placeholderLoadArgs.placeholderID=v),y=r.getValue(o(EVUI.Modules.Panes.Constants.Attribute_Context)),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(y)===!1&&(f.context=y),p=r.getValue(o(EVUI.Modules.Panes.Constants.Attribute_Selector)),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(p)===!1&&(i.loadSettings==null&&(i.loadSettings={}),i.loadSettings.selector=p),e=r.getValue(o(EVUI.Modules.Panes.Constants.Attribute_UnloadOnHide)),e==="true"&&(i.unloadOnHide=!0),e==="false"&&(i.unloadOnHide=!1),s=null,w=r.getValue(EVUI.Modules.Panes.Constants.Attribute_ShowArgs),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(w)===!1&&(s=fu(w,n)),h=c(u),h==null){if(t===!0)throw Error("No pane with an id of "+u+" exists.");h=tt(i)}return s!=null&&(i.showSettings==null&&(i.showSettings={}),EVUI.Modules.Core.Utils.deepExtend(i.showSettings,s)),f.entry=h,f.userShowArgs=i.showSettings,f.userLoadArgs=i.loadSettings,f.userHideArgs={unloadOnHide:e},f},ru=function(n,t){var w=o(EVUI.Modules.Panes.Constants.Attribute_SourceURL),b=o(EVUI.Modules.Panes.Constants.Attribute_PlaceholderID),k=o(EVUI.Modules.Panes.Constants.Attribute_Selector),g=o(EVUI.Modules.Panes.Constants.Attribute_ID),h=[],u=null,c=null,d=t.getValue(w),nt=t.getValue(b),a=t.getValue(k),tt,v,p,i,l,s,ft;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(d)===!1?(h=document.querySelectorAll("["+w+'="'+d+'"]'),c=w,u=d):EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(nt)===!1?(h=document.querySelectorAll("["+b+'="'+placeholderId+'"]'),c=b,u=nt):EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(a)===!1&&(tt=document.querySelectorAll(a),tt.length==1&&(h=document.querySelectorAll("["+k+'="'+a+'" ]'),c=k,u=a)),u==null||c===null)return null;var et=e.length,it=[n.currentTarget];u=u.toLocaleLowerCase();var rt=!1,r=null,ot=h.length;for(v=0;v<ot;v++){var f=h[v],ut=f.getAttribute(c),y=f.getAttribute(g);if((r==null||EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(y)!==!1||y===r)&&typeof ut=="string"&&ut.toLocaleLowerCase()===u){if(r==null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(y)===!1){r=y;continue}else if(r==null){for(p=0;p<et;p++)if(i=e[p],i.link.pane.element===f){r=i.paneId;break}else if(i.link.pane.loadSettings!=null&&i.link.pane.loadSettings.selector===u){if(i.link.pane.loadSettings.contextElement instanceof Node==!1){if(l=document.querySelector(i.link.pane.loadSettings.selector),l!=null&&l!==f)continue;r=i.paneId;break}else if(l=i.link.pane.loadSettings.contextElement.querySelector(i.link.pane.loadSettings.selector),l===f){r=i.paneId;break}}else if(rt===!1&&i.link.pane.loadSettings!=null){if(s=null,i.link.pane.loadSettings.placeholderLoadArgs!=null)s=i.link.pane.loadSettings.placeholderLoadArgs.placeholderID;else if(i.link.pane.loadSettings.element===f){r=i.paneId;break}else i.link.pane.loadSettings.httpLoadArgs!=null&&(s=i.link.pane.loadSettings.httpLoadArgs.url);if(typeof s=="string"&&(s=s.toLowerCase()),s===u){r=i.paneId;break}}rt=!0}it.push(f)}}return r==null&&(r=EVUI.Modules.Core.Utils.makeGuid()),ft=new EVUI.Modules.Dom.DomHelper(it),ft.attr(g,r),r},o=function(n){return n},uu=function(n){var t,i,r;if(typeof n!="string")return{};if(t=n.indexOf("{"),i=n.lastIndexOf("}"),t===-1||i===-1)return{};r=n.substring(t,i+1);try{return JSON.parse(r)}catch(u){throw Error("Error parsing attribute JSON ("+n+"): "+u.message);}},fu=function(n,t){var e=null,a=n.indexOf("{"),o,i,r,f,s,l;if(e=a===-1?n.trim().toLowerCase():n.substring(0,a).trim().toLowerCase(),o={},i=uu(n),e===EVUI.Modules.Panes.PaneShowMode.AbsolutePosition)r=i.top,f=i.left,t instanceof MouseEvent?(typeof r!="number"&&(r=t.clientY),typeof f!="number"&&(f=t.clientX)):(typeof r!="number"&&(r=0),typeof f!="number"&&(f=0)),o.absolutePosition={top:r,left:f};else if(e===EVUI.Modules.Panes.PaneShowMode.RelativePosition){var s=null,r=i.top,f=i.left,v=i.useCursor,h=i.alignment,c=i.orientation;v===!0&&t instanceof MouseEvent?(typeof r!="number"&&(r=t.clientY),typeof f!="number"&&(f=t.clientX)):(s=u(i.relativeElement),EVUI.Modules.Core.Utils.isElement(s)===!1&&(t.type==="contextmenu"?(typeof r!="number"&&(r=t.clientY),typeof f!="number"&&(f=t.clientX)):s=t.currentTarget));EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(h)&&(c=EVUI.Modules.Panes.RelativePositionOrientation.Bottom+" "+EVUI.Modules.Panes.RelativePositionOrientation.Right);EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(c)&&(h=EVUI.Modules.Panes.RelativePositionAlignment.None);o.relativePosition={relativeElement:s,useCursor:v,top:r,left:f,orientation:c,alignment:h};t.type==="contextmenu"&&t.preventDefault()}else e===EVUI.Modules.Panes.PaneShowMode.Centered?o.center=!0:e===EVUI.Modules.Panes.PaneShowMode.Anchored?showSettings.anchors={top:u(i.top),left:u(i.left),bottom:u(i.bottom),right:u(i.right),alignX:EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.alignX)===!0?EVUI.Modules.Panes.AnchorAlignment.Elastic:i.alignX,alignY:EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.alignY)===!0?EVUI.Modules.Panes.AnchorAlignment.Elastic:i.alignY}:e===EVUI.Modules.Panes.PaneShowMode.Fullscreen?o.fullscreen=!0:e===EVUI.Modules.Panes.PaneShowMode.DocumentFlow?(s=null,l=EVUI.Modules.Panes.PaneDocumentFlowMode.Append,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.relativeElement)===!0&&(s=t.currentTarget),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.mode)===!0&&(l=i.mode),o.documentFlow={relativeElement:s,mode:l}):e===EVUI.Modules.Panes.PaneShowMode.PositionClass&&(o.positionClass=i.positionClass);return o},c=function(n){var r,t,i;for(n=n.toLocaleLowerCase(),r=e.length,t=0;t<r;t++)if(i=e[t],i.lowerPaneId===n)return i;return null},eu=function(n){var t=new RegExp(/\s+/g),i=EVUI.Modules.Panes.Constants.CssPrefix+"-"+n;return i.replace(t,"")},tt=function(n){var r,o,i,u,f,s;if(n==null)throw Error("Object expected");if(EVUI.Modules.Core.Utils.instanceOf(n,EVUI.Modules.Panes.Pane)===!0){if(i=c(n.id),i.link.pane!==n)throw Error("PaneID mismatch.");if(i!=null)return i;throw Error("Pane instance unknown.");}if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.id)===!0)throw Error("Pane must have an id that is a non-whitespace string.");return(r=n.id,o=c(r),o!=null)?o:(i=new oi,i.paneId=r,i.lowerPaneId=r.toLowerCase(),i.link=new vr,i.link.manager=t,i.link.paneCSSName=eu(r),i.link.template=n.template,u=new EVUI.Modules.Panes.Pane(i),i.link.pane=u,e.push(i),f=new EVUI.Modules.Core.DeepExtenderOptions,f.recursionFilter=function(n){var t=n.getTargetParent();return t!=null&&t.hasOwnProperty(n.propertyName)===!1?!1:!0},f.filter=function(n){return n.target===u&&(n.propertyName==="id"||n.propertyName==="isVisible"||n.propertyName==="isLoaded"||n.propertyName==="isInitialized"||n.propertyName==="template"||n.propertyName==="show"||n.propertyName==="showAsync"||n.propertyName==="hide"||n.propertyName==="hideAsync"||n.propertyName==="load"||n.propertyName==="loadAsync"||n.propertyName==="unload"||n.propertyName==="unloadAsync"||n.propertyName==="getCurrentPosition"||n.propertyName==="getCurrentZIndex")?!1:!0},s=ou(n.template,i),EVUI.Modules.Core.Utils.deepExtend(u,s),EVUI.Modules.Core.Utils.deepExtend(u,n,f),i)},ou=function(n){return n===EVUI.Modules.Panes.PaneTemplateType.Dialog?{autoHideSettings:{hideMode:EVUI.Modules.Panes.PaneHideMode.Explicit,autoHideKeys:["Escape","Enter"]},showSettings:{center:!0,clipSettings:{clipMode:EVUI.Modules.Panes.PaneClipMode.Shift,clipBounds:document.documentElement}},resizeMoveSettings:{canDragMove:!0,canResizeBottom:!0,canResizeLeft:!0,canResizeRight:!0,canResizeTop:!0,dragHanldeMargin:20}}:n===EVUI.Modules.Panes.PaneTemplateType.Dropdown?{autoHideSettings:{hideMode:EVUI.Modules.Panes.PaneHideMode.GlobalClick,autoHideKeys:["Escape"],allowChaining:!0},showSettings:{relativePosition:{orientation:EVUI.Modules.Panes.RelativePositionOrientation.Bottom+" "+EVUI.Modules.Panes.RelativePositionOrientation.Right,alignment:EVUI.Modules.Panes.RelativePositionAlignment.None},clipSettings:{mode:EVUI.Modules.Panes.PaneClipMode.Shift,clipBounds:document.documentElement}}}:n===EVUI.Modules.Panes.PaneTemplateType.Modal?{autoHideSettings:{hideMode:EVUI.Modules.Panes.PaneHideMode.Explicit,autoHideKeys:["Escape","Enter"]},showSettings:{center:!0,backdropSettings:{showBackdrop:!0}},clipSettings:{clipMode:EVUI.Modules.Panes.PaneClipMode.Clip,clipBounds:document.documentElement}}:{}},su=function(n){return n==null?!0:n.triggerType===EVUI.Modules.Panes.PaneAutoTriggerType.Click||n.triggerType===EVUI.Modules.Panes.PaneAutoTriggerType.ExteriorClick||n.triggerType===EVUI.Modules.Panes.PaneAutoTriggerType.GlobalClick?hu(n):n.triggerType===EVUI.Modules.Panes.PaneAutoTriggerType.KeyDown?cu(n):!0},hu=function(n){var h=c(n.pane.id),v=n.pane.autoHideSettings==null?{}:n.pane.autoHideSettings,l,s,t,i,u,r;if(h.link.pane.autoHideSettings==null||h.link.pane.autoHideSettings.allowChaining!==!0)return!0;var f=[],o=[],a=e.length;for(t=0;t<a;t++)i=e[t],i.link.pane.isVisible===!0&&f.push(i),i.link.paneAction===EVUI.Modules.Panes.PaneAction.Show&&o.push(i);if(l=f.length,s=o.length,s>0)for(t=0;t<l;t++)for(i=f[t],u=0;u<s;u++)if(r=o[u],r.link.currentOperation!=null&&r.link.currentOperation.resolvedShowArgs!=null&&r.link.currentOperation.resolvedShowArgs.relativePosition!=null&&i.link.pane.element.contains(r.link.currentOperation.resolvedShowArgs.relativePosition.relativeElement))return!1;return!0},cu=function(n){var t,r,u,i,f;if(n.pane.autoHideSettings==null&&EVUI.Modules.Core.Utils.isArray(n.pane.autoHideSettings.autoHideKeys)===!1||n.pane.autoHideSettings.autoHideKeys.indexOf(n.event.key)<0)return!1;if(t=rt(function(n){return n.link.pane.isVisible===!0},!0),t==null)return!0;for(r=n.pane.getCurrentZIndex(),u=t.length,i=0;i<u;i++)if(f=t[i],f.link.pane.getCurrentZIndex()>r)return!1;return n.event.stopPropagation(),n.event.preventDefault(),!0},rt=function(n,t){var u,f,o,i,r;if(typeof n=="string")return u=c(n),u!=null?u:null;if(typeof n=="function"){for(f=[],o=e.length,i=0;i<o;i++)if(r=e[i],n(r)===!0)if(t===!0)f.push(r);else return r;return f}return null},k=function(n){var i=p(n.entry.link,n.action),t,u,f;if(i==null&&(i=new yr,i.action=n.action,n.entry.link.callbackStack.push(i)),i.opSessions.indexOf(n)===-1&&i.opSessions.push(n),t=ff(n),t=uf(t,n),t==null||t.length===0)return ut(n.entry.link,n.action,!0);if(t[0]!==r.QueueCallback){if(t[0]===r.Queue&&n.isQueued===!1){for(u=i.opSessions[0];u!=null;)if(u.queuedOpSession!=null)u=u.queuedOpSession;else{u.queuedOpSession=n;n.isQueued=!0;break}return}n.cancel=t[0]===r.CancelCurrent;n.continue=t[0]===r.Continue;f=yu(t,n);n.cancel===!0?lu(f,t,n):n.continue===!0?au(f,t,n):vu(f,t,n)}},lu=function(n,t,r){vi(r.entry.link,r.entry.link.paneAction);try{r.entry.link.transitionTimeoutID!==-1&&typeof r.entry.link.transitionCallback=="function"&&(r.entry.link.transitionCallback(),r.entry.link.transitionTimeoutID=-1,r.entry.link.transitionCallback=null,r.entry.link.transitionSelector=null);i.backdropManager.cancelTransition()}catch(f){EVUI.Modules.Core.Utils.log(f.stack)}if(r.entry.link.eventStream.isWorking()===!0&&r.entry.link.eventStream.getStatus()!==EVUI.Modules.EventStream.EventStreamStatus.Seeking)r.entry.link.eventStream.cancel(),r.entry.link.paneActionSequence=t,r.entry.link.paneAction=r.action,r.entry.link.eventStream.onComplete=function(){r.entry.link.eventStream=n;n.execute()};else{var u=r.entry.link.eventStream.getCurrentStep();u!=null&&u.key!=="pane.oncomplete"&&r.entry.link.eventStream.seek("pane.oncomplete");ut(r.entry.link,r.entry.link.paneAction,!1,function(){r.entry.link.paneActionSequence=t;r.entry.link.paneAction=r.action;r.entry.link.eventStream.isWorking()===!1?setTimeout(function(){var t=p(r.entry.link,r.action);t!=null&&t.opSessions.filter(function(n){return n===r&&n.wasCanceled===!0}).length===0&&(r.entry.link.eventStream=n,n.execute())}):r.entry.link.eventStream.onComplete=function(){r.entry.link.eventStream=n;n.execute()}})}},au=function(n,t,i){var u=i.entry.link.paneAction,r=p(i.entry.link,u),f,e;r!=null&&r.opSessions.length>0&&(r.opSessions[r.opSessions.length-1].continuedTo=i);f=i.entry.link.eventStream.getStep(EVUI.Modules.Panes.Constants.Job_Complete);f.handler=function(n){n.resolve()};e=n.getStep(EVUI.Modules.Panes.Constants.Job_Complete);e.handler=function(n){ut(i.entry.link,i.action,!0,function(){ut(i.entry.link,u,!0,function(){n.resolve()})})};i.entry.link.eventStream.onComplete=function(){var t=p(i.entry.link,i.action);t!=null&&t.opSessions.filter(function(n){return n===i&&n.wasCanceled===!0}).length===0&&(i.entry.link.eventStream=n,n.execute())}},vu=function(n,t,i){i.entry.link.eventStream=n;i.entry.link.paneActionSequence=t;i.entry.link.paneAction=i.action;i.entry.link.currentOperation=i;setTimeout(function(){var t=p(i.entry.link,i.action);t!=null&&t.opSessions.filter(function(n){return n===i&&n.wasCanceled===!0}).length===0&&n.execute()})},vi=function(n,t){var u=p(n,t),f,i,r;if(u!=null)for(f=u.opSessions.length,i=0;i<f;i++)r=u.opSessions[i],r.wasCanceled=!0,r.continuedTo!=null&&vi(n,r.continuedTo.action)},yu=function(n,t){var i=new EVUI.Modules.EventStream.EventStream,e,f,u;for(i.context=t.entry.link.pane,pu(i,t),e=n.length,f=0;f<e;f++)u=n[f],u===r.Initialize?bu(i,t):u===r.Load?wu(i,t):u===r.Show?ku(i,t):u===r.Position?yi(i,t):u===r.Hide?du(i,t):u===r.Unload?rf(i,t):u===r.Move?gu(i,t):u===r.Resize&&nf(i,t);return tf(i,t),i},pu=function(n,t){n.canSeek=!0;n.endExecutionOnEventHandlerCrash=!1;n.bubblingEvents=[t.entry.link.bubblingEvents,bt];n.processInjectedEventArgs=function(n){var i=new EVUI.Modules.Panes.PaneEventArgs(t.entry);return i.cancel=n.cancel,i.eventType=n.key,i.eventName=n.name,i.pause=n.pause,i.resume=n.resume,i.cancel=n.cancel,i.stopPropagation=n.stopPropagation,t.context==null&&(t.action===EVUI.Modules.Panes.PaneAction.Show?t.resolvedShowArgs!=null&&(t.context=t.resolvedShowArgs.context):t.action===EVUI.Modules.Panes.PaneAction.Load?t.resolvedLoadArgs!=null&&(t.context=t.resolvedLoadArgs.context):t.action===EVUI.Modules.Panes.PaneAction.Hide?t.resolvedHideArgs!=null&&(t.context=t.resolvedHideArgs.context):t.action===EVUI.Modules.Panes.PaneAction.Unload?t.resolvedUnloadArgs!=null&&(t.context=t.resolvedUnloadArgs.context):t.action===EVUI.Modules.Panes.PaneAction.Move?t.resolvedMoveArgs!=null&&(t.context=t.resolvedMoveArgs.context):t.action===EVUI.Modules.Panes.PaneAction.Resize&&t.resolvedResizeArgs!=null&&(t.context=t.resolvedResizeArgs.context)),i.context=t.context,i.hideArgs=t.userHideArgs,i.loadArgs=t.userLoadArgs,i.showArgs=t.userShowArgs,i.unloadArgs=t.unloadArgs,i.moveArgs=t.userMoveArgs,i.resizeArgs=t.userResizeArgs,i.action=t.action,i.currentAction=t.currentAction,i.paneShowMode=t.showMode,i.calculatedPosition=EVUI.Modules.Core.Utils.deepExtend({},t.entry.link.lastCalculatedPosition),i};n.processReturnedEventArgs=function(n){t.context=n.context;t.userHideArgs=n.hideArgs;t.userLoadArgs=n.loadArgs;t.userShowArgs=n.showArgs;t.userUnloadArgs=n.unloadArgs;t.userResizeArgs=n.resizeArgs;t.userMoveArgs=n.moveArgs};n.onCancel=function(){n.seek(EVUI.Modules.Panes.Constants.Job_Complete)};n.onError=function(){n.seek(EVUI.Modules.Panes.Constants.Job_Complete)}},wu=function(n,i){var r=!1;n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Preload,key:EVUI.Modules.Panes.Constants.Job_Preload,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){i.currentAction=EVUI.Modules.Panes.PaneAction.Load;i.entry.link.pane.element!=null&&i.entry.link.pane.element.isConnected===!0&&(i.entry.link.paneStateFlags|=EVUI.Modules.Panes.PaneStateFlags.Loaded,r=!0);n.resolve()}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnLoad,key:EVUI.Modules.Panes.Constants.Event_OnLoad,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)!==!0)return typeof i.entry.link.pane.onLoad=="function"?i.entry.link.pane.onLoad.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnLoad,key:EVUI.Modules.Panes.Constants.Event_OnLoad,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)!==!0)return typeof t.onLoad=="function"?t.onLoad.call(t,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Load,key:EVUI.Modules.Panes.Constants.Job_Load,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){if(i.resolvedLoadArgs=nt(i.entry.link.pane.loadSettings,i.userLoadArgs),EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!0&&i.resolvedLoadArgs.reload===!1)return n.resolve();if(EVUI.Modules.Core.Utils.isElement(i.entry.link.pane.element)===!0||i.entry.link.pane.element!=null&&(i.entry.link.pane.element=u(i.entry.link.pane.element),EVUI.Modules.Core.Utils.isElement(i.entry.link.pane.element)===!0))return i.entry.link.paneStateFlags|=EVUI.Modules.Panes.PaneStateFlags.Loaded,n.resolve();if(i.resolvedLoadArgs=nt(i.entry.link.pane.loadSettings,i.userLoadArgs),i.resolvedLoadArgs.reload===!0&&(i.entry.link.paneStateFlags=EVUI.Modules.Core.Utils.removeFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded),cr(i.entry)),EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded))return n.resolve();ke(i.entry,i.resolvedLoadArgs,function(t){t===!0?(i.entry.link.pane.element!=null&&i.entry.link.pane.element.isConnected===!1&&ft(i.entry),i.entry.link.paneStateFlags|=EVUI.Modules.Panes.PaneStateFlags.Loaded,i.entry.link.lastResolvedLoadArgs=i.resolvedLoadArgs,n.resolve()):n.reject("Failed to load Pane root element.")})}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnLoaded,key:EVUI.Modules.Panes.Constants.Event_OnLoaded,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(r!==!0)return typeof i.entry.link.pane.onLoaded=="function"?i.entry.link.pane.onLoaded.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnLoaded,key:EVUI.Modules.Panes.Constants.Event_OnLoaded,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(r!==!0)return typeof t.onLoaded=="function"?t.onLoaded.call(t,n):void 0}})},bu=function(n,i){n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnInitialize,key:EVUI.Modules.Panes.Constants.Event_OnInitialize,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(i.currentAction=EVUI.Modules.Panes.PaneAction.Show,EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Initialized)!==!0)return typeof i.entry.link.pane.onInitialize=="function"?i.entry.link.pane.onInitialize.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnInitialize,key:EVUI.Modules.Panes.Constants.Event_OnInitialize,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Initialized)!==!0)return typeof t.onInitialize=="function"?t.onInitialize.call(t,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Initialize,key:EVUI.Modules.Panes.Constants.Job_Initialize,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){i.entry.link.paneStateFlags|=EVUI.Modules.Panes.PaneStateFlags.Initialized;n.resolve()}})},ku=function(n,i){n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnShow,key:EVUI.Modules.Panes.Constants.Event_OnShow,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(i.currentAction=EVUI.Modules.Panes.PaneAction.Show,typeof i.entry.link.pane.onShow=="function"){i.resolvedShowArgs=v(i.entry,i.userShowArgs);var t=d(i.entry,i.resolvedShowArgs);return i.entry.link.lastCalculatedPosition=t,i.entry.link.pane.onShow.call(this,n)}}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnShow,key:EVUI.Modules.Panes.Constants.Event_OnShow,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onShow=="function"){i.resolvedShowArgs=v(i.entry,i.userShowArgs);var r=d(i.entry,i.resolvedShowArgs);return i.entry.link.lastCalculatedPosition=r,t.onShow.call(t,n)}}});yi(n,i);n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnShown,key:EVUI.Modules.Panes.Constants.Event_OnShown,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(typeof i.entry.link.pane.onShown=="function")return i.entry.link.pane.onShown.call(this,n)}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnShown,key:EVUI.Modules.Panes.Constants.Event_OnShown,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onShown=="function")return t.onShown.call(t,n)}})},du=function(n,i){var r=!1;n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnHide,key:EVUI.Modules.Panes.Constants.Event_OnHide,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(i.currentAction=EVUI.Modules.Panes.PaneAction.Hide,EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1){r=!0;return}if(typeof i.entry.link.pane.onHide=="function")return i.entry.link.pane.onHide.call(this,n)}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnHide,key:EVUI.Modules.Panes.Constants.Event_OnHide,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)!==!1)return typeof t.onHide=="function"?t.onHide.call(t,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Hide,key:EVUI.Modules.Panes.Constants.Job_Hide,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){if(EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1)return n.resolve();i.resolvedHideArgs=hi(i.entry,i.userHideArgs);var t=!1,r=!1,u=function(){if(t!==!1&&r!==!1){i.entry.link.paneStateFlags=EVUI.Modules.Core.Utils.removeFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible);i.entry.link.paneStateFlags=EVUI.Modules.Core.Utils.removeFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Positioned);var u=ai(i.entry);u.restoreDefaultOnHide===!0&&wi(i.entry,!0);n.resolve()}};no(i.entry,i.entry.link.lastResolvedShowArgs,i.resolvedHideArgs.hideTransition,function(){t=!0;u()});to(i.entry,function(){r=!0;u()})}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnHidden,key:EVUI.Modules.Panes.Constants.Event_OnHidden,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(r!==!0)return typeof i.entry.link.pane.onHidden=="function"?i.entry.link.pane.onHidden.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnHidden,key:EVUI.Modules.Panes.Constants.Event_OnHidden,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(r!==!0)return typeof t.onShown=="function"?t.onShown.call(t,n):void 0}})},yi=function(n,r){n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_InitialPosition,key:EVUI.Modules.Panes.Constants.Job_InitialPosition,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){r.action=EVUI.Modules.Panes.PaneAction.Show;r.resolvedShowArgs=v(r.entry,r.userShowArgs);var t=d(r.entry,r.resolvedShowArgs);r.entry.link.lastCalculatedPosition=t;n.resolve()}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnPosition,key:EVUI.Modules.Panes.Constants.Event_OnPosition,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(typeof r.entry.link.pane.onPosition=="function"){r.resolvedShowArgs=v(r.entry,r.userShowArgs);var t=d(r.entry,r.resolvedShowArgs);return r.entry.link.lastCalculatedPosition=t,r.entry.link.pane.onPosition.call(this,n)}}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnPosition,key:EVUI.Modules.Panes.Constants.Event_OnPosition,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(typeof t.onPosition=="function"){r.resolvedShowArgs=v(r.entry,r.userShowArgs);var i=d(r.entry,r.resolvedShowArgs);return r.entry.link.lastCalculatedPosition=i,t.onPosition.call(t,n)}}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_FinalPosition,key:EVUI.Modules.Panes.Constants.Job_FinalPosition,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){var u=!1,f=!1,e,t;r.resolvedShowArgs=v(r.entry,r.userShowArgs);e=d(r.entry,r.resolvedShowArgs);r.entry.link.lastCalculatedPosition=e;t=function(){u!==!1&&f!==!1&&(r.entry.link.paneStateFlags|=EVUI.Modules.Panes.PaneStateFlags.Positioned,r.entry.link.paneStateFlags|=EVUI.Modules.Panes.PaneStateFlags.Visible,r.entry.link.lastResolvedShowArgs=r.resolvedShowArgs,n.resolve())};r.resolvedShowArgs.backdropSettings!=null&&r.resolvedShowArgs.backdropSettings.showBackdrop===!0?(EVUI.Modules.Panes.Constants.GlobalZIndex++,r.entry.link.lastCalculatedPosition.zIndex=EVUI.Modules.Panes.Constants.GlobalZIndex,i.backdropManager.showBackdrop(r.entry.link.paneCSSName,r.entry.link.lastCalculatedPosition.zIndex-1,r.resolvedShowArgs.backdropSettings,function(){u=!0;t()})):(u=!0,t());af(r.entry,r.resolvedShowArgs,r.entry.link.lastCalculatedPosition,function(){f=!0;t()})}})},gu=function(n,i){n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnMove,key:EVUI.Modules.Panes.Constants.Event_OnMove,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(i.wasCanceled!==!0)return(i.currentAction=EVUI.Modules.Panes.PaneAction.Move,EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1)?void 0:typeof i.entry.link.pane.onMove=="function"?i.entry.link.pane.onMove.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnMove,key:EVUI.Modules.Panes.Constants.Event_OnMove,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(i.wasCanceled!==!0)return EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1?void 0:typeof t.onMove=="function"?t.onMove.call(t,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Move,key:EVUI.Modules.Panes.Constants.Job_Move,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){if(i.wasCanceled!==!0){var t=i.entry.link.lastResolvedShowArgs.clipSettings!=null&&i.entry.link.lastResolvedShowArgs.clipSettings.mode===EVUI.Modules.Panes.PaneClipMode.Shift?et(i.entry.link.lastResolvedShowArgs.clipSettings):null,r=new EVUI.Modules.Dom.DomHelper(i.entry.link.pane.element);se(i.entry,i.userMoveArgs,r,null,t,function(){n.resolve()})}}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnMoved,key:EVUI.Modules.Panes.Constants.Event_OnMoved,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(i.wasCanceled!==!0)return(i.currentAction=EVUI.Modules.Panes.PaneAction.Moved,EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1)?void 0:typeof i.entry.link.pane.onMoved=="function"?i.entry.link.pane.onMoved.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnMoved,key:EVUI.Modules.Panes.Constants.Event_OnMoved,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(i.wasCanceled!==!0)return EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1?void 0:typeof t.onMoved=="function"?t.onMoved.call(t,n):void 0}})},nf=function(n,i){n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnResize,key:EVUI.Modules.Panes.Constants.Event_OnResize,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(i.wasCanceled!==!0)return(i.currentAction=EVUI.Modules.Panes.PaneAction.Resize,EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1)?void 0:typeof i.entry.link.pane.onResize=="function"?i.entry.link.pane.onResize.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnResize,key:EVUI.Modules.Panes.Constants.Event_OnResize,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(i.wasCanceled!==!0)return EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1?void 0:typeof t.onResize=="function"?t.onResize.call(t,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Resize,key:EVUI.Modules.Panes.Constants.Job_Resize,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){if(i.wasCanceled!==!0){var t=i.entry.link.lastResolvedShowArgs.clipSettings!=null&&i.entry.link.lastResolvedShowArgs.clipSettings.mode===EVUI.Modules.Panes.PaneClipMode.Shift?et(i.entry.link.lastResolvedShowArgs.clipSettings):null,r=new EVUI.Modules.Dom.DomHelper(i.entry.link.pane.element);oe(i.entry,i.userResizeArgs,r,null,t,function(){n.resolve()})}}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnResized,key:EVUI.Modules.Panes.Constants.Event_OnResized,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(i.wasCanceled!==!0)return(i.currentAction=EVUI.Modules.Panes.PaneAction.Resized,EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1)?void 0:typeof i.entry.link.pane.onResized=="function"?i.entry.link.pane.onResized.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnResized,key:EVUI.Modules.Panes.Constants.Event_OnResized,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(i.wasCanceled!==!0)return EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1?void 0:typeof t.onResized=="function"?t.onResized.call(t,n):void 0}})},tf=function(n,i){n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Complete,key:EVUI.Modules.Panes.Constants.Job_Complete,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){var r=!0;i.action===EVUI.Modules.Panes.PaneAction.Hide&&EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!0&&(r=!1);i.action===EVUI.Modules.Panes.PaneAction.Load&&EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!1&&(r=!1);i.action===EVUI.Modules.Panes.PaneAction.Show&&EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1&&(r=!1);i.action===EVUI.Modules.Panes.PaneAction.Unload&&EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!0&&(r=!1);ut(i.entry.link,i.action,r,function(){i.resolvedUnloadArgs!=null&&i.resolvedUnloadArgs.remove===!0&&t.removePane(i.entry.paneId);i.entry.link.paneAction=EVUI.Modules.Panes.PaneAction.None;i.entry.link.lastCalculatedPosition=null;i.entry.link.currentOperation=null;i.queuedOpSession!=null&&(k(i.queuedOpSession),i.queuedOpSession.isQueued=!1);n.resolve()})}})},rf=function(n,i){var u=!1;n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnUnload,key:EVUI.Modules.Panes.Constants.Event_OnUnload,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){var t=i.action;if(i.currentAction=EVUI.Modules.Panes.PaneAction.Unload,EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!1){u=!0;return}if(i.entry.link.pane.unloadOnHide===!1&&t===r.Hide){u=!0;return}if(typeof i.entry.link.pane.onUnload=="function")return i.entry.link.pane.onUnload.call(this,n)}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnUnload,key:EVUI.Modules.Panes.Constants.Event_OnUnload,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(u!==!0&&EVUI.Modules.Core.Utils.hasFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)!==!1)return typeof t.onUnload=="function"?t.onUnload.call(t,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Job_Unload,key:EVUI.Modules.Panes.Constants.Job_Unload,type:EVUI.Modules.EventStream.EventStreamStepType.Job,handler:function(n){if(i.entry.link.paneStateFlags=EVUI.Modules.Core.Utils.removeFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded),u===!0)return n.resolve();try{i.resolvedUnloadArgs=kt(i.entry,i.userUnloadArgs);cr(i.entry,i.entry.link.lastResolvedShowArgs)}catch(t){return i.entry.link.paneStateFlags=EVUI.Modules.Core.Utils.addFlag(i.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded),n.resolve()}n.resolve()}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnUnloaded,key:EVUI.Modules.Panes.Constants.Event_OnUnloaded,type:EVUI.Modules.EventStream.EventStreamStepType.Event,handler:function(n){if(u!==!0)return typeof i.entry.link.pane.onUnloaded=="function"?i.entry.link.pane.onUnloaded.call(this,n):void 0}});n.addStep({name:EVUI.Modules.Panes.Constants.StepPrefix+"."+EVUI.Modules.Panes.Constants.Event_OnUnloaded,key:EVUI.Modules.Panes.Constants.Event_OnUnloaded,type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,handler:function(n){if(u!==!0)return typeof t.onUnloaded=="function"?t.onUnloaded.call(t,n):void 0}})},uf=function(n,t){var u=t.action,i=t.entry.link.paneAction;if(u===EVUI.Modules.Panes.PaneAction.Load){if(t.resolvedLoadArgs=nt(t.entry.link.pane.loadSettings,t.userLoadArgs),t.resolvedLoadArgs.reload===!0)return n;if(i===EVUI.Modules.Panes.PaneAction.Show)return[r.Continue];if(i===EVUI.Modules.Panes.PaneAction.Load)return[r.QueueCallback];if(i===EVUI.Modules.Panes.PaneAction.Hide||i===EVUI.Modules.Panes.PaneAction.Unload||i===EVUI.Modules.Panes.PaneAction.None)return n;throw Error('Invalid action: "'+i);}else return u===EVUI.Modules.Panes.PaneAction.Show?i===EVUI.Modules.Panes.PaneAction.Load?n:i===u?[r.QueueCallback]:n:i===u?u===EVUI.Modules.Panes.PaneAction.Move||u===EVUI.Modules.Panes.PaneAction.Resize?n:[r.QueueCallback]:n},ff=function(n){var t=[];return n.action===EVUI.Modules.Panes.PaneAction.Show?t=ef(n):n.action===EVUI.Modules.Panes.PaneAction.Load?t=pi(n):n.action===EVUI.Modules.Panes.PaneAction.Hide?t=sf(n):n.action===EVUI.Modules.Panes.PaneAction.Unload?t=hf(n):n.action===EVUI.Modules.Panes.PaneAction.Move?t=cf(n):n.action===EVUI.Modules.Panes.PaneAction.Resize&&(t=lf(n)),t},ef=function(n){var t=pi(n),i=t.indexOf(r.CancelCurrent)!==-1;return i===!1&&(n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Hide||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Unload)&&t.push(r.CancelCurrent),n.resolvedShowArgs==null&&(n.resolvedShowArgs=v(n.entry,n.userShowArgs)),(EVUI.Modules.Core.Utils.hasFlag(n.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Initialized)===!1||n.resolvedShowArgs.reInitialize===!0)&&t.push(r.Initialize),t.push(r.Show),t},pi=function(n){var t=[];if(EVUI.Modules.Core.Utils.hasFlag(n.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!0){if(n.resolvedLoadArgs==null&&(n.resolvedLoadArgs=nt(n.entry.link.pane.loadSettings,n.userLoadArgs)),n.resolvedLoadArgs.reload===!0)return n.entry.link.paneAction!==EVUI.Modules.Panes.PaneAction.None&&t.push(r.CancelCurrent),t.push(r.Load),t}else n.entry.link.paneAction!==EVUI.Modules.Panes.PaneAction.None&&n.entry.link.paneAction!==EVUI.Modules.Panes.PaneAction.Load&&t.push(r.CancelCurrent),n.entry.link.paneAction!==EVUI.Modules.Panes.PaneAction.Load&&t.push(r.Load);return t},sf=function(n){var t=[];return((n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Load||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Show||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Unload||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Move||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Resize)&&t.push(r.CancelCurrent),n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Hide)?t:(t.push(r.Hide),EVUI.Modules.Core.Utils.hasFlag(n.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!0&&t.push(r.Unload),t)},hf=function(n){var t=[];return(n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Load||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Show||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Hide||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Move||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Resize)&&t.push(r.CancelCurrent),EVUI.Modules.Core.Utils.hasFlag(n.entry.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!0&&t.push(r.Unload),t},cf=function(n){var t=[];return(n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Move||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Resize)&&t.push(r.Queue),t.push(r.Move),t},lf=function(n){var t=[];return(n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Move||n.entry.link.paneAction===EVUI.Modules.Panes.PaneAction.Resize)&&t.push(r.Queue),t.push(r.Resize),t},p=function(n,t){for(var r,u=n.callbackStack.length,i=0;i<u;i++)if(r=n.callbackStack[i],r.action===t)return r;return null},ut=function(n,t,i,r){var h,o,v,s,u,f,c;if(typeof r!="function"&&(r=function(){}),h=p(n,t),h==null)return r(!1);s=n.callbackStack.indexOf(h);s!==-1&&n.callbackStack.splice(s,1);var y=[],e=[],l=h.opSessions.length,a=!1;for(u=0;u<l;u++)(f=h.opSessions[u],f.isQueued!==!0)&&(f.continuedTo!=null&&(o=p(n,f.continuedTo.action),o!=null&&a===!1&&(a=!0,v=o.opSessions.filter(function(n){return n.wasCanceled}),v.length===o.opSessions.length?(s=n.callbackStack.indexOf(o),s!==-1&&n.callbackStack.splice(s,1)):o.opSessions=o.opSessions.filter(function(n){return n.wasCanceled===!1}),e=e.concat(v))),e.push(f));for(l=e.length,a===!0&&(e=e.sort(function(n,t){return n.callbackOrdinal-t.callbackOrdinal})),u=0;u<l;u++)f=e[u],typeof f.callback=="function"&&y.push(f.callback);c=new EVUI.Modules.Core.AsyncSequenceExecutionArgs;c.functions=y;c.parameter=i;c.forceCompletion=!0;EVUI.Modules.Core.AsyncSequenceExecutor.execute(c,function(n){n!=null&&n.length>0&&EVUI.Modules.Core.Utils.log(n);r(!0)})},af=function(n,t,r,u){i.stylesheetManager.ensureSheet(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,{lock:!0});r!=null&&(r instanceof EVUI.Modules.Panes.PanePosition||typeof r.top=="number"&&r.left==="number"&&typeof r.mode=="string")&&(r=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Panes.PanePosition(r.mode),r,["mode"]));vf(n,t,r,u)},vf=function(n,t,i,r){if(typeof r!="function"&&(r=function(){}),wi(n,!1),i==null&&(n.link.lastResolvedShowArgs=t,i=d(n,t)),n.link.lastCalculatedPosition=i,bi(n,!0),ni(n,!0),i==null)return ft(n),r(!1);yf(n,t,i);bf(n,t,i,!1,function(n){r(n)})},d=function(n,t){if(n==null||n.link.pane.element==null||EVUI.Modules.Core.Utils.hasFlag(n.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)===!1)return null;var u=ni(n),f=new EVUI.Modules.Dom.DomHelper(n.link.pane.element),i=null,r=at(t);return r!==EVUI.Modules.Panes.PaneShowMode.DocumentFlow&&EVUI.Modules.Core.Utils.hasFlag(n.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!1?(gf(n),i=nr(n,t,r),ft(n)):i=nr(n,t,r),f.addClass(u),i},yf=function(n,t,r){var e=w(n,EVUI.Modules.Panes.Constants.CSS_Position),s=r.classNames.reverse(),u,f,o;r.mode===EVUI.Modules.Panes.PaneShowMode.AbsolutePosition||r.mode===EVUI.Modules.Panes.PaneShowMode.Anchored||r.mode===EVUI.Modules.Panes.PaneShowMode.RelativePosition||r.mode===EVUI.Modules.Panes.PaneShowMode.Centered||r.mode===EVUI.Modules.Panes.PaneShowMode.None?(u={},u.display="inline-block",u.position="absolute",u.top=r.top+"px",u.left=r.left+"px",f=gt(n,t,r),f.setHeight===!0&&(u.height=r.bottom-r.top+"px"),f.setWidth===!0&&(u.width=r.right-r.left+"px"),u.zIndex=r.zIndex.toString(),i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,e,u)):r.mode===EVUI.Modules.Panes.PaneShowMode.Fullscreen?(u={},u.display="inline-block",u.position="fixed",u.top="0px",u.left="0px",u.height="100vh",u.width="100vw",u.margin="0px",f=gt(n,t,r),f.setHeight===!0&&(u.top=r.top+"px",u.height=r.bottom-r.top+"px"),f.setWidth===!0&&(u.left=r.left+"px",u.width=r.right-r.left+"px"),i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,e,u)):r.mode===EVUI.Modules.Panes.PaneShowMode.PositionClass&&(u=null,f=gt(n,t,r),f.setHeight===!0&&(u={},u.top=r.top+"px",u.position="absolute",u.height=r.bottom-r.top+"px"),f.setWidth===!0&&(u==null&&(u={}),u.left=r.left+"px",u.position="absolute",u.width=r.right-r.left+"px"),(f.setHeight===!0||f.setWidth===!0)&&i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,e,u));o=new EVUI.Modules.Dom.DomHelper(n.link.pane.element);o.addClass(s)},gt=function(n,t,i){var r={setHeight:!1,setWidth:!1};return t.setExplicitDimensions===!0?(r.setHeight=!0,r.setWidth=!0,r):(i.classNames.indexOf(EVUI.Modules.Panes.Constants.CSS_ClippedX)!==-1&&(r.setWidth=!0),i.classNames.indexOf(EVUI.Modules.Panes.Constants.CSS_ClippedY)!==-1&&(r.setHeight=!0),i.mode===EVUI.Modules.Panes.PaneShowMode.Anchored&&(t.anchors.alignX===EVUI.Modules.Panes.AnchorAlignment.Elastic&&(r.setWidth=!0),t.anchors.alignY===EVUI.Modules.Panes.AnchorAlignment.Elastic&&(r.setHeight=!0),t.anchors.left!=null&&t.anchors.right!=null&&(r.setWidth=!0),t.anchors.top!=null&&t.anchors.bottom!=null&&(r.setHeight=!0)),r)},wi=function(n,t){var r=w(n,EVUI.Modules.Panes.Constants.CSS_Pane_Style);t===!0?wf(n)===!0&&(i.stylesheetManager.removeRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,r),n.link.pane.element.classList.remove(EVUI.Modules.Panes.Constants.CSS_Pane_Style)):pf(n)===!0&&(i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,r,n.link.inlinedStyle),n.link.pane.element.classList.add(EVUI.Modules.Panes.Constants.CSS_Pane_Style))},pf=function(n){var i=new EVUI.Modules.Dom.DomHelper(n.link.pane.element),t=i.attr("style");return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0||t==="display: inline-block;"?!1:(n.link.inlinedStyle=t,i.attr("style",""),!0)},wf=function(n){var i,t;return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.link.inlinedStyle)===!0?!1:(i=new EVUI.Modules.Dom.DomHelper(n.link.pane.element),t=i.attr("style"),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!1&&t!=="display: inline-block;"&&t!==n.link.inlinedStyle)?!0:(t=i.attr("style",n.link.inlinedStyle),!0)},bi=function(n,t){for(var f,u=ki(),e=u.length,r=0;r<e;r++)(t!==!0||u[r]!==EVUI.Modules.Panes.Constants.CSS_Pane_Style)&&(f=w(n,u[r]),f!=null)&&i.stylesheetManager.removeRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,f)},ni=function(n,t){for(var r,u=ki(),o=u.length,f=[],e=new EVUI.Modules.Dom.DomHelper(n.link.pane.element),i=0;i<o;i++)(t!==!0||u[i]!==EVUI.Modules.Panes.Constants.CSS_Pane_Style)&&(r=u[i],e.hasClass(r)===!0&&(f.push(r),e.removeClass(r)));return f},w=function(n,t){var i,r;if(t==null||n==null)return null;EVUI.Modules.Core.Utils.isArray(t)===!1&&(t=[t]);var u=!1,f="."+n.link.paneCSSName,e=t.length;for(i=0;i<e;i++)(r=t[i],typeof r=="string")&&(f+="."+r.trim(),u=!0);return u===!1?null:f},ki=function(){return[EVUI.Modules.Panes.Constants.CSS_Pane_Style,EVUI.Modules.Panes.Constants.CSS_Position,EVUI.Modules.Panes.Constants.CSS_ScrollX,EVUI.Modules.Panes.Constants.CSS_ScrollY,EVUI.Modules.Panes.Constants.CSS_ClippedX,EVUI.Modules.Panes.Constants.CSS_ClippedY,EVUI.Modules.Panes.Constants.CSS_Flipped,EVUI.Modules.Panes.Constants.CSS_Transition_Show,EVUI.Modules.Panes.Constants.CSS_Transition_Hide,EVUI.Modules.Panes.Constants.CSS_Transition_Adjust,EVUI.Modules.Panes.Constants.CSS_Resized,EVUI.Modules.Panes.Constants.CSS_Moved]},bf=function(n,t,i,r,u){var s;typeof u!="function"&&(u=function(){});i.mode===EVUI.Modules.Panes.PaneShowMode.DocumentFlow?kf(n,t,i):df(n);var f=n.link.pane.showSettings==null?{}:n.link.pane.showSettings,e=null,o=null;r===!0?(f.reclacSettings!=null&&f.reclacSettings.recalcTransition!=null&&(o=f.reclacSettings.recalcTransition),e=EVUI.Modules.Panes.Constants.CSS_Transition_Adjust):(t.showTransition!=null&&(o=t.showTransition),e=EVUI.Modules.Panes.Constants.CSS_Transition_Show);s=new EVUI.Modules.Dom.DomHelper(n.link.pane.element);ce(n,t);pt(n,o,e,s,function(n){n===!1&&s.show();u(!0)})},kf=function(n,t){var i=n.link.pane.element,r=new EVUI.Modules.Dom.DomHelper(t.documentFlow.relativeElement);t.documentFlow.mode!==EVUI.Modules.Panes.PaneDocumentFlowMode.Current&&(t.documentFlow.mode===EVUI.Modules.Panes.PaneDocumentFlowMode.After?i.previousSibling!==r.elements[0]&&(i.remove(),r.insertAfter(i)):t.documentFlow.mode===EVUI.Modules.Panes.PaneDocumentFlowMode.Append?i.parentNode!==r.elements[0]&&(i.remove(),r.append(i)):t.documentFlow.mode===EVUI.Modules.Panes.PaneDocumentFlowMode.Before?i.nextSibling!==r.elements[0]&&(i.remove(),r.insertAfter(i)):t.documentFlow.mode===EVUI.Modules.Panes.PaneDocumentFlowMode.Prepend?i.parentNode!==r.elements[0]&&(i.remove(),r.prepend(i)):i.parentNode!==r.elements[0]&&(i.remove(),r.append(i)))},df=function(n){di();n.link.pane.element!=null&&n.link.pane.element.parentNode!==s&&(n.link.pane.element.remove(),s.appendChild(n.link.pane.element))},gf=function(n){gi();n.link.pane.element!=null&&n.link.pane.element.parentNode!==h&&(n.link.pane.element.remove(),h.appendChild(n.link.pane.element))},ft=function(n){ht();n.link.pane.element!=null&&(n.link.pane.element.remove(),a.appendChild(n.link.pane.element))},di=function(){s==null?(s=document.createElement("div"),document.body.appendChild(s)):s.parentElement!=document.body&&(s.remove(),document.body.appendChild(s));s.style.height="0px";s.style.width="0px";s.style.overflow="visible";s.style.display="block"},ht=function(){a==null?(a=document.createElement("div"),document.body.appendChild(a)):a.parentElement!=document.body&&(a.remove(),document.body.appendChild(a));a.style.display="none"},gi=function(){h==null?(h=document.createElement("div"),document.body.appendChild(h)):h.parentElement!=document.body&&(h.remove(),document.body.appendChild(h));h.style.height="0px";h.style.width="0px";h.style.overflow="hidden";h.style.display="inline-block"},nr=function(n,t,i){if(n.link.pane.element==null)throw Error("Cannot calculate position of a Pane without an element.");if(n.link.pane.element.isConnected===!1)throw Error("Cannot calculate position of a Pane that is not yet part of the DOM.");var r=new EVUI.Modules.Panes.PanePosition(i),u=new EVUI.Modules.Dom.DomHelper(n.link.pane.element);if(i===EVUI.Modules.Panes.PaneShowMode.AbsolutePosition)r=ne(n,u,t.absolutePosition);else if(i===EVUI.Modules.Panes.PaneShowMode.Anchored)r=te(n,u,t.anchors);else if(i===EVUI.Modules.Panes.PaneShowMode.RelativePosition)r=ti(n,u,t.relativePosition);else if(i===EVUI.Modules.Panes.PaneShowMode.Fullscreen)r=re();else if(i===EVUI.Modules.Panes.PaneShowMode.PositionClass)r=ue(t,u);else if(i===EVUI.Modules.Panes.PaneShowMode.Centered)r=fe(u);else if(i===EVUI.Modules.Panes.PaneShowMode.DocumentFlow)return r;return(r=er(n,r,t.clipSettings,t),r==null)?null:(r.classNames.push(EVUI.Modules.Panes.Constants.CSS_Position),r.classNames.push(n.link.paneCSSName),r.zIndex=tr(n),EVUI.Modules.Panes.Constants.GlobalZIndex=r.zIndex,r)},tr=function(n){for(var f,r,t=EVUI.Modules.Panes.Constants.GlobalZIndex,u=n!=null?n.link.pane.getCurrentZIndex():-1,o=e.length,i=0;i<o;i++)f=e[i],r=f.link.pane.getCurrentZIndex(),r>t&&(t=r);return t===u?u:t+1},ne=function(n,t,i){var u=t.offset(),r=new EVUI.Modules.Panes.PanePosition(EVUI.Modules.Panes.PaneShowMode.AbsolutePosition);return r.left=i.left,r.top=i.top,r.bottom=u.bottom-u.top+r.top,r.right=u.right-u.left+r.left,r},te=function(n,t,i){var r=new EVUI.Modules.Panes.PanePosition(EVUI.Modules.Panes.PaneShowMode.Anchored),l=t.offset(),c=l.bottom-l.top,h=l.right-l.left,a=ir(i.alignX,"x"),v=ir(i.alignY,"y"),u=null,s,o,e,f,d,w,b,k,y,p;i.top!=null&&(f=new EVUI.Modules.Dom.DomHelper(i.top),f.elements.length>0&&(f.elements[0].isConnected===!0||f.elements[0]===window)&&(u=f.offset(),(f.elements[0]===window||f.elements[0]===document)&&(u.bottom=u.top)));s=null;i.bottom!=null&&(f=new EVUI.Modules.Dom.DomHelper(i.bottom),f.elements.length>0&&(f.elements[0].isConnected===!0||f.elements[0]===window)&&(s=f.offset(),(f.elements[0]===window||f.elements[0]===document)&&(u.top=u.bottom)));o=null;i.left!=null&&(f=new EVUI.Modules.Dom.DomHelper(i.left),f.elements.length>0&&(f.elements[0].isConnected===!0||f.elements[0]===window)&&(o=f.offset(),(f.elements[0]===window||f.elements[0]===document)&&(u.right=u.left)));e=null;i.right!=null&&(f=new EVUI.Modules.Dom.DomHelper(i.right),f.elements.length>0&&(f.elements[0].isConnected===!0||f.elements[0]===window)&&(e=f.offset(),(f.elements[0]===window||f.elements[0]===document)&&(u.left=u.right)));u!=null&&s!=null&&u.top>s.top&&(d=s,s=u,u=d);e!=null&&o!=null&&o.left>e.left&&(d=e,e=o,o=d);w=0;u!=null&&(w|=1);s!=null&&(w|=2);o!=null&&(w|=4);e!=null&&(w|=8);switch(w){case 0:r.top=0;r.left=0;r.right=h;r.bottom=c;break;case 1:r.top=u.bottom;r.bottom=u.bottom+c;b=ct(u,l,h,a);r.left=b.left;r.right=b.right;break;case 2:r.bottom=s.top;r.top=s.top-c;b=ct(s,l,h,a);r.left=b.left;r.right=b.right;break;case 3:if(r.bottom=s.top,r.top=u.bottom,y=ct(u,l,h,a),p=ct(s,l,h,a),a===EVUI.Modules.Panes.AnchorAlignment.Left)r.left=Math.min(y.left,p.left),r.right=r.left+h;else if(a===EVUI.Modules.Panes.AnchorAlignment.Right)r.right=Math.max(y.right,p.right),r.left=r.right-h;else if(a===EVUI.Modules.Panes.AnchorAlignment.Center){var g=Math.min(y.left,p.left),nt=Math.max(y.right,p.right),tt=nt-g,it=g+tt/2;r.left=it-h/2;r.right=r.left+h}else a===EVUI.Modules.Panes.AnchorAlignment.None?(r.left=l.left,r.right=l.right):(r.left=Math.min(y.left,p.left),r.right=Math.max(y.right,p.right));break;case 4:r.left=o.right;r.right=r.left+h;k=lt(o,l,c,v);r.top=Math.max(k.top,o.top);r.bottom=k.bottom;break;case 5:r.top=u.bottom;r.bottom=v===EVUI.Modules.Panes.AnchorAlignment.Elastic?o.bottom:r.top+c;r.left=o.right;r.right=a===EVUI.Modules.Panes.AnchorAlignment.Elastic?u.right:r.right+h;break;case 6:r.top=v===EVUI.Modules.Panes.AnchorAlignment.Elastic?o.top:s.top-c;r.bottom=o.bottom;r.left=o.right;r.right=a===EVUI.Modules.Panes.AnchorAlignment.Elastic?s.right:r.right+h;break;case 7:r.top=u.bottom;r.left=o.right;r.bottom=s.top;r.right=a===EVUI.Modules.Panes.AnchorAlignment.Elastic?Math.max(u.right,s.right):r.left+h;break;case 8:r.right=e.left;r.left=r.right-h;k=lt(e,l,c,v);r.top=Math.max(k.top,e.top);r.bottom=k.bottom;break;case 9:r.right=e.left;r.left=a===EVUI.Modules.Panes.AnchorAlignment.Elastic?u.left:r.right-h;r.top=u.bottom;r.bottom=v===EVUI.Modules.Panes.AnchorAlignment.Elastic?e.bottom:r.top+c;break;case 10:r.right=e.left;r.left=a===EVUI.Modules.Panes.AnchorAlignment.Elastic?s.left:e.left-h;r.top=s.top-c;r.bottom=v===EVUI.Modules.Panes.AnchorAlignment.Elastic?r.top-c:e.bottom;break;case 11:r.top=u.bottom;r.right=e.left;r.bottom=s.top;r.left=a===EVUI.Modules.Panes.AnchorAlignment.Elastic?Math.min(u.left,s.left):e.left-h;break;case 12:if(r.left=o.right,r.right=e.left,y=lt(o,l,h,v),p=lt(e,l,h,v),v===EVUI.Modules.Panes.AnchorAlignment.Top)r.top=Math.min(y.top,p.top),r.bottom=r.top+c;else if(v===EVUI.Modules.Panes.AnchorAlignment.Bottom)r.top=Math.min(y.bottom,p.bottom)-c,r.bottom=r.top-c;else if(v===EVUI.Modules.Panes.AnchorAlignment.Center){var g=Math.min(y.top,p.top),nt=Math.max(y.bottom,p.bottom),tt=nt-g,it=g+tt/2;r.top=it-c/2;r.bottom=r.bottom+c}else v===EVUI.Modules.Panes.AnchorAlignment.None?(r.top=Math.max(l.top,Math.min(e.top,o.top)),r.bottom=l.bottom):(r.top=Math.min(y.top,p.top),r.bottom=Math.max(y.bottom,p.bottom));break;case 13:r.top=u.bottom;r.bottom=v===EVUI.Modules.Panes.AnchorAlignment.Elastic?Math.max(o.bottom,e.bottom):r.top+c;r.left=o.right;r.right=e.left;break;case 14:r.top=v===EVUI.Modules.Panes.AnchorAlignment.Elastic?Math.min(o.top,e.top):s.top-c;r.bottom=s.top;r.left=o.right;r.right=e.left;break;case 15:r.top=u.bottom;r.bottom=s.top;r.left=o.right;r.right=e.left}return r},ir=function(n,t){if(typeof n!="string")return t==="x"?EVUI.Modules.Panes.AnchorAlignment.Left:EVUI.Modules.Panes.AnchorAlignment.Top;n=n.toLowerCase();switch(n){case EVUI.Modules.Panes.AnchorAlignment.Bottom:case EVUI.Modules.Panes.AnchorAlignment.Top:return t==="x"?EVUI.Modules.Panes.AnchorAlignment.Left:n;case EVUI.Modules.Panes.AnchorAlignment.Left:case EVUI.Modules.Panes.AnchorAlignment.Right:return t==="y"?EVUI.Modules.Panes.AnchorAlignment.Top:n;case EVUI.Modules.Panes.AnchorAlignment.Center:case EVUI.Modules.Panes.AnchorAlignment.Elastic:case EVUI.Modules.Panes.AnchorAlignment.None:return n;default:return t==="x"?EVUI.Modules.Panes.AnchorAlignment.Left:EVUI.Modules.Panes.AnchorAlignment.Top}},ct=function(n,t,i,r){var u=new EVUI.Modules.Dom.ElementBounds,f;return r===EVUI.Modules.Panes.AnchorAlignment.Left?(u.left=n.left,u.right=n.left+i):r===EVUI.Modules.Panes.AnchorAlignment.Right?(u.left=n.right-i,u.right=n.right):r===EVUI.Modules.Panes.AnchorAlignment.Center?(f=n.left+(n.right-n.left)/2,u.left=f-i/2,u.right=u.left+i):r===EVUI.Modules.Panes.AnchorAlignment.None?(u.left=t.left,u.right=t.right):(u.left=n.left,u.right=n.right),u},lt=function(n,t,i,r){var u=new EVUI.Modules.Dom.ElementBounds,f;return r===EVUI.Modules.Panes.AnchorAlignment.Top?(u.top=n.top,u.bottom=n.top-i):r===EVUI.Modules.Panes.AnchorAlignment.Bottom?(u.top=n.bottom-i,u.bottom=n.bottom):r===EVUI.Modules.Panes.AnchorAlignment.Center?(f=n.bottom-(n.bottom-n.top)/2,u.top=f-i/2,u.bottom=u.top+i):r===EVUI.Modules.Panes.AnchorAlignment.None?(u.top=t.top,u.bottom=t.bottom):(u.top=n.top,u.bottom=n.bottom),u},ti=function(n,t,i){var u=new EVUI.Modules.Panes.PanePosition(EVUI.Modules.Panes.PaneShowMode.RelativePosition),f=t.offset(),h=f.right-f.left,c=f.bottom-f.top,r=null,e;if(i.relativeElement!=null){if(e=new EVUI.Modules.Dom.DomHelper(i.relativeElement),e.elements.length===0||e.elements[0].isConnected===!1)return null;r=e.offset()}else r=new EVUI.Modules.Dom.ElementBounds,r.left=i.left,r.top=i.top,r.right=i.left,r.bottom=i.top;var l=ur(i),o=l.xOrientation,s=l.yOrientation;return o===EVUI.Modules.Panes.RelativePositionOrientation.Right?(u.left=r.right,u.right=r.right+h):o===EVUI.Modules.Panes.RelativePositionOrientation.Left&&(u.left=r.left-h,u.right=r.left),s===EVUI.Modules.Panes.RelativePositionOrientation.Bottom?(u.top=r.bottom,u.bottom=r.bottom+c):s===EVUI.Modules.Panes.RelativePositionOrientation.Top&&(u.top=r.top-c,u.bottom=r.top),ie(r,u,i,o,s)},ie=function(n,t,i,r,u){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.alignment)===!0)return t;var f=n.bottom-n.top,e=n.right-n.left;switch(i.alignment.toLowerCase()){case EVUI.Modules.Panes.RelativePositionAlignment.Bottom:u===EVUI.Modules.Panes.RelativePositionOrientation.Top&&(t.top+=f,t.bottom+=f);break;case EVUI.Modules.Panes.RelativePositionAlignment.YCenter:u===EVUI.Modules.Panes.RelativePositionOrientation.Bottom?(t.top-=f/2,t.bottom-=f/2):u===EVUI.Modules.Panes.RelativePositionOrientation.Top&&(t.top+=f/2,t.bottom+=f/2);break;case EVUI.Modules.Panes.RelativePositionAlignment.Top:u===EVUI.Modules.Panes.RelativePositionOrientation.Bottom&&(t.top-=f,t.bottom-=f);break;case EVUI.Modules.Panes.RelativePositionAlignment.Left:r===EVUI.Modules.Panes.RelativePositionAlignment.Right&&(t.left-=e,t.right-=e);break;case EVUI.Modules.Panes.RelativePositionAlignment.XCenter:r===EVUI.Modules.Panes.RelativePositionAlignment.Right?(t.left-=e/2,t.right-=e/2):r===EVUI.Modules.Panes.RelativePositionOrientation.Left&&(t.left+=e/2,t.right+=e/2);break;case EVUI.Modules.Panes.RelativePositionAlignment.Right:r===EVUI.Modules.Panes.RelativePositionOrientation.Left&&(t.left+=e,t.right+=e)}return t},rr=function(n){if(n==null)return null;var n=n.toLowerCase();switch(n){case EVUI.Modules.Panes.RelativePositionOrientation.Bottom:case EVUI.Modules.Panes.RelativePositionOrientation.Top:return"y";case EVUI.Modules.Panes.RelativePositionOrientation.Left:case EVUI.Modules.Panes.RelativePositionOrientation.Right:return"x"}return null},ur=function(n){var t=EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.orientation)==!1?n.orientation.toLowerCase().trim().split(/\s+/):["right","bottom"],r=rr(t[0])==="x"?t[0]:t[1],i;return r==null&&(r=EVUI.Modules.Panes.RelativePositionOrientation.Right),i=rr(t[1])==="y"?t[1]:t[0],i==null&&(i=EVUI.Modules.Panes.RelativePositionOrientation.Bottom),{xOrientation:r,yOrientation:i}},re=function(){var n=new EVUI.Modules.Panes.PanePosition(EVUI.Modules.Panes.PaneShowMode.Fullscreen),t=new EVUI.Modules.Dom.DomHelper(window),i=t.outerWidth(),r=t.outerHeight();return n.top=window.scrollY,n.left=window.scrollX,n.bottom=n.top+r,n.right=n.left+i,n},ue=function(n,t){var u=fr(n.positionClass),f=u.concat([EVUI.Modules.Panes.Constants.CSS_Position,entry.link.paneCSSName]),i=new EVUI.Modules.Panes.PanePosition(EVUI.Modules.Panes.PaneShowMode.PositionClass),r;return t.addClass(f),r=t.offset(),i.bottom=r.bottom,i.left=r.left,i.right=r.right,i.top=r.top,i.classNames=u,t.removeClass(f),i},fe=function(n){var u=new EVUI.Modules.Dom.DomHelper(window),o=u.outerWidth(),s=u.outerHeight(),i=n.offset(),h=i.right-i.left,c=i.bottom-i.top,r=h/2,l=c/2,f=o/2,e=s/2,t=new EVUI.Modules.Panes.PanePosition(EVUI.Modules.Panes.PaneShowMode.Centered);return t.left=f-r,t.right=f+r,t.top=e-l,t.bottom=e+r,t},at=function(n){return n==null?EVUI.Modules.Panes.PaneShowMode.None:n.positionClass!=null&&(typeof n.positionClass=="string"&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.positionClass)===!1||EVUI.Modules.Core.Utils.isArray(n.positionClass)===!0&&n.positionClass.filter(function(n){return typeof n=="string"}).length>0)?EVUI.Modules.Panes.PaneShowMode.PositionClass:n.absolutePosition!=null&&(n.absolutePosition.left!==0||n.absolutePosition.top!==0)?EVUI.Modules.Panes.PaneShowMode.AbsolutePosition:n.relativePosition!=null&&(n.relativePosition.relativeElement!=null&&n.relativePosition.relativeElement.isConnected===!0||n.relativePosition.left!==0||n.relativePosition.top!==0)?EVUI.Modules.Panes.PaneShowMode.RelativePosition:n.anchors!=null&&(n.anchors.bottom!=null&&(n.anchors.bottom.isConnected===!0||n.anchors.bottom===window)||n.anchors.left!=null&&(n.anchors.left.isConnected===!0||n.anchors.left===window)||n.anchors.right!=null&&(n.anchors.right.isConnected===!0||n.anchors.right===window)||n.anchors.top!=null&&(n.anchors.top.isConnected===!0||n.anchors.top===window))?EVUI.Modules.Panes.PaneShowMode.Anchored:n.documentFlow!=null&&n.documentFlow.relativeElement!=null?EVUI.Modules.Panes.PaneShowMode.DocumentFlow:n.fullscreen===!0?EVUI.Modules.Panes.PaneShowMode.Fullscreen:n.center===!0?EVUI.Modules.Panes.PaneShowMode.Centered:EVUI.Modules.Panes.PaneShowMode.None},fr=function(n){var t=[],r,i;if(EVUI.Modules.Core.Utils.isArray(n)===!0)for(r=n.length,i=0;i<r;i++)t=t.concat(fr(n[i]));else typeof n=="string"&&(t=n.split(/\s+/));return t},er=function(n,t,i,r,u){var e,f;return(u==null&&(u=[]),u.push(i),e=new EVUI.Modules.Dom.DomHelper(window),i==null&&(i=new EVUI.Modules.Panes.PaneClipSettings),f=et(i),(i.fallbackClipSettings==null||u.indexOf(i.fallbackClipSettings)!==-1)&&(i.fallbackClipSettings=new EVUI.Modules.Panes.PaneClipSettings,i.fallbackClipSettings.clipBounds=null,i.fallbackClipSettings.mode=EVUI.Modules.Panes.PaneClipMode.Clip,i.fallbackClipSettings.scrollXWhenClipped=!0,i.fallbackClipSettings.scrollYWhenClipped=!0),i.mode=ee(i.mode),i.mode===EVUI.Modules.Panes.PaneClipMode.Clip)?ii(t)===!0?null:ri(n,t,f,i):i.mode===EVUI.Modules.Panes.PaneClipMode.Shift?ii(f)===!0?null:or(n,t,f,i,r,u):i.mode===EVUI.Modules.Panes.PaneClipMode.Overflow?t:void 0},ii=function(n,t){return t==null&&(t=new EVUI.Modules.Dom.DomHelper(window).offset()),b(n.left,n.top,t)===!1&&b(n.right,n.top,t)===!1&&b(n.left,n.bottom,t)===!1&&b(n.right,n.bottom,t)===!1},b=function(n,t,i){return n<i.left||n>i.right?!1:t<i.top||t>i.bottom?!1:!0},ri=function(n,t,r,u){var h=t.right-t.left,c=t.bottom-t.top,e=!1,o,s,l,a;return f(t,r,"left")===!0&&(t.left=r.left,e=!0),f(t,r,"right")===!0&&(t.right=r.right,e=!0),f(t,r,"top")===!0&&(t.top=r.top,e=!0),f(t,r,"bottom")===!0&&(t.bottom=r.bottom,e=!0),e===!0&&(o=t.right-t.left,s=t.bottom-t.top,o!==h&&(t.classNames.push(EVUI.Modules.Panes.Constants.CSS_ClippedX),u.scrollXWhenClipped===!0&&o<h&&(t.classNames.push(EVUI.Modules.Panes.Constants.CSS_ScrollX),l=w(n,EVUI.Modules.Panes.Constants.CSS_ClippedX),i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,l,{overflowX:"scroll"}))),s!==c&&(t.classNames.push(EVUI.Modules.Panes.Constants.CSS_ClippedY),u.scrollYWhenClipped===!0&&(s<c&&t.classNames.push(EVUI.Modules.Panes.Constants.CSS_ScrollY),a=w(n,EVUI.Modules.Panes.Constants.CSS_ClippedY),i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,a,{overflowY:"scroll"})))),t},or=function(n,t,i,r,u,e){var h=!1,c=!1,o=0,l=t.mode===EVUI.Modules.Panes.PaneShowMode.RelativePosition,s=EVUI.Modules.Core.Utils.shallowExtend({},t),a;return(delete s.mode,s.classNames=t.classNames.slice(),s=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.Panes.PanePosition(t.mode),s),f(t,i,"left")===!0&&(o=i.left-t.left,t.left+=o,t.right+=o,h=!0,l===!0&&vt(t,i)===!0))?it(n,s,i,r,u,e):f(t,i,"right")===!0&&h===!1&&(o=t.right-i.right,t.right-=o,t.left-=o,h=!0,l===!0&&vt(t,i)===!0)?it(n,s,i,r,u,e):f(t,i,"top")===!0&&(o=i.top-t.top,t.top+=o,t.bottom+=o,c=!0,l===!0&&vt(t,i)===!0)?it(n,s,i,r,u,e):f(t,i,"bottom")===!0&&c===!1&&(o=t.bottom-i.bottom,t.bottom-=o,t.top-=o,c=!0,l===!0&&vt(t,i)===!0)?it(n,s,i,r,u,e):t.mode===EVUI.Modules.Panes.PaneShowMode.Fullscreen&&(h===!0||c===!0)?(a=new EVUI.Modules.Dom.DomHelper(window).offset(),ri(n,t,a,r.fallbackClipSettings)):t},l={None:0,FlippedX:1,FlippedY:2,ReAligned:4},it=function(n,t,i,r,u,e,o){var nt,tt;o==null&&(o=0);var y=!1,p=!1,rt=ur(u.relativePosition),w=null,b=null,k=rt.xOrientation,d=rt.yOrientation,g=!1,s=null;if(u.relativePosition.relativeElement!=null){if(nt=new EVUI.Modules.Dom.DomHelper(u.relativePosition.relativeElement),nt.elements.length===0||nt.elements[0].isConnected===!1)return null;s=nt.offset()}else s=new EVUI.Modules.Dom.ElementBounds,s.top=u.relativePosition.top,s.left=u.relativePosition.left,s.right=u.relativePosition.top,s.bottom=u.relativePosition.left;if(ii(s))return null;if(f(t,i,"right")===!0&&(EVUI.Modules.Core.Utils.hasFlag(o,l.FlippedX)===!0?g=!0:(k===EVUI.Modules.Panes.RelativePositionOrientation.Left?(w=EVUI.Modules.Panes.RelativePositionOrientation.Right,y=!0):k===EVUI.Modules.Panes.RelativePositionOrientation.Right&&(w=EVUI.Modules.Panes.RelativePositionOrientation.Left,y=!0),o|=l.FlippedX)),f(t,i,"left")===!0&&(EVUI.Modules.Core.Utils.hasFlag(o,l.FlippedX)===!0?g=!0:(k===EVUI.Modules.Panes.RelativePositionOrientation.Right?(w=EVUI.Modules.Panes.RelativePositionOrientation.Left,y=!0):k===EVUI.Modules.Panes.RelativePositionOrientation.Left&&(w=EVUI.Modules.Panes.RelativePositionOrientation.Right,y=!0),o|=l.FlippedX)),f(t,i,"top")===!0&&(EVUI.Modules.Core.Utils.hasFlag(o,l.FlippedY)===!0?g=!0:(d===EVUI.Modules.Panes.RelativePositionOrientation.Bottom?(b=EVUI.Modules.Panes.RelativePositionOrientation.Top,p=!0):d===EVUI.Modules.Panes.RelativePositionOrientation.Top&&(b=EVUI.Modules.Panes.RelativePositionOrientation.Bottom,p=!0),o|=l.FlippedY)),f(t,i,"bottom")===!0&&(EVUI.Modules.Core.Utils.hasFlag(o,l.FlippedY)===!0?g=!0:(d===EVUI.Modules.Panes.RelativePositionOrientation.Top?(b=EVUI.Modules.Panes.RelativePositionOrientation.Bottom,p=!0):d===EVUI.Modules.Panes.RelativePositionOrientation.Bottom&&(b=EVUI.Modules.Panes.RelativePositionOrientation.Top,p=!0),o|=l.FlippedY)),y===!0||p===!0)return(tt=y===!0?w:k,tt+=" "+(p===!0?b:d),u.relativePosition.orientation=tt,t=ti(n,new EVUI.Modules.Dom.DomHelper(n.link.pane.element),u.relativePosition,i),t==null)?null:it(n,t,i,r,u,e,o);if(EVUI.Modules.Core.Utils.hasFlag(o,l.ReAligned)===!0)return t.classNames.push(EVUI.Modules.Panes.Constants.CSS_Flipped),t;if(g===!0){var h=s.top-i.top,c=i.bottom-s.bottom,a=s.left-i.left,v=i.right-s.right,ut=t.right-t.left,ft=t.bottom-t.top,et=h<ft&&c<ft&&a<ut&&v<ut;if(h>a&&h>v||c>a&&c>v)c>=h?(u.relativePosition.orientation=EVUI.Modules.Panes.RelativePositionOrientation.Bottom+" "+(a>=v?EVUI.Modules.Panes.RelativePositionOrientation.Left:EVUI.Modules.Panes.RelativePositionAlignment.Right),u.relativePosition.alignment=a>=v?EVUI.Modules.Panes.RelativePositionAlignment.Rignt:EVUI.Modules.Panes.RelativePositionAlignment.Left):(u.relativePosition.orientation=EVUI.Modules.Panes.RelativePositionOrientation.Top+" "+(a>=v?EVUI.Modules.Panes.RelativePositionOrientation.Left:EVUI.Modules.Panes.RelativePositionAlignment.Right),u.relativePosition.alignment=a>=v?EVUI.Modules.Panes.RelativePositionAlignment.Right:EVUI.Modules.Panes.RelativePositionAlignment.Left);else if(a>h&&a>c||v>h&&v>c)a>=v?(u.relativePosition.orientation=(h>=c?EVUI.Modules.Panes.RelativePositionOrientation.Top:EVUI.Modules.Panes.RelativePositionAlignment.Bottom)+" "+EVUI.Modules.Panes.RelativePositionOrientation.Left,u.relativePosition.alignment=h>=c?EVUI.Modules.Panes.RelativePositionAlignment.Bottom:EVUI.Modules.Panes.RelativePositionAlignment.Top):(u.relativePosition.orientation=(h>=c?EVUI.Modules.Panes.RelativePositionOrientation.Top:EVUI.Modules.Panes.RelativePositionAlignment.Bottom)+" "+EVUI.Modules.Panes.RelativePositionOrientation.Right,u.relativePosition.alignment=h>=c?EVUI.Modules.Panes.RelativePositionAlignment.Bottom:EVUI.Modules.Panes.RelativePositionAlignment.Top);else return er(n,t,r.fallbackClipSettings,u,e);return(o|=l.ReAligned,t=ti(n,new EVUI.Modules.Dom.DomHelper(n.link.pane.element),u.relativePosition,i),t==null)?null:(t=it(n,t,i,r,u,e,o),ri(n,t,i,r))}return EVUI.Modules.Core.Utils.hasFlag(o,l.FlippedX)===!0||EVUI.Modules.Core.Utils.hasFlag(o,l.FlippedY)===!0?(t.classNames.push(EVUI.Modules.Panes.Constants.CSS_Flipped),t):t},vt=function(n,t){return b(n.left,n.top,t)===!0?!0:b(n.left,n.bottom,t)===!0?!0:b(n.right,n.top,t)===!0?!0:b(n.right,n.bottom,t)===!0?!0:!1},ee=function(n){if(typeof n!="string")return EVUI.Modules.Panes.PaneClipMode.Shift;n=n.toLowerCase();switch(n){case EVUI.Modules.Panes.PaneClipMode.Clip:case EVUI.Modules.Panes.PaneClipMode.Overflow:case EVUI.Modules.Panes.PaneClipMode.Shift:return n;default:return EVUI.Modules.Panes.PaneClipMode.Shift}},f=function(n,t,i){if(i==="top"){if(n.top<t.top)return!0}else if(i==="bottom"){if(n.bottom>t.bottom)return!0}else if(i==="left"){if(n.left<t.left)return!0}else if(i==="right"&&n.right>t.right)return!0;return!1},et=function(n){if(n==null)return null;var i=new EVUI.Modules.Dom.DomHelper(window),t=new EVUI.Modules.Dom.ElementBounds;return n.clipBounds==null?(t.left=window.scrollX,t.right=scrollX+i.outerWidth(),t.top=window.scrollY,t.bottom=window.scrollY+i.outerHeight()):EVUI.Modules.Core.Utils.isElement(n.clipBounds)===!0||typeof n.clipBounds=="string"?t=new EVUI.Modules.Dom.DomHelper(n.clipBounds).offset():(t.left=typeof n.clipBounds.left!="number"?window.scrollX:n.clipBounds.left,t.right=typeof n.clipBounds.right!="number"?window.scrollY:n.clipBounds.right,t.bottom=typeof n.clipBounds.bottom!="number"?window.scrollY+i.outerHeight():n.clipBounds.bottom,t.top=typeof n.clipBounds.top!="number"?scrollX+i.outerWidth():n.clipBounds.top),t},oe=function(n,t,r,u,e,o){var a,v,y,c,p,b,g,nt,tt,it,l;typeof o!="function"&&(o=function(){});t=dt(n,t);var k=w(n,EVUI.Modules.Panes.Constants.CSS_Resized),d=getComputedStyle(n.link.pane.element),s=d.minWidth,h=d.minHeight;s!=null&&(s=parseFloat(s.replace("px","")),isNaN(s)===!0&&(s=null));h!=null&&(h=parseFloat(h.replace("px","")),isNaN(h)===!0&&(h=null));a=n.link.pane.resizeMoveSettings.dragHanldeMargin*2.5;(s==null||s<a)&&(s=a);(h==null||h<a)&&(h=a);v=!1;y=!1;e!=null&&(c=new EVUI.Modules.Panes.PanePosition,c.bottom=t.bottom,c.left=t.left,c.right=t.right,c.top=t.top,f(c,e,"left")===!0&&(t.left=e.left),f(c,e,"right")===!0&&(t.right=e.right),f(c,e,"top")===!0&&(t.top=e.top),f(c,e,"bottom")===!0&&(t.bottom=e.bottom));p=t.getResizedHeight();b=t.getResizedWidth();(h>p||s>b)&&n.link.lastResizeArgs!=null&&(h>p&&(t.top=u!=null?u.originalBounds.top:n.link.lastResizeArgs.top,t.bottom=t.top+h,y=!0),s>b&&(t.left=u!=null?u.originalBounds.left:n.link.lastResizeArgs.left,t.right=t.left+s,v=!0));u!=null&&n.link.lastResizeArgs!=null&&(u.growX==="left"&&(g=t.right,nt=n.link.lastResizeArgs.right,g!=nt&&(t.left=u.originalBounds.left,t.right=u.originalBounds.right,v===!0&&(t.left=u.originalBounds.right-s,t.right=t.left+s))),u.growY==="top"&&(tt=t.bottom,it=n.link.lastResizeArgs.bottom,tt!=it&&(t.top=u.originalBounds.top,t.bottom=u.originalBounds.bottom,y===!0&&(t.top=u.originalBounds.bottom-h,t.bottom=t.top+h))));l={};l.position="absolute";l.height=t.getResizedHeight()+"px";l.width=t.getResizedWidth()+"px";l.top=t.top+"px";l.left=t.left+"px";i.stylesheetManager.removeRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,k);i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,k,l);r.addClass(EVUI.Modules.Panes.Constants.CSS_Resized);n.link.lastResizeArgs=dt(n,t);pt(n,t.transition,EVUI.Modules.Panes.Constants.CSS_Transition_Resize,r,function(){o()})},se=function(n,t,r,u,f,e){var o,s,h;if(typeof e!="function"&&(e=function(){}),t=ci(n,t),f!=null&&(o=he(n,t,f),o!=null)){if(o.left===t.left&&o.top===t.top)return;t.left=o.left;t.top=o.top}s=w(n,EVUI.Modules.Panes.Constants.CSS_Moved);h={position:"absolute",top:t.top+"px",left:t.left+"px"};i.stylesheetManager.removeRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,s);i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,s,h);r.addClass(EVUI.Modules.Panes.Constants.CSS_Moved);pt(n,t.transition,EVUI.Modules.Panes.Constants.CSS_Transition_Move,r,function(){e()})},he=function(n,t,i){var r=new EVUI.Modules.Panes.PanePosition(EVUI.Modules.Panes.PaneShowMode.AbsolutePosition),u;return(r.top=t.top,r.left=t.left,r.bottom=t.top+t.height,r.right=t.left+t.width,u=new EVUI.Modules.Observers.ObjectObserver(r),or(n,r,i),u.getChanges().length>0)?r:null},sr=function(n){for(var i=n.link.eventBindings.length,t=0;t<i;t++)n.link.eventBindings[t].detach();n.link.eventBindings=[]},ce=function(n,t){if(n.link.pane.element!=null){sr(n);le(n,t);ae(n,t);ve(n,t);pe(n,t);var i=ai(n.link.pane.resizeMoveSettings);ye(n,i);we(n,i)}},le=function(n){var i,r;if(n.link.pane.element!=null){var u=o(EVUI.Modules.Panes.Constants.Attribute_Close),f=new EVUI.Modules.Dom.DomHelper("["+u+"]",n.link.pane.element),e=f.elements.length;for(i=0;i<e;i++)r=new EVUI.Modules.Panes.PaneEventBinding(u,"click",f.elements[i],function(i){if(n.link.pane.autoHideSettings!=null&&(typeof n.link.pane.autoHideSettings.autoHideFilter!="function"||n.link.pane.autoHideSettings.autoHideFilter(r)!==!1)){var r=new EVUI.Modules.Panes.PaneAutoTriggerContext;r.triggerType=EVUI.Modules.Panes.PaneAutoTriggerType.Click;r.event=i;r.pane=n.link.pane;t.hidePane(n.paneId,{context:r});i.stopPropagation()}}),r.attach(),n.link.eventBindings.push(r)}},ae=function(n){var r,i;n.link.pane.element!=null&&n.link.pane.autoHideSettings!=null&&(r=li(n.link.pane.autoHideSettings),r.hideMode===EVUI.Modules.Panes.PaneHideMode.Click?(i=new EVUI.Modules.Panes.PaneEventBinding(EVUI.Modules.Panes.PaneHideMode.Click,"click contextmenu",document,function(u){var f=new EVUI.Modules.Panes.PaneAutoTriggerContext;f.triggerType=EVUI.Modules.Panes.PaneAutoTriggerType.Click;f.event=u;f.pane=n.link.pane;i.detach();yt(f,n,r,function(r){r===!0?t.hidePane(n.paneId,{context:f},function(){EVUI.Modules.Core.Utils.hasFlag(n.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!0&&i.attach()}):i.attach()})}),i.attach(),n.link.eventBindings.push(i)):r.hideMode===EVUI.Modules.Panes.PaneHideMode.ExteriorClick?(i=new EVUI.Modules.Panes.PaneEventBinding(EVUI.Modules.Panes.PaneHideMode.ExteriorClick,"click contextmenu",document,function(u){var f=new EVUI.Modules.Panes.PaneAutoTriggerContext;(f.triggerType=EVUI.Modules.Panes.PaneAutoTriggerType.ExteriorClick,f.event=u,f.pane=n.link.pane,(typeof n.link.pane.autoHideSettings.autoHideFilter!="function"||n.link.pane.autoHideSettings.autoHideFilter(f)!==!0)&&EVUI.Modules.Core.Utils.containsElement(u.target,n.link.pane.element)!==!0&&u.target!==n.link.pane.element)&&(i.detach(),yt(f,n,r,function(r){r===!0?t.hidePane(n.paneId,{context:f},function(){EVUI.Modules.Core.Utils.hasFlag(n.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!0&&i.attach()}):i.attach()}))}),i.attach(),n.link.eventBindings.push(i)):r.hideMode===EVUI.Modules.Panes.PaneHideMode.GlobalClick&&(i=new EVUI.Modules.Panes.PaneEventBinding(EVUI.Modules.Panes.PaneHideMode.GlobalClick,"click contextmenu",document,function(u){var f=new EVUI.Modules.Panes.PaneAutoTriggerContext;f.triggerType=EVUI.Modules.Panes.PaneAutoTriggerType.GlobalClick;f.event=u;f.pane=n.link.pane;i.detach();yt(f,n,r,function(r){r===!0?t.hidePane(n.paneId,{context:f},function(){EVUI.Modules.Core.Utils.hasFlag(n.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!0&&i.attach()}):i.attach()})}),i.attach(),n.link.eventBindings.push(i)))},ve=function(n){var i,r;n.link.pane.element!=null&&n.link.pane.autoHideSettings!=null&&(i=li(n.link.pane.autoHideSettings),i.autoHideKeys!=null&&EVUI.Modules.Core.Utils.isArray(i.autoHideKeys)!==!1)&&(r=new EVUI.Modules.Panes.PaneEventBinding("autoHideKey","keydown",document,function(u){if(i.autoHideKeys!=null&&EVUI.Modules.Core.Utils.isArray(i.autoHideKeys)!==!1&&i.autoHideKeys.indexOf(u.key)!==-1){var f=new EVUI.Modules.Panes.PaneAutoTriggerContext;f.triggerType=EVUI.Modules.Panes.PaneAutoTriggerType.KeyDown;f.event=u;f.eventBinding=r;f.pane=n.link.pane;r.detach();yt(f,n,i,function(i){i===!0?t.hidePane(n.paneId,{context:f},function(){EVUI.Modules.Core.Utils.hasFlag(n.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)===!0&&r.attach()}):r.attach()})}}),r.attach(),n.link.eventBindings.push(r))},yt=function(n,t,i,r){if(i.allowChaining===!0&&su(n)===!1)return r(!1);if(typeof i.autoHideFilter!="function")return r(!0);var u=i.autoHideFilter(n);EVUI.Modules.Core.Utils.isPromise(u)===!0?u.then(function(n){r(n)}).catch(function(n){EVUI.Modules.Core.Utils.log(n.stack);r(!1)}):r(u)},ye=function(n,r){var s,u,c,h;if(n.link.pane.element!=null&&r.canDragMove===!0){var f=o(EVUI.Modules.Panes.Constants.Attribute_Drag),l=new EVUI.Modules.Dom.DomHelper(n.link.pane.element),e=new EVUI.Modules.Dom.DomHelper("["+f+"]",n.link.pane.element).elements.slice();if(n.link.pane.element.matches("["+f+"]")===!0&&e.unshift(n.link.pane.element),s=e.length,s!==0)for(u=0;u<s;u++)c=e[u],h=new EVUI.Modules.Panes.PaneEventBinding(f,"mousedown",c,function(r){var u,f;if(i.stylesheetManager.ensureSheet(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,{lock:!0}),u=n.link.pane.getCurrentPosition(),hr(n,u,r)==null){n.link.lastResizeArgs=null;var e=r.clientX,o=r.clientY,s=n.link.lastResolvedShowArgs.clipSettings!=null&&n.link.lastResolvedShowArgs.clipSettings.mode===EVUI.Modules.Panes.PaneClipMode.Shift?et(n.link.lastResolvedShowArgs.clipSettings):null;r.preventDefault();r.stopPropagation();f=function(i){i.preventDefault();i.stopPropagation();var f=i.clientX-e,s=i.clientY-o,r=new EVUI.Modules.Panes.PaneMoveArgs;r.top=u.top+s;r.left=u.left+f;r.transition=n.link.pane.resizeMoveSettings!=null?n.link.pane.resizeMoveSettings.moveTransition:null;t.movePane(n.link.pane,r)};document.addEventListener("mousemove",f);document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",f)},{once:!0})}}),h.attach(),n.link.eventBindings.push(h)}},pe=function(n,t){var i=new EVUI.Modules.Panes.PaneEventBinding(null,"mousedown",n.link.pane.element,function(){var i,r;(t==null||t.alwaysOnTop===!0)&&((i=n.link.pane.getCurrentZIndex(),i>=EVUI.Modules.Panes.Constants.GlobalZIndex)||(EVUI.Modules.Panes.Constants.GlobalZIndex++,i=EVUI.Modules.Panes.Constants.GlobalZIndex,r="."+n.link.paneCSSName+"."+EVUI.Modules.Panes.Constants.CSS_Position,EVUI.Modules.Styles.Manager.ensureSheet(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,{lock:!0}),EVUI.Modules.Styles.Manager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,r,{zIndex:i})))});i.attach();n.link.eventBindings.push(i)},we=function(n){if(n.link.pane.element!=null){var u=new EVUI.Modules.Dom.DomHelper(n.link.pane.element),r=new EVUI.Modules.Panes.PaneEventBinding("dragResize","mousedown",n.link.pane.element,function(r){var u,e,o,s,f;(i.stylesheetManager.ensureSheet(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,{locked:!0}),startPos=n.link.pane.getCurrentPosition(),u=hr(n,startPos,r),u!=null)&&(e=r.clientX,o=r.clientY,n.link.lastResizeArgs=null,s=n.link.lastResolvedShowArgs.clipSettings!=null&&n.link.lastResolvedShowArgs.clipSettings.mode===EVUI.Modules.Panes.PaneClipMode.Shift?et(n.link.lastResolvedShowArgs.clipSettings):null,r.preventDefault(),r.stopPropagation(),f=function(i){i.preventDefault();i.stopPropagation();var f=i.clientX-e,s=i.clientY-o,r=new EVUI.Modules.Panes.PaneResizeArgs;r.right=startPos.right;r.bottom=startPos.bottom;r.top=startPos.top;r.left=startPos.left;r.transition=n.link.pane.resizeMoveSettings!=null?n.link.pane.resizeMoveSettings.resizeTransition:null;u.growX==="right"?r.right+=f:u.growX==="left"&&(r.left+=f);u.growY==="bottom"?r.bottom+=s:u.growY==="top"&&(r.top+=s);t.resizePane(n.link.pane,r)},document.addEventListener("mousemove",f),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",f)},{once:!0}))});r.attach();n.link.eventBindings.push(r)}},hr=function(n,t,i){var f,e,c,l,a,v,o;if(n.link.pane.resizeMoveSettings==null||n.link.pane.resizeMoveSettings.canResizeBottom===!1&&n.link.pane.resizeMoveSettings.canResizeLeft===!1&&n.link.pane.resizeMoveSettings.canResizeRight===!1&&n.link.pane.resizeMoveSettings.canResizeTop===!1)return null;var r=i.clientX,s=i.clientY,h=n.link.pane.resizeMoveSettings.dragHanldeMargin,u=new EVUI.Modules.Dom.ElementBounds;return(u.bottom=t.bottom-h,u.left=t.left+h,u.right=t.right-h,u.top=t.top+h,f=null,e=null,r>=t.left&&r<=u.left&&n.link.pane.resizeMoveSettings.canResizeLeft===!0&&(f="left"),r>=u.right&&r<=t.right&&n.link.pane.resizeMoveSettings.canResizeRight===!0&&(c=r-t.left,l=t.right-r,f!=null?l<c&&(f="right"):f="right"),s>=t.top&&s<=u.top&&n.link.pane.resizeMoveSettings.canResizeTop===!0&&(e="top"),s>=u.bottom&&s<=t.bottom&&n.link.pane.resizeMoveSettings.canResizeBottom===!0&&(a=r-t.left,v=t.right-r,e!=null?v<a&&(e="bottom"):e="bottom"),f==null&&e==null)?null:(o=new be,o.growX=f,o.growY=e,o.originalBounds=t,o)},be=function(){this.growX=null;this.growY=null;this.originalBounds=null},pt=function(n,t,r,u,f){if(typeof f!="function"&&(f=function(){}),n==null||u==null)return f(!1);if(t!=null&&t.css!=null){if(t.keyframes!=null&&i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,t.keyframes),typeof t.css=="string"){var e=t.css.match(/[\:\;]/g);e==null&&e.length===0&&(r=t.css,u.addClass(r))}else i.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,w(n,r),t.css),u.addClass(r);n.link.transitionTimeoutID!==-1&&(u.removeClass(n.link.transitionSelector),clearTimeout(n.link.transitionTimeoutID),typeof n.link.transitionCallback=="function"&&(n.link.transitionCallback(),n.link.transitionCallback=null));n.link.transitionCallback=function(){n.link.transitionCallback=null;n.link.transitionTimeoutID=-1;n.link.transitionSelector=null;u.removeClass(r);f(!0)};n.link.transitionSelector=r;n.link.transitionTimeoutID=setTimeout(function(){typeof n.link.transitionCallback=="function"&&n.link.transitionCallback()},t.duration)}else n.link.transitionTimeoutID!==-1&&(u.removeClass(n.link.transitionSelector),clearTimeout(n.link.transitionTimeoutID),typeof n.link.transitionCallback=="function"&&(n.link.transitionCallback(),n.link.transitionCallback=null),n.link.transitionSelector=null,n.link.transitionTimeoutID=-1),f(!1)},ke=function(n,t,i){var r,f;if(typeof i!="function"&&(i=function(){}),n==null||t==null)return i(!1);if(r=wt(t),r===EVUI.Modules.Panes.PaneLoadMode.None)throw Error("No load mode detected, cannot load root element of Pane.");return r===EVUI.Modules.Panes.PaneLoadMode.ExistingElement?(n.link.pane.element=u(t.element,!0),i(!0)):r===EVUI.Modules.Panes.PaneLoadMode.CSSSelector?(f=new EVUI.Modules.Dom.DomHelper(t.selector,u(t.contextElement)),f.elements.length===0)?i(!1):(n.link.pane.element=f.elements[0],i(!0)):r===EVUI.Modules.Panes.PaneLoadMode.HTTP?de(n,t,i):r===EVUI.Modules.Panes.PaneLoadMode.Placeholder?ge(n,t,i):void 0},wt=function(n){return EVUI.Modules.Core.Utils.isObject(n)===!1?EVUI.Modules.Panes.PaneLoadMode.None:n.element!=null?EVUI.Modules.Panes.PaneLoadMode.ExistingElement:EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.selector)===!1?EVUI.Modules.Panes.PaneLoadMode.CSSSelector:n.httpLoadArgs!=null?EVUI.Modules.Panes.PaneLoadMode.HTTP:n.placeholderLoadArgs!=null?EVUI.Modules.Panes.PaneLoadMode.Placeholder:EVUI.Modules.Panes.PaneLoadMode.None},de=function(n,t,r){var u=new EVUI.Modules.HtmlLoader.HtmlRequestArgs;u.httpArgs=t.httpLoadArgs;i.htmlLoader.loadHtml(u,function(t){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)return r(!1);var i=new EVUI.Modules.Dom.DomHelper(t);return i.elements.length===0?r(!1):i.elements.length>1?r(!1):(n.link.pane.element=i.elements[0],r(!0))})},ge=function(n,t,r){i.htmlLoader.loadPlaceholder(t.placeholderLoadArgs,function(t){if(t.loadedContent==null||t.loadedContent.length===0||t.loadedContent.length>1)return r(!1);n.link.pane.element=t.loadedContent[0];r(!0)})},cr=function(n){var t,i;return n==null?!1:(t=wt(n.link.lastResolvedLoadArgs),t===EVUI.Modules.Panes.PaneLoadMode.CSSSelector||t===EVUI.Modules.Panes.PaneLoadMode.ExistingElement||t==EVUI.Modules.Panes.PaneLoadMode.None?(ht(),ft(n),n.link.pane.element=null):t===EVUI.Modules.Panes.PaneLoadMode.HTTP?(n.link.pane.element.remove(),n.link.pane.element=null):t===EVUI.Modules.Panes.PaneLoadMode.Placeholder&&(i=new EVUI.Modules.Dom.DomHelper("["+EVUI.Modules.HtmlLoader.Constants.Attr_PlaceholderID+"="+n.link.lastResolvedLoadArgs.placeholderLoadArgs.placeholderID+"]"),i.attr(EVUI.Modules.HtmlLoader.Constants.Attr_ContentLoadState,EVUI.Modules.HtmlLoader.HtmlPlaceholderLoadState.OnDemand),i.empty(),n.link.pane.element=null),!0)},no=function(n,t,i,r){var u=new EVUI.Modules.Dom.DomHelper(n.link.pane.element);pt(n,i,EVUI.Modules.Panes.Constants.CSS_Transition_Hide,u,function(){sr(n);ni(n);bi(n);u.removeClass(n.link.transitionSelector);var i=at(t);i===EVUI.Modules.Panes.PaneShowMode.DocumentFlow?u.hide():(ht(),ft(n));r()})},to=function(n,t){var f,e;typeof t!="function"&&(t=function(){});var o=!1,u=!1,r=rt(function(t){return t.link.pane!=n.link.pane&&t.link.pane.showSettings!=null&&t.link.pane.showSettings.backdropSettings!=null&&t.link.pane.showSettings.backdropSettings.showBackdrop===!0},!0);r!=null&&r.length>0&&(f=r.filter(function(n){return n.link.currentPaneAction===EVUI.Modules.Panes.PaneAction.Show||n.link.currentPaneAction===EVUI.Modules.Panes.PaneAction.Load},!0),e=r.filter(function(n){return EVUI.Modules.Core.Utils.hasFlag(n.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)},!0),o=f!=null&&f.length>0,u=e!=null&&e.length>0);o===!1&&u===!1?i.backdropManager.hideBackdrop(n.link.paneCSSName,n.link.lastResolvedShowArgs.backdropSettings,function(n){t(n)}):u===!0?(i.backdropManager.setBackdropZIndex(),t(!0)):t(!0)},io=function(n){i=n==null||typeof n!="object"?new ei:EVUI.Modules.Core.Utils.shallowExtend(n,new ei);i.backdropManager=new wr;(i.stylesheetManager==null||typeof i.stylesheetManager!="object")&&(i.stylesheetManager=EVUI.Modules.Styles.Manager);(i.httpManager==null||typeof i.httpManager!="object")&&Object.defineProperty(i,"httpManager",{get:function(){return EVUI.Modules.Http.Http},configurable:!1,enumerable:!0});(i.htmlLoader==null||typeof i.htmlLoader!="object")&&Object.defineProperty(i,"htmlLoader",{get:function(){return EVUI.Modules.HtmlLoader.Manager},configurable:!1,enumerable:!0})},ro=function(n){ht();gi();di();n.backdropManager=i.backdropManager};io(n);i.stylesheetManager.ensureSheet(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,{lock:!0})};EVUI.Modules.Panes.Pane=function(n){if(n==null||n.constructor[Symbol.for("evui-panes")]!==EVUI.Modules.Panes[Symbol.for("evui-panes")])throw Error("Invalid constructor invocation.");var t=n,i=null,r=this;this.id=null;Object.defineProperty(this,"id",{get:function(){return t.paneId},configurable:!1,enumerable:!0});this.element=null;Object.defineProperty(this,"element",{get:function(){return i},set:function(n){if(EVUI.Modules.Core.Utils.hasFlag(t.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded))throw Error('Failed to set element for pane "'+t.paneId+'": Pane has been loaded. Unload it to reset its element.');i=n},configurable:!1,enumerable:!0});this.template=EVUI.Modules.Panes.PaneTemplateType.None;Object.defineProperty(this,"template",{get:function(){return t.link.template},configurable:!1,enumerable:!0});this.loadSettings=new EVUI.Modules.Panes.PaneLoadSettings;this.showSettings=new EVUI.Modules.Panes.PaneShowSettings;this.resizeMoveSettings=new EVUI.Modules.Panes.PaneResizeMoveSettings;this.autoHideSettings=new EVUI.Modules.Panes.PaneAutoHideSettings;this.unloadOnHide=!1;this.isVisible=!1;Object.defineProperty(this,"isVisible",{get:function(){return EVUI.Modules.Core.Utils.hasFlag(t.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Visible)},configurable:!1,enumerable:!0});this.isLoaded=!1;Object.defineProperty(this,"isLoaded",{get:function(){return EVUI.Modules.Core.Utils.hasFlag(t.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Loaded)},configurable:!1,enumerable:!0});this.isInitialized=!1;Object.defineProperty(this,"isInitialized",{get:function(){return EVUI.Modules.Core.Utils.hasFlag(t.link.paneStateFlags,EVUI.Modules.Panes.PaneStateFlags.Initialized)},configurable:!1,enumerable:!0});this.onLoad=function(){};this.onLoaded=function(){};this.onInitialize=function(){};this.onShow=function(){};this.onPosition=function(){};this.onShown=function(){};this.onHide=function(){};this.onHidden=function(){};this.onUnload=function(){};this.onUnloaded=function(){};this.onMove=function(){};this.onMoved=function(){};this.onResize=function(){};this.onResized=function(){};this.show=function(n,i){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return t.link.manager.showPane(t.paneId,n,i)};this.showAsync=function(n){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return t.link.manager.showPaneAsync(t.paneId,n)};this.hide=function(n,i){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return t.link.manager.hidePane(t.paneId,n,i)};this.hideAsync=function(n){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return t.link.manager.hidePaneAsync(t.paneId,n)};this.load=function(n,i){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.loadPane(t.paneId,n,i)};this.loadAsync=function(n){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.loadPaneAsync(t.paneId,n)};this.unload=function(n,i){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.unloadPane(t.paneId,n,i)};this.unloadAsync=function(n){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.unloadPaneAsync(t.paneId,n)};this.movePane=function(n,i){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.movePane(t.paneId,n,i)};this.movePaneAsync=function(n){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.movePaneAsync(t.paneId,n)};this.resizePane=function(n,i){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.resizePane(t.paneId,n,i)};this.resizePaneAsync=function(n){if(t.link.removed===!0)throw Error("Pane was removed from its PaneManager and cannot perform operations.");return options.link.manager.resizePaneAsync(t.paneId,n,callback)};this.getCurrentPosition=function(){return EVUI.Modules.Core.Utils.isElement(i)===!1?new EVUI.Modules.Dom.ElementBounds:new EVUI.Modules.Dom.DomHelper(i).offset()};this.getCurrentZIndex=function(){if(EVUI.Modules.Core.Utils.isElement(i)===!1)return-1;var n=parseInt(getComputedStyle(i).zIndex);return isNaN(n)===!0?-1:n};this.addEventListener=function(n,i,r){return EVUI.Modules.Core.Utils.isObject(r)===!1&&(r=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),r.eventType=EVUI.Modules.EventStream.EventStreamEventType.Event,t.link.bubblingEvents.addEventListener(n,i,r)};this.removeEventListener=function(n,i){return t.link.bubblingEvents.removeEventListener(n,i)}};EVUI.Modules.Panes.PaneAutoHideSettings=function(){this.hideMode=EVUI.Modules.Panes.PaneHideMode.Explicit;this.autoHideKeys=[];this.allowChaining=!1;this.autoHideFilter=null};EVUI.Modules.Panes.PaneHideMode={GlobalClick:"globalclick",ExteriorClick:"exteriorclick",Explicit:"explicit"};Object.freeze(EVUI.Modules.Panes.PaneHideMode);EVUI.Modules.Panes.PaneLoadSettings=function(){this.element=null;this.selector=null;this.contextElement=null;this.httpLoadArgs=null;this.placeholderLoadArgs=null};EVUI.Modules.Panes.PaneLoadMode={None:"none",ExistingElement:"existing",CSSSelector:"css",HTTP:"http",Placeholder:"placeholder"};Object.freeze(EVUI.Modules.Panes.PaneLoadMode);EVUI.Modules.Panes.PaneLoadArgs=function(){this.context=null;this.element=null;this.selector=null;this.contextElement=null;this.httpLoadArgs=null;this.placeholderLoadArgs=null;this.reload=!1};EVUI.Modules.Panes.PaneShowSettings=function(){this.positionClass=null;this.absolutePosition=null;this.relativePosition=null;this.anchors=null;this.documentFlow=null;this.clipSettings=null;this.fullscreen=!1;this.center=!1;this.showTransition=null;this.hideTransition=null;this.setExplicitDimensions=!1;this.backdropSettings=null;this.alwaysOnTop=!0};EVUI.Modules.Panes.PaneShowArgs=function(){this.context=undefined;this.positionClass=undefined;this.absolutePosition=undefined;this.relativePosition=undefined;this.anchors=undefined;this.documentFlow=undefined;this.clipSettings=undefined;this.fullscreen=undefined;this.center=undefined;this.showTransition=undefined;this.setExplicitDimensions=undefined;this.backdropSettings=undefined;this.alwaysOnTop=undefined;this.reInitialize=undefined;this.loadArgs=undefined};EVUI.Modules.Panes.PaneDocumentFlow=function(){this.relativeElement=null;this.mode=EVUI.Modules.Panes.PaneDocumentFlowMode.Append};EVUI.Modules.Panes.PaneClipSettings=function(){this.mode=EVUI.Modules.Panes.PaneClipMode.Overflow;this.clipBounds=null;this.scrollXWhenClipped=!1;this.scrollYWhenClipped=!1};EVUI.Modules.Panes.PaneClipMode={Overflow:"overflow",Clip:"clip",Shift:"shift"};Object.freeze(EVUI.Modules.Panes.PaneClipMode);EVUI.Modules.Panes.PaneDocumentFlowMode={Current:"current",Append:"append",Prepend:"prepend",Before:"before",After:"after"};Object.freeze(EVUI.Modules.Panes.PaneDocumentFlowMode);EVUI.Modules.Panes.PaneAbsolutePosition=function(){this.top=0;this.left=0};EVUI.Modules.Panes.PaneRelativePosition=function(){this.left=0;this.top=0;this.orientation=EVUI.Modules.Panes.RelativePositionOrientation.Bottom+" "+EVUI.Modules.Panes.RelativePositionOrientation.Right;this.alignment=EVUI.Modules.Panes.RelativePositionAlignment.None;this.relativeElement=null;this.useCursor=!1};EVUI.Modules.Panes.PaneRecalcSettings=function(){this.paneResizeResponse=EVUI.Modules.Panes.PaneResizeResponseMode.None;this.poll=!1;this.pollInterval=150;this.recalcTransition=null};EVUI.Modules.Panes.PaneResizeResponseMode={None:"none",RealTime:"realtime",OnComplete:"oncomplete"};Object.freeze(EVUI.Modules.Panes.PaneResizeResponseMode);EVUI.Modules.Panes.RelativePositionOrientation={Left:"left",Right:"right",Top:"top",Bottom:"bottom"};Object.freeze(EVUI.Modules.Panes.RelativePositionOrientation);EVUI.Modules.Panes.RelativePositionAlignment={None:"none",Left:"left",Right:"right",XCenter:"xcenter",YCenter:"ycenter",Top:"top",Bottom:"bottom"};Object.freeze(EVUI.Modules.Panes.RelativePositionAlignment);EVUI.Modules.Panes.PaneAnchors=function(){this.top=null;this.left=null;this.bottom=null;this.right=null;this.alignX=EVUI.Modules.Panes.AnchorAlignment.Elastic;this.alignY=EVUI.Modules.Panes.AnchorAlignment.Elastic};EVUI.Modules.Panes.AnchorAlignment={None:"none",Elastic:"elastic",Left:"left",Right:"right",Center:"center",Top:"top",Bottom:"bottom"};Object.freeze(EVUI.Modules.Panes.AnchorAlignment);EVUI.Modules.Panes.PaneEventBinding=function(n,t,i,r){var h=n,f=t,e=r,o=i,u=null,s=i!=null?new EVUI.Modules.Dom.DomHelper(o):null;this.attribute=null;Object.defineProperty(this,"attribute",{get:function(){return h},configurable:!1,enumerable:!0});this.event=null;Object.defineProperty(this,"event",{get:function(){return f},configurable:!1,enumerable:!0});this.handler=null;Object.defineProperty(this,"handler",{get:function(){return e},configurable:!1,enumerable:!0});this.element=null;Object.defineProperty(this,"element",{get:function(){return o},configurable:!1,enumerable:!0});this.active=!0;Object.defineProperty(this,"active",{get:function(){return u},configurable:!1,enumerable:!0});this.detach=function(){u!==!1&&(s.off(f,e),u=!1)};this.attach=function(){if(u!==!0){s.on(f,e);u=!0}}};EVUI.Modules.Panes.PaneAutoTriggerContext=function(){this.triggerType=EVUI.Modules.Panes.PaneAutoTriggerType.None;this.event=null;this.pane=null;this.sourcePane=null};EVUI.Modules.Panes.PaneAutoTriggerType={None:"none",GlobalClick:"click-global",Click:"click",ExteriorClick:"click-exterior",KeyDown:"keydown",Explicit:"explicit",Cascade:"cascade"};Object.freeze(EVUI.Modules.Panes.PaneAutoTriggerType);EVUI.Modules.Panes.PaneTransition=function(){this.css=null;this.keyframes=null;this.duration=0};EVUI.Modules.Panes.PaneResizeMoveSettings=function(){this.canDragMove=!1;this.canResizeTop=!1;this.canResizeBottom=!1;this.canResizeLeft=!1;this.canResizeRight=!1;this.dragHanldeMargin=15;this.restoreDefaultOnHide=!0;this.resizeTransition=null;this.moveTransition=null};EVUI.Modules.Panes.PaneBackdropSettings=function(){this.showBackdrop=!1;this.backdropCSS=null;this.backdropShowTransition=null;this.backdropHideTransition=null;this.backdropOpacity=.75;this.backdropColor="#000000"};EVUI.Modules.Panes.PaneTemplateType={None:"none",Dropdown:"dropdown",Modal:"modal",Dialog:"dialog"};Object.freeze(EVUI.Modules.Panes.PaneTemplateType);EVUI.Modules.Panes.PaneEventArgs=function(n){if(n==null)throw Error("Invalid arguments.");var t=n;this.pane=null;Object.defineProperty(this,"pane",{get:function(){return t.link.pane},configurable:!1,enumerable:!0});this.eventName=null;this.eventType=null;this.pause=function(){};this.resume=function(){};this.cancel=function(){};this.stopPropagation=function(){};this.calculatedPosition=null;this.context={};this.action=null;this.currentAction=null;this.paneShowMode=EVUI.Modules.Panes.PaneShowMode.None;this.showArgs=null;this.loadArgs=null;this.hideArgs=null;this.unloadArgs=null;this.moveArgs=null;this.resizeArgs=null};EVUI.Modules.Panes.PaneStateFlags={None:0,Initialized:1,Loaded:2,Visible:4,Positioned:8};Object.freeze(EVUI.Modules.Panes.PaneStateFlags);EVUI.Modules.Panes.PaneAction={None:"none",Show:"show",Hide:"hide",Load:"load",Unload:"unload",Move:"move",Resize:"resize"};Object.freeze(EVUI.Modules.Panes.PaneAction);EVUI.Modules.Panes.PanePosition=function(n){var t=n;this.mode=EVUI.Modules.Panes.PaneShowMode.None;Object.defineProperty(this,"mode",{get:function(){return t},configurable:!1,enumerable:!0});this.classNames=[];this.top=0;this.left=0;this.bottom=0;this.right=0;this.zIndex=0};EVUI.Modules.Panes.PaneShowMode={None:"none",PositionClass:"css",AbsolutePosition:"absolute",RelativePosition:"relative",Anchored:"anchor",DocumentFlow:"docflow",Fullscreen:"fullscreen",Centered:"centered"};Object.freeze(EVUI.Modules.Panes.PaneShowMode);EVUI.Modules.Panes.Manager=null,function(){var t=EVUI.Modules.Panes.PaneManager,n=null;Object.defineProperty(EVUI.Modules.Panes,"Manager",{get:function(){return n==null&&(n=new t(t)),n},enumerable:!0,configurable:!1})}();EVUI.Modules.Panes.PaneHideArgs=function(){this.context=undefined;this.hideTransition=undefined;this.unload=undefined;this.unloadArgs=undefined};EVUI.Modules.Panes.PaneUnloadArgs=function(){this.context=undefined;this.remove=undefined};EVUI.Modules.Panes.PaneResizeArgs=function(){this.context=undefined;this.top=undefined;this.left=undefined;this.right=undefined;this.bottom=undefined;this.transition=undefined};EVUI.Modules.Panes.PaneResizeArgs.prototype.getResizedHeight=function(){return this.bottom-this.top};EVUI.Modules.Panes.PaneResizeArgs.prototype.getResizedWidth=function(){return this.right-this.left};EVUI.Modules.Panes.PaneMoveArgs=function(){this.context=undefined;this.top=undefined;this.left=undefined;this.transition=undefined};EVUI.Modules.Panes.PaneArgumentType={Show:"show",Hide:"hide",Load:"load",Unload:"unload",Move:"move",Resize:"resize"};Object.freeze(EVUI.Modules.Panes.PaneArgumentType);EVUI.Modules.Panes.PaneManagerServices=function(){this.httpManager=null;this.htmlLoader=null;this.stylesheetManager=null};$evui.panes=null;Object.defineProperty($evui,"panes",{get:function(){return EVUI.Modules.Panes.Manager},enumerable:!0});Object.freeze(EVUI.Modules.Panes);EVUI.Constructors.Panes=EVUI.Modules.Panes.PaneManager;$evui.getPane=function(n,t){return $evui.panes.getPane(n,t)};$evui.addPane=function(n){return $evui.panes.addPane(n)};$evui.showPane=function(n,t,i){return $evui.panes.showPane(n,t,i)};$evui.showPaneAsync=function(n,t){return $evui.panes.showPaneAsync(n,t)};$evui.hidePane=function(n,t,i){return $evui.panes.hidePane(n,t,i)};$evui.hidePaneAsync=function(n,t){return $evui.panes.hidePaneAsync(n,t)};Object.freeze(EVUI.Modules.Panes);EVUI.Modules.Styles={};EVUI.Modules.Styles.Dependencies={Core:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.Styles.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.Styles.Dependencies);EVUI.Modules.Styles.Constants={};EVUI.Modules.Styles.Constants.DefaultStyleSheetName="evui-style-default";EVUI.Modules.Styles.StyleSheetManager=function(){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Styles.Dependencies);var n=new EVUI.Modules.Styles.StyleParser,a=["@keyframes"],u=[];this.addStyleSheet=function(n,r){var o,f;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw new Error("Sheet name cannot be null or whitespace.");if(o=i(n),o===!0)throw Error('A stylesheet with the name "'+n+" already exists.");var h=r instanceof CSSStyleSheet,e=p(r,!0),c=null;if(c=h===!1?nt().sheet:r,f=new it,f.lock=r.lock===!0?!0:!1,f.name=n,f.styleSheet=c,u.push(f),h===!1){if(e==null)return!0;s(f,e.slice())}else f.rules=e,g(f);return t(f.rules)};this.removeStyleSheet=function(n){var t,r;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw new Error("Sheet name cannot be null or whitespace.");return(t=i(n),t==null||t.lock===!0)?!1:(r=u.indexOf(t),r!==-1&&u.splice(r,1),t.styleSheet.ownerNode!=null&&t.styleSheet.ownerNode.remove(),!0)};this.setRules=function(n,u,e){var l,v,b,o,a,k,w,it,rt,g,ot;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw new Error("Sheet name cannot be null or whitespace.");if(l=null,typeof e=="string"||e!=null&&typeof e=="object"){if(typeof u!="string"&&EVUI.Modules.Core.Utils.isArray(u)===!1)throw Error("Invalid input. Selector missing for provided rules string or an array of strings.");l=new EVUI.Modules.Styles.StyleSheetRule;l.selector=u;l.rules=e}else l=u;if(v=i(n),v==null){this.addStyleSheet(n,l);return}var ut=p(l),st=ut.length,nt=[],tt=[];for(b=0;b<st;b++)if(o=ut[b],a=r(v,o.selector),a!=null)k={},w=null,a.selectors.filter(function(n){return d(n)}).length>0?(k=o.rules,w=[o]):(k[a.selector]=f(o.rules,a.rules),w=c(k)),it=h(v,a),it===-1&&w.length>0?nt.push(o):(rt=y(w,it,v,a),rt!=null&&(tt=tt.concat(rt)));else{var ft=Object.keys(o.rules),ht=ft.length,et=!0;for(g=0;g<ht;g++)if(o.rules[ft[g]]!=="null"){et=!1;break}if(et===!0)continue;nt.push(o)}return ot=s(v,nt),t(tt.concat(ot))};this.removeRules=function(n,u){var f,s,y,o,c,l;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw new Error("Sheet name cannot be null or whitespace.");if(f=i(n),f==null)return!1;var a=e(u),p=a.length,v=[];for(s=0;s<p;s++)y=a[s],o=r(f,y),o!=null&&(c=h(f,o),c!==-1&&(f.styleSheet.deleteRule(c),l=f.rules.indexOf(o),l!==-1&&f.rules.splice(l,1),v.push(o)));return t(v)};this.getRules=function(n,u){var f,o,l,s;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw new Error("Sheet name cannot be null or whitespace.");if(f=i(n),f==null)return null;if(typeof u=="string"||EVUI.Modules.Core.Utils.isArray(u)){var h=e(u),a=h.length,c=[];for(o=0;o<a;o++)l=h[o],s=r(f,l),s!=null&&c.push(s);return t(c)}return t(f.rules)};this.ensureSheet=function(n,t){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw new Error("Sheet name cannot be null or whitespace.");var r=i(n);return r==null?this.addStyleSheet(n,t):(g(r),this.getRules(n))};this.sync=function(n,r){var u,f;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)throw new Error("Sheet name cannot be null or whitespace.");if(typeof r!="string"||(u=i(n),u==null))return!1;if(r===EVUI.Modules.Styles.SyncMode.FromSheet){if(u.lock===!0)throw Error("Cannot sync the contents of a locked sheet with those of the DOM.");return u.rules=w(u),t(u.rules)}while(u.styleSheet.cssRules.length>0)u.styleSheet.deleteRule(0);return f=u.rules,u.rules=[],f=s(u,f),t(f)};var t=function(n){var r,f,t,u,i;if(n==null)return null;for(r=[],f=n.length,t=0;t<f;t++)u=n[t],i=new EVUI.Modules.Styles.StyleSheetRule,i.selector=u.selector,i.rules=o(u.rules),r.push(i);return r},e=function(t){var r=[],s,o,h,u,c,l,f,i;if(typeof t!="string"){if(EVUI.Modules.Core.Utils.isArray(t)===!0){for(f=t.length,i=0;i<f;i++)s=e(t[i]),s!=null&&(r=r.concat(s));return r}}else if(o=v(t),o===-1)r.push(t);else{for(h="",u=null,t=n.getNormalizedSelctor(t),c=new RegExp(/\s/),l=new RegExp(/[\>\\~\+]|\|{2}/g),t=t.replace(/\s[\>\\~\+\.]\s|\s\|{2}\s/g,function(n){return n.trim()}),o=v(t),i=o;i>0;i--)if(c.test(t[i])===!0){if(i>0&&l.test(t[i-1])===!0){i>1&&t[i-2]==="\\"&&i--;continue}h=t.substring(0,i);u=t.substr(i);break}for(u==null&&(u=t),r=u.split(","),f=r.length,i=0;i<f;i++)r[i]=n.getNormalizedSelctor(h+r[i])}return r},v=function(n){for(var t=n.indexOf(","),i=t>0&&n[t-1]==="\\";i===!0;){if(t=n.indexOf(",",t+1),t===-1)break;i=t>0&&n[t-1]==="\\"}return t},y=function(n,t,i,u){var o,c;if(n==null||n.length===0)return t>=0&&i.styleSheet.deleteRule(t),[];var h=[],a=!1,v=0,p=n.length;for(o=0;o<p;o++){var e=n[o],s=l(e),f=u!=null?u:r(i,e.selector),y=!1;if(f==null||f.cssRuleText!==s||f.cssRule==null||f.cssRule.parentStyleSheet==null)try{a===!1&&(i.styleSheet.deleteRule(t),a=!0);c=i.styleSheet.insertRule(s,t+v);y=!0;v++}catch(w){EVUI.Modules.Core.Utils.log('Failed to update rule "'+s+'" : '+w.message);continue}f==null?(e.cssRule=i.styleSheet.cssRules[c],i.rules.push(e),h.push(e)):y===!0&&(f.cssRule=i.styleSheet.cssRules[c],f.selectors=e.selectors,f.selectorsSplit=e.selectorsSplit,f.rules=e.rules,f.cssRuleText=s,h.push(f))}return h},r=function(n,t){var u,i,r;if(n==null||EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)return null;for(u=n.rules.length,i=0;i<u;i++)if(r=n.rules[i],r.selector===t)return r;return null},h=function(n,t){var r,i;if(n==null||t==null)return-1;if(t.cssRule!=null)for(r=n.styleSheet.cssRules.length,i=0;i<r;i++)if(n.styleSheet.cssRules[i]===t.cssRule)return i;return-1},p=function(n,t){if(n instanceof CSSStyleSheet&&t===!0)return w(n);var i=b(n),r=ut(i);return c(r)},w=function(t){var i=new it,o,a,s,w,b,u,p,e,d,ft,g;for(i.styleSheet=t,i.rules=[],o={},u=0;u<t.cssRules.length;){var nt=[],tt=t.cssRules[u],et=n.parse(tt.cssText),rt=c(et),ot=rt.length;for(a=0;a<ot;a++)s=rt[a],s.cssRule=tt,e=r(i,s.selector),e!=null?(o[e.selector]==null&&(o[e.selector]=[e]),o[e.selector].push(s),u++):nt.push(s);w=y(nt,u,i);u+=w==null?0:w.length}for(b in o){var ut={},k=o[b],st=k.length,v=-1;for(u=0;u<st;u++)f(k[u].rules,ut),p=h(i,k[u]),p!==-1&&(v===-1&&(v=p),i.styleSheet.deleteRule(p));if(e=r(i,b),v!==-1){e.rules=ut;d=l(e);try{ft=i.styleSheet.insertRule(d,v);e.cssRule=i.styleSheet.cssRules[ft]}catch(ht){EVUI.Modules.Core.Utils.log('Failed to add rule "'+d+'":'+ht.message);g=i.rules.indexOf(e);g!==-1&&i.rules.splice(g,1)}}}return i.rules},b=function(t){var r,l,c,i,h;if(t==null)return null;if(r=[],typeof t=="string")r.push(n.parse(t));else if(typeof t=="object")if(EVUI.Modules.Core.Utils.isArray(t)===!0)for(c=t.length,i=0;i<c;i++)(l=b(t[i]),l!=null)&&(r=r.concat(l));else if(t instanceof CSSStyleSheet)for(c=t.cssRules.length,i=0;i<c;i++)r.push(n.parse(t.cssRules[i].cssText));else if((typeof t.selector=="string"||EVUI.Modules.Core.Utils.isArray(t.selector)===!0)&&t.rules!=null){var a=e(t.selector),u=null,s={},v=a.length;for(i=0;i<v;i++){if(h=a[i],u==null&&typeof t.rules=="string")u=n.parse(t.rules),s[h]=u;else if(typeof t.rules=="object")if(EVUI.Modules.Core.Utils.isArray(t.rules))throw Error("A rule object with a selector cannot have an array as its set of rules.");else s[h]!=null?f(o(u!=null?u:t.rules),s[h]):s[h]=o(u!=null?u:t.rules);r.push(s)}}return r},f=function(n,t,i){var u,r,e;i==null&&(i=[n]);for(u in n)if(r=n[u],e=t[u],r!=null&&typeof r=="object"){if(e==null)t[u]=r;else if(typeof e=="object"){if(i.indexOf(r)!==-1)continue;i.push(r);f(r,e,i.slice());i=[]}}else typeof r!="string"?typeof r=="number"?t[u]=r.toString():r===null&&delete t[u]:r.toLowerCase()==="null"?delete t[u]:t[u]=r;return t},o=function(n,t,i){var u,r;if(n==null)return t;t==null&&(t={});i==null&&(i=[n]);for(u in n)(r=n[u],r!=null)&&(typeof r=="object"?(i.indexOf(r)!==-1&&(t[u]=n),i.push(n),t[u]=o(r,EVUI.Modules.Core.Utils.isArray(r)?[]:{},i),i=[]):t[u]=r);return t},ut=function(n){for(var i={},r=n.length,t=0;t<r;t++)f(n[t],i);return i},c=function(n){var t=[],r,i;for(r in n)i=k(n,r),i!=null&&(t=t.concat(i));return t},s=function(n,t){for(var i,r,e,f=[],u=0;u<t.length;u++){i=t[u];r=l(i);try{e=n.styleSheet.insertRule(r,n.styleSheet.cssRules.length);i.cssRule=n.styleSheet.cssRules[e];i.cssRuleText=r;n.rules.push(i);f.push(i)}catch(o){EVUI.Modules.Core.Utils.log('Failed to add rule "'+r+'":'+o.message)}}return f},k=function(n,t,i,r){var f,e,o,s,u,h;if(r==null&&(r=[]),r.push(t),f=n[t],e=[],i=i==null?t:i+" "+t,d(t)===!0)return u=new rt,u.rules=f,u.selector=i,u.selectors=r,[u];for(o in f)if(s=f[o],s!=null){if(typeof s!="object")return u=new rt,u.rules=f,u.selector=i,u.selectors=r,[u];h=k(f,o,i,r.slice());h!=null&&(e=e.concat(h))}return e},d=function(n){for(var i=a.length,t=0;t<i;t++)if(n.startsWith(a[t])===!0)return!0;return!1},g=function(n){if(n.styleSheet.ownerNode==null){var t=ft(n);n.styleSheet=t}else n.styleSheet.ownerNode.isConnected===!1&&document.head.appendChild(syleSheet.ownerNode),n.disabled===!0&&(n.disabled=!1)},ft=function(n){var t=nt(),i=n.rules;n.rules=[];s(n,i);n.styleSheet=t.sheet},nt=function(){var n=document.createElement("style");return document.head.appendChild(n),n},i=function(n){for(var i,r=u.length,f=n.toLowerCase(),t=0;t<r;t++)if(i=u[t],i.name.toLowerCase()===f)return i;return null},l=function(t){var i,e;if(t==null)return"";var r="",f="",u=t.selectors.length;for(u===1&&t.selectorsSplit===!1&&(t.selectors=n.breakUpSelector(t.selector),u=t.selectors.length,t.selectorsSplit=!0),i=0;i<u;i++)i>0?(r=r+" { "+t.selectors[i],f+="}"):r=t.selectors[i];return e=tt(t.rules),r+e+f},tt=function(n){var u="{",f=new RegExp(/(?!^)[A-Z]/g),i,r,t;for(i in n)r=i.replace(f,function(n){return"-"+n.toLowerCase()}).toLowerCase(),t=n[i],u+=t!=null&&typeof t=="object"?r+" "+tt(t):r+":"+t+"; ";return u+"}"},it=function(){this.name=null;this.styleSheet=null;this.lock=!1;this.rules=[]},rt=function(){this.selector=null;this.rules=null;this.selectors=[];this.cssRule=null;this.cssRuleText=null;this.selectorsSplit=!1};this.addStyleSheet(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,{lock:!0})};EVUI.Modules.Styles.StyleSheetRule=function(){this.selector=null;this.rules=null};EVUI.Modules.Styles.StyleParser=function(){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.Styles.Dependencies);var o=new RegExp(/(?!^)(\-)([A-Z])/ig),s=new RegExp(/\{/g),h=new RegExp(/\}/g),c=new RegExp(/[#\.\[\]]/g),t=new RegExp(/\s+/g),l=new RegExp(/[\>\\~\+]|\|{2}/g);this.parse=function(t){if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)return null;var u=new v;return(u.rawCSS=a(t),u.openMatches=n(s,u.rawCSS,!0),u.closeMatches=n(h,u.rawCSS,!0),u.openMatches.length===0&&u.closeMatches.length===0)?r(u.rawCSS):i(u,{})};this.breakUpSelector=function(i){var a=n(t,i),h;if(a.length===0)return[i];for(var c=n(new RegExp(/\@/g),i,!0),v=n(new RegExp(/\)/g),i,!0),e=0,o=0,l=0,r=[];e<i.length;){var u=c[o],f=c[o+1],s=v[l];if(u==null&&f==null&&s==null)return r.length>0?(r.push(i.substring(e)),r):[i];if(u!=null&&f!=null)h=i.substring(u.index,f.index),r.push(h),o++,e=f.index+f.length;else{if(s!=null)h=i.substring(u.index,s.index+1),r.push(h),l++,e=s.index+2;else return r.push(i.substring(u.index)),r;o++}}return r};this.getNormalizedSelctor=function(n){return u(n)};var a=function(n){for(var u="",t=0,e=n.length,f=!1,i,r;t<e;){if(i=n.indexOf("/*",t),r=n.indexOf("*/",t),i===-1||r===-1)break;f=!0;u+=n.substring(t,i);t=r+2}return f===!0?u+n.substring(t):n},n=function(n,t,i){var s,u;if(typeof t!="string"||n==null)return null;for(var f=[],o=t.matchAll(n),r=o.next();r.done===!1;)s=r.value.index>0?t[r.value.index-1]:"",i===!0&&s!=="\\"?(u=new e(r.value.index,r.value[0],r.value[0].length),f.push(u)):i!==!0&&(u=new e(r.value.index,r.value[0],r.value[0].length),f.push(u)),r=o.next();return f},i=function(n,t){for(var p=n.rawCSS.length,l,v,c,f,s,h;n.index<p;){var e=n.openMatches[n.openIndex],y=n.openMatches[n.openIndex+1],o=n.closeMatches[n.closeIndex];if(e==null)break;if(o==null)break;if(e.index>n.index)if(y!=null&&y.index<o.index)for(c=n.rawCSS.substring(n.index!=0?n.index+1:0,e.index).trim(),n.openIndex++,n.index=e.index,l=c.split(","),v=l.length,f=0;f<v;f++)s=u(l[f]),h=t[s],t[s]=h!=null?i(n,h):i(n,{});else if(n.index===o.index){n.closeIndex++;n.index++;break}else{if(c=n.rawCSS.substring(n.index!=0?n.index+1:0,e.index).trim(),c.length>0){var l=c.split(","),v=l.length,a=r(n.rawCSS.substring(e.index+1,o.index));for(f=0;f<v;f++)s=u(l[f]),f>0&&(a=EVUI.Modules.Core.Utils.shallowExtend({},a)),h=t[s],t[s]=h!=null?EVUI.Modules.Core.Utils.shallowExtend(h,a):a;n.index=o.index+1}else return r(n.rawCSS.substring(e.index+1,o.index));n.openIndex++;n.closeIndex++}else break}return t},r=function(n){for(var t,i,r,s,f={},e=n.split(";"),h=e.length,u=0;u<h;u++)(t=e[u],i=t.indexOf(":"),i!==-1)&&(r=t.substring(0,i).toLowerCase().trim(),s=t.substring(i+1).trim(),r=r.replace(o,function(n){return n[1].toUpperCase()}),f[r]=s);return f},u=function(i){var u,s,h,e,y;if(typeof i!="string")return null;i=i.replace(/\)|\(/g,function(n){return n===")"?") ":" ("}).replace(/\,|\s\,|\,\s/g,", ");var r="",c=i.trim().split(t),p=c.length;for(u=0;u<p;u++){var o=c[u],a=n(l,o,!0),v=a.length;if(v===0)r=f(o,u===0,r);else{for(s=0,h=0;h<v;h++)e=a[h],y=o.substring(s,e.index),s=e.index+e.length,r=f(y,u===0,r),r=r+" "+e.match;r=f(o.substring(s),!1,r)}}return r.replace(t," ")},f=function(t,i,r){var e=n(c,t,!0),o=e.length,f,u;return o>0?(f=e[0],u=t.substring(0,f.index).toLocaleLowerCase(),r=r+(i===!0?u:" "+u)+t.substring(f.index)):(u=t.toLocaleLowerCase(),r=r+(i===!0?u:" "+u)),r},v=function(){this.index=0;this.rawCSS=null;this.openMatches=null;this.closeMatches=null;this.openIndex=0;this.closeIndex=0},e=function(n,t,i){this.index=typeof n!="number"?0:n;this.match=typeof t!="string"?null:t;this.length=typeof i!="number"?0:i}};EVUI.Modules.Styles.CSSOptions=function(){this.sheetName=null;this.selector=null;this.rules=null;this.remove=!1};EVUI.Modules.Styles.SyncMode={FromSheet:"fromSheet",ToSheet:"toSheet"};Object.freeze(EVUI.Modules.Styles.SyncMode);EVUI.Modules.Styles.Manager=null,function(){var n=null,t=EVUI.Modules.Styles.StyleSheetManager;Object.defineProperty(EVUI.Modules.Styles,"Manager",{get:function(){return n==null&&(n=new t),n},enumerable:!0,configurable:!1})}();EVUI.Constructors.Styles=EVUI.Modules.Styles.StyleSheetManager;delete $evui.styles;$evui.styles=null;Object.defineProperty($evui,"styles",{get:function(){return EVUI.Modules.Styles.Manager},enumerable:!0});$evui.css=function(n){var u,f;if(n==null)return null;if(typeof n=="string")return EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0?void 0:$evui.styles.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,n);if(typeof n=="object"){var i=EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.sheetName)===!0?EVUI.Modules.Styles.Constants.DefaultStyleSheetName:n.sheetName,r=EVUI.Modules.Core.Utils.isArray(n.selector)===!0||EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.selector)===!1?n.selector:null,t=n.rules!=null&&(typeof n.rules=="object"||EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n.rules)===!1)?n.rules:null,e=typeof n.remove!="boolean"?!1:n.remove;return e===!0?r!=null?$evui.styles.removeRules(i,r):(u=$evui.styles.getRules(i),f=$evui.styles.removeStyleSheet(i),f===!0)?u:null:r==null?t!=null?$evui.styles.setRules(i,t):$evui.styles.getRules(i):t!=null?t instanceof CSSStyleSheet?$evui.styles.setRules(i,t):EVUI.Modules.Core.Utils.isArray(t)===!0&&t.length>0&&t[0].selector!=null?$evui.styles.setRules(i,t):$evui.styles.setRules(i,r,t):$evui.styles.getRules(i,r)}};Object.freeze(EVUI.Modules.Styles.Constants);Object.freeze(EVUI.Modules.Styles);EVUI.Modules.TreeView={};EVUI.Modules.TreeView.Dependencies={Core:Object.freeze({required:!0}),Binding:Object.freeze({required:!0}),Styles:Object.freeze({required:!0}),EventStream:Object.freeze({required:!0}),Dom:Object.freeze({required:!0})},function(){var n=!1;Object.defineProperty(EVUI.Modules.TreeView.Dependencies,"checked",{get:function(){return n},set:function(t){typeof t=="boolean"&&(n=t)},configurable:!1,enumberable:!0})}();Object.freeze(EVUI.Modules.TreeView.Dependencies);EVUI.Modules.TreeView.Constants={};EVUI.Modules.TreeView.Constants.Attr_ExpandOn="evui-tree-node-expand-on";EVUI.Modules.TreeView.Constants.Attr_CollapseOn="evui-tree-node-collapse-on";EVUI.Modules.TreeView.Constants.Attr_ToggleOn="evui-tree-node-toggle-on";EVUI.Modules.TreeView.Constants.Attr_Depth="evui-tree-node-depth";EVUI.Modules.TreeView.Constants.Attr_NodeId="evui-tree-node-id";EVUI.Modules.TreeView.Constants.Attr_Ordinal="evui-tree-node-ordinal";EVUI.Modules.TreeView.Constants.Attr_TreeId="evui-tree-id";EVUI.Modules.TreeView.Constants.CSS_NodeInterior="evui-tree-node-interior";EVUI.Modules.TreeView.Constants.CSS_ChildNodeList="evui-tree-node-children";EVUI.Modules.TreeView.Constants.CSS_TreeViewNode="evui-tree-node";EVUI.Modules.TreeView.Constants.CSS_TreeViewRootNode="evui-tree-root-node";EVUI.Modules.TreeView.Constants.CSS_TreeView="evui-tree";EVUI.Modules.TreeView.Constants.CSS_TreeViewRoot="evui-tree-root";EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Hidden="evui-tree-node-children-hidden";EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Visible="evui-tree-node-children-visible";EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Expanding="evui-tree-node-children-expanding";EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Collapsing="evui-tree-node-children-collapsing";EVUI.Modules.TreeView.Constants.Event_OnBuild="build";EVUI.Modules.TreeView.Constants.Event_OnBuildChildren="buildchildren";EVUI.Modules.TreeView.Constants.Event_OnBuiltChildren="builtchildren";EVUI.Modules.TreeView.Constants.Event_OnBuilt="built";EVUI.Modules.TreeView.Constants.Event_OnExpand="expand";EVUI.Modules.TreeView.Constants.Event_OnExpanded="expanded";EVUI.Modules.TreeView.Constants.Event_OnCollapse="collapse";EVUI.Modules.TreeView.Constants.Event_OnCollapsed="collapsed";EVUI.Modules.TreeView.Constants.Job_BuildNode="job.buildnode";EVUI.Modules.TreeView.Constants.Job_FinishOperation="job.finishoperation";EVUI.Modules.TreeView.Constants.Job_BuildChildren="job.buildchildren";EVUI.Modules.TreeView.Constants.Job_Collapse="job.collapse";EVUI.Modules.TreeView.Constants.Job_Expand="job.expand";EVUI.Modules.TreeView.Constants.StepPrefix="evui.tv";EVUI.Modules.TreeView.Constants.Fn_TreeViewEventHandler=function(){};EVUI.Modules.TreeView.Constants.Fn_TreeViewSelector=function(){};EVUI.Modules.TreeView.Constants.Fn_TreeViewNodeSelector=function(){};EVUI.Modules.TreeView.Constants.Fn_ChildListGetter=function(){};Object.freeze(EVUI.Modules.TreeView.Constants);EVUI.Modules.TreeView.TreeViewController=function(n){if(EVUI.Modules.Core==null)throw Error("Dependency missing: EVUI.Modules.Core is required.");EVUI.Modules.Core.Utils.requireAll(EVUI.Modules.TreeView.Dependencies);var u=[],bt=0,kt=0,o=["element","id","parentNode","childNodes","depth","index","treeView"],dt=["id","nodes","rootListElement","rootNode","element",],it=["onExpand","onExpanded","onCollapse","onCollaposed","onBuild","onBuilt","onBuildChildren","onChildrenBuilt"],rt=!1,r=n;this.addTreeView=function(n,t){var e=typeof n,r,f,i;if(n==null||e!=="string"&&e!=="object")throw Error("Invalid parameters, string or object expected.");if(r=typeof n=="string"?n:n.id,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(r)===!0)throw Error("TreeView id must be a string.");if(f=p(r),f!=null)throw Error('A TreeView with an id of "'+f+'" already exists.');return i=gt(n,t),i!=null&&u.push(i),i.treeView};this.getTreeView=function(n,t){var f=[],e,o,i,r;if(typeof n=="string"){if(e=p(n),e!=null)return e.treeView}else{if(typeof n=="function"){for(f=t===!0?[]:null,o=u.length,i=0;i<o;i++)if(r=u[i],n(r.treeView)===!0)if(t===!0)f.push(r.treeView);else return r.treeView;return f}return null}};this.removeTreeView=function(n,t){var i=p(n),r;return i==null?!1:(t===!0&&vt(i),r=u.indexOf(i),r!==-1&&u.splice(r,1),!0)};var p=function(n){var r,f,t,i;if(typeof n!="string")return null;for(r=u.length,f=n.toLowerCase(),t=0;t<r;t++)if(i=u[t],i.treeViewId.toLowerCase()===f)return i;return null},gt=function(n,t){var r;if(n==null&&t==null)return null;var u=null,i=new EVUI.Modules.TreeView.AddTreeViewArgs,h=new EVUI.Modules.TreeView.AddTreeViewNodeArgs,f=!1,s=!1;return typeof n=="string"?(u=n,i.id=u,i.element=e()):(f=!0,u=n.id,EVUI.Modules.Core.Utils.shallowExtend(i,n,["nodes","rootNode"].concat(o)),i.element=e(n.element),n.rootNode!=null&&typeof n.rootNode=="object"&&(s=!0,EVUI.Modules.Core.Utils.shallowExtend(h,n.rootNode,o))),t==null&&(t=new EVUI.Modules.TreeView.AddTreeViewNodeArgs),f===!1?(EVUI.Modules.Core.Utils.shallowExtend(i,t,it.concat(o)),i.element=e(t.element)):s===!1&&(EVUI.Modules.Core.Utils.shallowExtend(t,i,it.concat(o)),i.element=e(i.element)),r=new hr,r.element=i.element,r.treeViewId=u,r.treeView=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.TreeView.TreeView(r),i,dt),r.rootNode=y(t,r),r.className=fr(r.treeViewId),r},s=function(n,i,r,u,e){typeof r=="function"?(e=r,r=null):typeof u=="function"?(e=u,u=null):typeof e!="function"&&(e=function(){});var o=null;if(typeof r=="number"){if(o=yt(i,r),o==null)throw Error("No node with an id of "+r+" exists in TreeView "+i.treeViewId);}else if(r!=null&&typeof r=="object")if(typeof r.nodeId=="number"){if(EVUI.Modules.Core.Utils.instanceOf(r,pt)===!0)o=r;else if(o=yt(i,r.id),o==null)throw Error("No node with an id of "+r.id+" exists in TreeView "+i.treeViewId);}else u==null&&(u=r,o=i.rootNode);else o=i.rootNode;if(n===t.Build)l(o,u,e);else if(n===t.Collapse)c(o,u,e);else if(n===t.Expand)h(o,u,e);else if(n===t.Toggle)a(o,u,e);else if(n===t.Dispose)f(o);else throw Error("Invalid action.");},ni=function(n,i,r,u){s(t.Build,n,i,r,u)},ti=function(n,i,r,u){s(t.Expand,n,i,r,u)},ii=function(n,i,r,u){s(t.Collapse,n,i,r,u)},ri=function(n,i){i==n?vt(n):s(t.Dispose,n,i)},ui=function(n,i,r,u){s(t.Toggle,n,i,r,u)},l=function(n,i,r){var u,f;typeof i=="function"&&(r=i,i=null);typeof r!="function"&&(r=function(){});i=ut(n,i);u=new tt;u.action=t.Build;u.buildArgs=i;u.callback=r;u.nodeEntry=n;u.context=i.context==null?{}:i.context;f=new nt;f.callback=r;f.operationSession=u;u.callback=f;v(n,u)},h=function(n,i,r){var u,f;typeof i=="function"&&(r=i,i=null);typeof r!="function"&&(r=function(){});i==null&&(i=new EVUI.Modules.TreeView.ExpandCollapseTreeViewNodeArgs);i.buildArgs=ut(n,i.buildArgs);u=new tt;u.action=t.Expand;u.expandCollapseArgs=i;u.buildArgs=i.buildArgs;u.callback=r;u.nodeEntry=n;u.context=i.context!=null?i.context:i.buildArgs.context!=null?i.buildArgs.context:{};f=new nt;f.callback=r;f.operationSession=u;u.callback=f;v(n,u)},c=function(n,i,r){var u,f;typeof i=="function"&&(r=i,i=null);typeof r!="function"&&(r=function(){});i==null&&(i=new EVUI.Modules.TreeView.ExpandCollapseTreeViewNodeArgs);u=new tt;u.action=t.Collapse;u.expandCollapseArgs=i;u.callback=r;u.nodeEntry=n;u.context=i.context!=null?i.context:i.buildArgs!=null&&i.buildArgs.context!=null?i.buildArgs.context:{};f=new nt;f.callback=r;f.operationSession=u;u.callback=f;v(n,u)},a=function(n,i,r){if(n.operation!=null){if(n.operation.action===t.Expand)return c(n,i,r);if(n.operation.action===t.Collapse)return h(n,i,r)}return n.expanded===!0?c(n,i,r):h(n,i,r)},ut=function(n,t){return t==null&&(t=new EVUI.Modules.TreeView.BuildTreeViewNodeArgs),t.bindingTemplate==null&&(t.bindingTemplate=n.bindingTemplate),t.buildMode==null&&(t.buildMode=EVUI.Modules.TreeView.TreeViewNodeBuildMode.Update),t.childListName==null&&(t.childListName=n.childListName),t.options==null&&(t.options=n.options),t.optionsMode==null&&(t.optionsMode=n.optionsMode),t.source==null&&(t.source=n.source),t},v=function(n,t){if(t!=null){var i=rr(n,t);if(i!=null){if(i.cancelCurrent===!0)return ei(n,t);if(i.continueAfter===!0)return oi(n,t);if(i.skip===!0)return si(n,t);fi(t,i)}}},fi=function(n,i){n.nodeEntry.previousCompletedNodeState=n.nodeEntry.nodeState;n.action===t.Build?n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Building:n.action===t.Expand?n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Expanding:n.action===t.Collapse&&(n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Collapsing);ci(n,i);n.nodeEntry.operation=n;n.eventStream.execute()},ei=function(n,t){n.operation.canceled=!0;for(var i=n.operation.continuation;i!=null;)i.callbackStack.indexOf(i.callback)===-1&&i.callbackStack.push(i.callback),t.callbackStack=t.callbackStack.concat(i.callbackStack),i=i.continuation;n.operation.continuation=t;t.isContinuation=!0;n.operation.eventStream==null||n.operation.eventStream.isWorking()===!1?w(n.operation):(n.operation.eventStream.cancel(),b(n))},oi=function(n,t){var i=hi(n);i==null?n.operation.continuation=t:i.continuation=t;t.isContinuation=!0},si=function(n,t){n.operation==null?w(t):n.operation.callbackStack.push(t.callback)},hi=function(n){var t,i;if(n.operation==null)return null;for(t=n.operation;t!=null;){if(i=t.continuation,i==null)break;t=i}return t},w=function(n,t){var r,f,i,u;if(typeof t!="function"&&(t=function(){}),n.nodeEntry.operation=null,n.callbackStack.push(n.callback),n.continuation!=null)return n.canceled===!0&&b(n.nodeEntry),n.continuation.callbackStack=n.continuation.callbackStack.concat(n.callbackStack),v(n.nodeEntry,n.continuation),t();for(n.callbackStack.sort(function(n,t){return n.operationSession.operationId-t.operationSession.operationId}),r=[],f=n.callbackStack.length,i=0;i<f;i++)r.push(n.callbackStack[i].callback);u=new EVUI.Modules.Core.AsyncSequenceExecutionArgs;u.functions=r;EVUI.Modules.Core.AsyncSequenceExecutor.execute(u,function(){n.canceled===!0&&b(n.nodeEntry);t()})},b=function(n){n.previousCompletedNodeState!==EVUI.Modules.TreeView.TreeViewNodeState.None&&(n.nodeState=n.previousCompletedNodeState,n.previousCompletedNodeState=EVUI.Modules.TreeView.TreeViewNodeState.None)},ci=function(n,i){var f,r,u;for(n.eventStream=new EVUI.Modules.EventStream.EventStream,n.eventStream.context=n.nodeEntry.node,n.eventStream.extendSteps=!1,n.eventStream.bubblingEvents=[n.nodeEntry.bubblingEvents,n.nodeEntry.treeViewEntry.bubblingEvents],n.eventStream.onCancel=function(){n.canceled=!0;n.eventStream.seek(EVUI.Modules.TreeView.Constants.Job_FinishOperation)},n.eventStream.onError=function(){n.canceled=!0;n.eventStream.seek(EVUI.Modules.TreeView.Constants.Job_FinishOperation)},n.eventStream.processInjectedEventArgs=function(t){var i=new EVUI.Modules.TreeView.TreeViewEventArgs(n.nodeEntry);return i.eventName=t.name,i.eventType=t.key,i.cancel=function(){return t.cancel()},i.eventType=t.key,i.pause=function(){return t.pause()},i.resume=function(){return t.resume()},i.stopPropagation=function(){return t.stopPropagation()},i.context=n.context,i},n.eventStream.processReturnedEventArgs=function(t){n.context=t.context},f=i.actions.length,r=0;r<f;r++)u=i.actions[r],u===t.Build?ft(n):u===t.Collapse?bi(n):u===t.Expand&&vi(n);li(n)},ft=function(n){n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuild,key:EVUI.Modules.TreeView.Constants.Event_OnBuild,handler:function(t){if(i(n)!==!1)return n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Building,typeof n.nodeEntry.node.onBuild=="function"?n.nodeEntry.node.onBuild.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuild,key:EVUI.Modules.TreeView.Constants.Event_OnBuild,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onBuild=="function"?n.nodeEntry.treeViewEntry.treeView.onBuild.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Job,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Job_BuildNode,key:EVUI.Modules.TreeView.Constants.Job_BuildNode,handler:function(t){if(i(n)===!1)return t.resolve();n.nodeEntry===n.nodeEntry.treeViewEntry.rootNode?ai(n,function(){k(n)==!0&&g(n.nodeEntry);t.resolve()}):et(n,function(){k(n)===!0&&g(n.nodeEntry);t.resolve()})}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuildChildren,key:EVUI.Modules.TreeView.Constants.Event_OnBuildChildren,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.node.onBuildChildren=="function"?n.nodeEntry.node.onBuildChildren.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuildChildren,key:EVUI.Modules.TreeView.Constants.Event_OnBuildChildren,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onBuildChildren=="function"?n.nodeEntry.treeViewEntry.treeView.onBuildChildren.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Job,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Job_BuildChildren,key:EVUI.Modules.TreeView.Constants.Job_BuildChildren,handler:function(r){var f,e,u;if(i(n)===!1)return r.resolve();f=!1;e=k(n);n.nodeEntry.options.noTopNode===!0&&n.nodeEntry.parentNodeEntry==null&&(f=!0);u=EVUI.Modules.TreeView.TreeViewNodeState.Collapsed;n.action===t.Expand&&f===!0&&(u=EVUI.Modules.TreeView.TreeViewNodeState.Expanded);n.nodeEntry.expanded===!0&&(u=EVUI.Modules.TreeView.TreeViewNodeState.Expanded);e===!0?di(n.nodeEntry,function(){f===!0?ot(n,function(){n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Expanded;r.resolve()}):(n.nodeEntry.nodeState=u,r.resolve())}):(n.nodeEntry.nodeState=u,r.resolve())}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuiltChildren,key:EVUI.Modules.TreeView.Constants.Event_OnBuiltChildren,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.node.onChildrenBuilt=="function"?n.nodeEntry.node.onChildrenBuilt.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuiltChildren,key:EVUI.Modules.TreeView.Constants.Event_OnBuiltChildren,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onChildrenBuilt=="function"?n.nodeEntry.treeViewEntry.treeView.onChildrenBuilt.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuilt,key:EVUI.Modules.TreeView.Constants.Event_OnBuilt,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.node.onBuilt=="function"?n.nodeEntry.node.onBuilt.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnBuilt,key:EVUI.Modules.TreeView.Constants.Event_OnBuilt,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onBuilt=="function"?n.nodeEntry.treeViewEntry.treeView.onBuilt.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}})},li=function(n){n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Job,key:EVUI.Modules.TreeView.Constants.Job_FinishOperation,handler:function(t){pi(n,function(){t.resolve()})}})},k=function(n){var i=!1,r,u;return n.buildArgs.recursive===!0?i=!0:n.action===t.Expand?(n.nodeEntry.options.expandMode===EVUI.Modules.TreeView.TreeViewNodeBuildMode.Rebuild&&(i=!0),n.nodeEntry.options.expandMode===EVUI.Modules.TreeView.TreeViewNodeBuildMode.Update&&(i=!0)):n.nodeEntry.options.noTopNode===!0&&n.nodeEntry.parentNodeEntry==null?i=!0:n.nodeEntry.options.lazy!==!0&&(r=n.nodeEntry.parentNodeEntry,r==null?i=!0:(u=r.operation,u!=null&&u.action===t.Expand&&(i=!0))),i},et=function(n,t){nr(n.nodeEntry,function(n){t(n)})},ai=function(n,t){n.nodeEntry.treeViewEntry.element=e(n.nodeEntry.treeViewEntry.element);n.nodeEntry.treeViewEntry.rootListNode==null&&(n.nodeEntry.treeViewEntry.rootListNode=lt(n.nodeEntry,!1),n.nodeEntry.treeViewEntry.rootListNode.classList.remove(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList),n.nodeEntry.treeViewEntry.rootListNode.classList.add(EVUI.Modules.TreeView.Constants.CSS_TreeView),n.nodeEntry.treeViewEntry.rootListNode.classList.add(EVUI.Modules.TreeView.Constants.CSS_TreeViewRoot),n.nodeEntry.treeViewEntry.rootListNode.classList.add(n.nodeEntry.treeViewEntry.className),n.nodeEntry.treeViewEntry.rootListNode.classList.add(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList),n.nodeEntry.treeViewEntry.element.appendChild(n.nodeEntry.treeViewEntry.rootListNode));n.nodeEntry.rootElement==null&&(n.nodeEntry.rootElement=document.createElement("li"),n.nodeEntry.rootElement.classList.add(EVUI.Modules.TreeView.Constants.CSS_TreeViewNode),n.nodeEntry.rootElement.classList.add(EVUI.Modules.TreeView.Constants.CSS_TreeViewRootNode),n.nodeEntry.rootElement.setAttribute(EVUI.Modules.TreeView.Constants.Attr_NodeId,n.nodeEntry.nodeId.toString()),n.nodeEntry.rootElement.setAttribute(EVUI.Modules.TreeView.Constants.Attr_Depth,"0"),n.nodeEntry.rootElement.setAttribute(EVUI.Modules.TreeView.Constants.Attr_Ordinal,"0"),n.nodeEntry.bindingElement=document.createElement("div"),n.nodeEntry.bindingElement.classList.add(EVUI.Modules.TreeView.Constants.CSS_NodeInterior),n.nodeEntry.rootElement.append(n.nodeEntry.bindingElement),n.nodeEntry.treeViewEntry.rootListNode.append(n.nodeEntry.rootElement),n.nodeEntry.options.noTopNode===!0&&(n.nodeEntry.treeViewEntry.rootListNode.prepend(n.nodeEntry.rootElement),n.nodeEntry.rootElement.remove()));n.nodeEntry.options.noTopNode===!0&&n.nodeEntry.listElement==null&&(n.nodeEntry.listElement=n.nodeEntry.treeViewEntry.rootListNode);n.nodeEntry.treeViewEntry.treeState=EVUI.Modules.TreeView.TreeViewState.Ready;et(n,function(n){t(n)})},vi=function(n){n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnExpand,key:EVUI.Modules.TreeView.Constants.Event_OnExpand,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.node.onExpand=="function"?n.nodeEntry.node.onExpand.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnExpand,key:EVUI.Modules.TreeView.Constants.Event_OnExpand,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onExpand=="function"?n.nodeEntry.treeViewEntry.treeView.onExpand.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}});ft(n);n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Job,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Job_Expand,key:EVUI.Modules.TreeView.Constants.Job_Expand,handler:function(t){if(i(n)===!1)return t.resolve();ot(n,function(){n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Expanded;t.resolve()})}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnExpanded,key:EVUI.Modules.TreeView.Constants.Event_OnExpanded,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.node.onExpanded=="function"?n.nodeEntry.node.onExpanded.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnExpanded,key:EVUI.Modules.TreeView.Constants.Event_OnExpanded,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onExpanded=="function"?n.nodeEntry.treeViewEntry.treeView.onExpanded.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}})},ot=function(n,t){var i,r;if(n.nodeEntry.listElement==null)return t(!0);i=new EVUI.Modules.Dom.DomHelper(n.nodeEntry.listElement);i.removeClass(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Hidden);i.addClass(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Visible);n.nodeEntry.expanded=!0;r=n.expandCollapseArgs==null?null:n.expandCollapseArgs.transition;r==null&&(r=n.nodeEntry.options.expandTransition);st(n.nodeEntry,r,EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Expanding,i,function(){t(!0)})},yi=function(n,t){var i,r;if(n.nodeEntry.listElement==null)return t(!0);i=new EVUI.Modules.Dom.DomHelper(n.nodeEntry.listElement);i.removeClass(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Visible);i.addClass(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Hidden);n.nodeEntry.expanded=!1;r=n.expandCollapseArgs.transition;r==null&&(r=n.nodeEntry.options.collapseTransition);st(n.nodeEntry,r,EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Collapsing,i,function(){t(!0)})},st=function(n,t,i,u,f){var e,o;if(typeof f!="function"&&(f=function(){}),n==null||u==null)return f(!1);t!=null&&t.css!=null?(t.keyframes!=null&&r.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,t.keyframes),typeof t.css=="string"?(e=t.css.match(/[\:\;]/g),e==null&&e.length===0&&(i=t.css,u.addClass(i))):(o="."+n.treeViewEntry.className+"."+(n.expanded===!0?EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Expanding:EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Collapsing),r.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,o,t.css),u.addClass(i)),n.transitionTimeoutID!==-1&&(u.removeClass(n.transitionSelector),clearTimeout(n.transitionTimeoutID),typeof n.transitionCallback=="function"&&(n.transitionCallback(),n.transitionCallback=null)),n.transitionCallback=function(){n.transitionCallback=null;n.transitionTimeoutID=-1;n.transitionSelector=null;u.removeClass(i);f(!0)},n.transitionSelector=i,n.transitionTimeoutID=setTimeout(function(){typeof n.transitionCallback=="function"&&n.transitionCallback()},t.duration)):(n.transitionTimeoutID!==-1&&(u.removeClass(n.transitionSelector),clearTimeout(n.transitionTimeoutID),typeof n.transitionCallback=="function"&&(n.transitionCallback(),n.transitionCallback=null),n.transitionSelector=null,n.transitionTimeoutID=-1),f(!1))},pi=function(n,t){w(n,function(){t()})},wi=function(){rt!==!0&&(rt=!0,r.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,"."+EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Hidden,{height:"0px",overflow:"hidden"}),r.stylesheetManager.setRules(EVUI.Modules.Styles.Constants.DefaultStyleSheetName,"."+EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Visible,{height:null}))},bi=function(n){n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnCollapse,key:EVUI.Modules.TreeView.Constants.Event_OnCollapse,handler:function(t){if(i(n)!==!1)return n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Collapsing,typeof n.nodeEntry.node.onCollapse=="function"?n.nodeEntry.node.onCollapse.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnCollapse,key:EVUI.Modules.TreeView.Constants.Event_OnCollapse,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onCollapse=="function"?n.nodeEntry.treeViewEntry.treeView.onCollapse.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Job,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Job_Collapse,key:EVUI.Modules.TreeView.Constants.Job_Collapse,handler:function(t){if(i(n)===!1)return t.resolve();yi(n,function(){n.nodeEntry.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Collapsed;t.resolve()})}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.Event,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnCollapsed,key:EVUI.Modules.TreeView.Constants.Event_OnCollapseed,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.node.onCollapseed=="function"?n.nodeEntry.node.onCollapseed.call(this,t):void 0}});n.eventStream.addStep({type:EVUI.Modules.EventStream.EventStreamStepType.GlobalEvent,name:EVUI.Modules.TreeView.Constants.StepPrefix+"."+EVUI.Modules.TreeView.Constants.Event_OnCollapsed,key:EVUI.Modules.TreeView.Constants.Event_OnCollapseed,handler:function(t){if(i(n)!==!1)return typeof n.nodeEntry.treeViewEntry.treeView.onCollapsed=="function"?n.nodeEntry.treeViewEntry.treeView.onCollapsed.call(n.nodeEntry.treeViewEntry.treeView,t):void 0}})},i=function(n){return n.canceled===!0?!1:n.nodeEntry.nodeState===EVUI.Modules.TreeView.TreeViewNodeState.Disposed?!1:!0},ki=function(n){if(n.childListName==null)return null;var t=typeof n.childListName;if(t==="string"||t==="symbol")return n.source!=null?EVUI.Modules.Core.Utils.getValue(n.childListName,n.source):null;if(t==="function")try{return n.childListName(n.source)}catch(i){return EVUI.Modules.Core.Utils.log("Failed to get child list: "),EVUI.Modules.Core.Utils.log(i),null}else return null},di=function(n,t){var f=g(n),e=f.length,u,i;if(at(n),e===0)return n.listElement!=null&&(n.listElement.remove(),n.listElement=null),t(!0);n.listElement==null&&(n.listElement=lt(n,!0),n.rootElement.append(n.listElement));u=EVUI.Modules.Core.Utils.toDictionary(n.childNodeEntries,function(n){return n.nodeId});i=new sr;i.childNodes=u;i.parentNodeEntry=n;n.childListBinding!=null||n.childListBinding!=null&&n.options.expandMode!==EVUI.Modules.TreeView.TreeViewNodeBuildMode.Rebuild?(i.reBinding=!0,n.childListBinding.update({bindingContext:i,bindingSource:n.childListStubs},function(){for(var r=n.childNodeEntries.length,u=0,f=function(){u++;u===r&&t(!0)},i=0;i<r;i++)l(n.childNodeEntries[i],null,function(){f()})})):r.bindingController.bind({element:n.listElement,source:n.childListStubs,htmlContent:"<li "+gi()+' ><div class="'+EVUI.Modules.TreeView.Constants.CSS_NodeInterior+'"><\/div><\/li>',insertionMode:EVUI.Modules.Binding.BindingInsertionMode.Append,bindingContext:i,onBind:function(t){EVUI.Modules.Core.Utils.isArray(t.binding.source)===!0&&(n.childListBinding=t.binding)},onBound:function(n){n.pause();tr(n.context,n.binding,function(){n.resume()})}},function(){t(!0)})},gi=function(){var n=EVUI.Modules.TreeView.Constants.Attr_NodeId+'="{{nodeId}}" ';return n+=EVUI.Modules.TreeView.Constants.Attr_Depth+'="{{depth}}" ',n+(EVUI.Modules.TreeView.Constants.Attr_Ordinal+'="{{ordinal}}" ')},nr=function(n,i){if(n.operation!=null&&n.operation.action===t.Expand&&n.binding!=null&&n.options.expandMode===EVUI.Modules.TreeView.TreeViewNodeBuildMode.Manual)return i(!0);ct(n);n.binding!=null&&n.options.expandMode!==EVUI.Modules.TreeView.TreeViewNodeBuildMode.Rebuild?(n.bindingTemplate!=null&&(typeof n.bindingTemplate=="string"||n.binding.templateName!==n.bindingTemplate.templateName||n.bindingTemplateChanged===!0)&&n.binding.applyBindingTemplate(n.bindingTemplate),n.binding.update(n.source,function(t){return t.bindingCompletionState===EVUI.Modules.Binding.BindingCompletionState.Success||t.bindingCompletionState===EVUI.Modules.Binding.BindingCompletionState.Queued?(ht(n),n.childListBinding!=null&&EVUI.Modules.Core.Utils.isOrphanedNode(n.childListBinding.element)===!0&&n.rootElement.append(n.childListBinding.element),i(!0)):i(!1)})):(n.bindingTemplate.insertionMode=EVUI.Modules.Binding.BindingInsertionMode.Append,r.bindingController.bind(n.bindingTemplate,{bindingSource:n.source,bindingTarget:n.bindingElement},function(t){return n.binding=t,t.bindingCompletionState===EVUI.Modules.Binding.BindingCompletionState.Success||t.bindingCompletionState===EVUI.Modules.Binding.BindingCompletionState.Queued?(ht(n),n.childListBinding!=null&&EVUI.Modules.Core.Utils.isOrphanedNode(n.childListBinding.element)===!0&&n.rootElement.append(n.childListBinding.element),i(!0)):i(!1)}))},ht=function(n){var i,t;if(n!=null&&n.binding!=null){var r=d(n,EVUI.Modules.TreeView.Constants.Attr_ExpandOn),u=d(n,EVUI.Modules.TreeView.Constants.Attr_CollapseOn),f=d(n,EVUI.Modules.TreeView.Constants.Attr_ToggleOn);r===0&&u===0&&f===0&&n.options.autoToggle===!0&&(i=function(){a(n)},n.binding.element.addEventListener("click",i),t=new wt,t.element=n.binding.element,t.eventName="click",t.handler=i,n.eventBindings.push(t))}},d=function(n,t){var u,e,i,y,o,s,r,f;if(t!==EVUI.Modules.TreeView.Constants.Attr_CollapseOn&&t!==EVUI.Modules.TreeView.Constants.Attr_ExpandOn&&t!==EVUI.Modules.TreeView.Constants.Attr_ToggleOn||EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(t)===!0)return 0;var l=new EVUI.Modules.Dom.DomHelper(n.bindingElement,"["+t+"]"),v=0,p=l.elements.length;for(u=0;u<p;u++)if(e=l.elements[u],i=e.getAttribute(t),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i)!==!0)for(i=i.trim().split(/\s+/),y=i.length,o=0;o<y;o++)s=i[u],r=null,t===EVUI.Modules.TreeView.Constants.Attr_CollapseOn?r=function(){c(n)}:t===EVUI.Modules.TreeView.Constants.Attr_ExpandOn?r=function(){h(n)}:t===EVUI.Modules.TreeView.Constants.Attr_ToggleOn&&(r=function(){a(n)}),e.addEventListener(s,r),f=new wt,f.element=e,f.eventName=s,f.handler=r,v=n.eventBindings.push(f);return v},ct=function(n){for(var t,r=n.eventBindings.length,i=0;i<r;i++)t=n.eventBindings[i],t.element.removeEventListener(t.eventName,t.handler);n.eventBindings.splice(0,r)},tr=function(n,t,i){var o,s,h,r,c,e,a,u;if(EVUI.Modules.Core.Utils.isArray(t.source)===!0){if(o=n.nodesToDispose.length,o===0)return i();for(u=0;u<o;u++)s=n.nodesToDispose[u],f(s);return h=n.parentNodeEntry.binding.onBound,n.parentNodeEntry.binding.onBound=null,at(n.parentNodeEntry),n.parentUpdateOnly=!0,n.parentNodeEntry.binding.update(function(){n.parentNodeEntry.binding.onBound=h;i()})}if(r=n.childNodes[t.source.nodeId],r==null)return i();if(n.reBinding==!1)r.rootElement=t.getBoundContent()[0],r.bindingElement=r.rootElement.firstChild,l(r,null,function(t){t===!0&&n.nodesToDispose.push(r);i()});else{for(c=t.getBoundContent(),r.rootElement=c[0],r.bindingElement=r.rootElement.firstChild,r.binding.element=r.bindingElement,e=r.binding.getBoundContent(),a=e!=null?e.length:0,u=0;u<a;u++)r.binding.element.append(e[u]);i()}},lt=function(n,t){var i=null;return i=n.options.listElementType===EVUI.Modules.TreeView.TreeViewListElementType.Ordered?document.createElement("ol"):n.options.listElementType===EVUI.Modules.TreeView.TreeViewListElementType.Unordered?document.createElement("ul"):document.createElement("ul"),i.classList.add(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList),t===!0&&i.classList.add(EVUI.Modules.TreeView.Constants.CSS_ChildNodeList_Hidden),i},g=function(n){var t=ki(n),r=t!=null&&EVUI.Modules.Core.Utils.isArray(t)===!0,o=r===!0?t.length:0,u,i,s,e;if(n.childList==null&&r===!0)n.childList=t,n.childListObserver=new EVUI.Modules.Observers.ArrayObserver(t),n.childListChanged=!0,n.treeViewEntry.nodesChanged=!0;else{if(n.childList!=null&&(r===!1||o===0)){while(n.childNodeEntries.length>0)f(n.childNodeEntries[0]);return n.childList=null,n.childListObserver=null,n.childListChanged=!0,n.treeViewEntry.nodesChanged=!0,n.childNodeEntries}if(n.childList!=null)return ir(n,t)}for(u=EVUI.Modules.Core.Utils.shallowExtend({},n.node,["options"]),i=0;i<o;i++)s=t[i],u.source=s,e=y(u,n.treeViewEntry,n),n.childNodeEntries.push(e),n.treeViewEntry.nodes.push(e);return n.childListChanged=!0,n.treeViewEntry.nodesChanged=!0,n.childNodeEntries},at=function(n){var r,u,i,t;if(n!=null&&(r=n.childNodeEntries.length,r!==0))for(n.childListStubs.splice(0,n.childListStubs.length),u=ur(n),n.depth=u,i=0;i<r;i++)t=n.childNodeEntries[i],t.depth=u+1,t.bindingStub.depth=t.depth,t.bindingStub.nodeId=t.nodeId,t.bindingStub.ordinal=i,n.childListStubs.push(t.bindingStub)},ir=function(n,t){var h=t==null?0:t.length,c=n.childList.length,v=c>h?c:h,u=[],r,w,s,a,b,i;if(t===n.childList)u=n.childListObserver.getChanges(!0);else{for(i=0;i<v;i++)n.childList[i]=t[i];u=n.childListObserver.getChanges();n.childList=t;n.childListObserver=new EVUI.Modules.Observers.ArrayObserver(t);n.childListChanged=!0;n.treeViewEntry.nodesChanged=!0}var e=null,p=u.length,o=[],l=[];for((p>0||c!=h)&&(n.childListChanged=!0,n.treeViewEntry.nodesChanged=!0),i=0;i<p;i++)if(r=u[i],r.changeType===EVUI.Modules.Observers.ArrayChangeType.Added)e==null&&(e=EVUI.Modules.Core.Utils.shallowExtend({},n.node,["options"])),e.source=r.value,w=y(e,n.treeViewEntry,n),o[r.newIndex]=w;else if(r.changeType===EVUI.Modules.Observers.ArrayChangeType.Moved||r.changeType===EVUI.Modules.Observers.ArrayChangeType.Shifted)s=n.childNodeEntries[r.oldIndex],o[r.newIndex]=s;else if(r.changeType===EVUI.Modules.Observers.ArrayChangeType.Removed)l.push(n.childNodeEntries[r.oldIndex]);else{if(newIndex<0)continue;s=n.childNodeEntries[r.oldIndex];o[r.newIndex]=s}for(i=0;i<v;i++)a=o[i],a!=null&&(n.childNodeEntries[i]=a);for(b=l.length,i=0;i<b;i++)f(l[i]);return n.childNodeEntries},f=function(n){var r,u,o,t,i,e;if(n!=null){for(ct(n),n.binding!=null&&n.binding.dispose(),n.rootElement!=null&&n.rootElement.remove(),r=n.childNodeEntries.length,u=!1;r>0;)u=!0,r--,o=n.childNodeEntries[x],f(o);t=n.parentNodeEntry;t!=null?(i=t.childNodeEntries.indexOf(n),i!==-1&&t.childNodeEntries.splice(i,1),i=t.childListStubs.indexOf(n.bindingStub),i!==-1&&t.childListStubs.splice(i,1),t.childListChanged=!0,t.treeViewEntry.nodesChanged=!0):n.treeViewEntry.rootNode=y(n.node,n.treeViewEntry,null);e=n.treeViewEntry.nodes.indexOf(n);e!==-1&&(n.treeViewEntry.nodes.splice(e,1),n.treeViewEntry.nodesChanged=!0);u===!0&&(n.childListBinding!=null&&n.childListBinding.dispose(),n.childList=null,n.childListName=null,n.childListObserver=null,n.childListStubs=[],n.childNodeEntries=[],n.childListBinding=null,nodeEntry.childListChanged=!0,nodeEntry.treeViewEntry.nodesChanged=!0);n.binding=null;n.bindingElement=null;n.bindingStub=null;n.bindingTemplate=null;n.continuations=null;n.listElement=null;n.node=null;n.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.Disposed;n.options=null;n.operation=null;n.source=null;n.treeViewEntry=null;n.childListChanged=!0;n.optionsChanged=!0;n.bindingTemplateChanged=!0}},vt=function(n){n.rootNode!=null&&f(n.rootNode);n.element=null;n.rootListNode!=null&&(n.rootListNode.remove(),n.rootListNode=null);n.nodes.splice(0,n.nodes.length);n.nodesChanged=!0;n.treeState=EVUI.Modules.TreeView.TreeViewState.Disposed},yt=function(n,t){for(var r,u=n.nodes.length,i=0;i<u;i++)if(r=n.nodes[i],r.nodeId===t)return r;return null},y=function(n,t,i){var u=new pt,r,f,l,h,s,a,e,c;if(u.treeViewEntry=t,u.bindingTemplate=n.bindingTemplate,u.childListName=n.childListName,u.node=new EVUI.Modules.TreeView.TreeViewNode(u),u.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.None,u.parentNodeEntry=i,u.source=n.source,r=n.options,f=n.optionsMode,EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f)===!0&&(i!=null&&EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(i.node.optionsMode)===!1&&(f=i.node.optionsMode),EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(f)===!0&&(f=EVUI.Modules.TreeView.TreeViewOptionsShareMode.TreeShared)),f===EVUI.Modules.TreeView.TreeViewOptionsShareMode.Cloned)r==null?r=i!=null&&i.options!=null?EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.TreeView.TreeViewOptions,i.options):EVUI.Modules.TreeView.TreeViewOptions():EVUI.Modules.Core.Utils.instanceOf(r,EVUI.Modules.TreeView.TreeViewOptions)===!1&&(r=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.TreeView.TreeViewOptions,r));else if(f===EVUI.Modules.TreeView.TreeViewOptionsShareMode.TreeShared){if(i==null&&t.rootNode==null)r=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.TreeView.TreeViewOptions,r);else for(l=t.nodes.length,e=0;e<l;e++)if(h=t.nodes[e],h.optionsChanged===!1){r=h.options;break}}else if(f===EVUI.Modules.TreeView.TreeViewOptionsShareMode.PeerNodeShared){if(s=null,i!=null)for(a=i.childNodeEntries.length,e=0;e<a;e++)if(c=i.childNodeEntries[e],c.optionsChanged===!1){s=c;break}r=s!=null?EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.TreeView.TreeViewOptions,s.options):new EVUI.Modules.TreeView.TreeViewOptions}else r=EVUI.Modules.Core.Utils.shallowExtend(new EVUI.Modules.TreeView.TreeViewOptions,r);return r==null&&(r=new EVUI.Modules.TreeView.TreeViewOptions),u.options=r,EVUI.Modules.Core.Utils.shallowExtend(u.node,n,o.concat(["source","options"])),u},e=function(n){if(EVUI.Modules.Core.Utils.isElement(n)===!0||n!=null&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return n;if(typeof n=="string"){var t=new EVUI.Modules.Dom.DomHelper(n);if(t.elements.length>0)return t.elements[0]}return EVUI.Modules.Core.Utils.isDomHelper(n)===!0&&n.elements.length>0?n.elements[0]:document.createDocumentFragment()},rr=function(n,i){var r=new or,u;return r.primaryAction=i.action,u=i.nodeEntry.nodeState,u===EVUI.Modules.TreeView.TreeViewNodeState.None?r.actions.push(i.action):u===EVUI.Modules.TreeView.TreeViewNodeState.Building?i.action===t.Expand?(r.continueAfter=!0,r.actions.push(t.Expand)):i.action==t.Build?(r.cancelCurrent=!0,r.actions.push(t.Build)):(r.continueAfter=!0,r.actions.push(i.action)):u===EVUI.Modules.TreeView.TreeViewNodeState.Collapsed?i.action===t.Expand?r.actions.push(t.Expand):i.action===t.Collapse?r.skip=!0:r.actions.push(i.action):u===EVUI.Modules.TreeView.TreeViewNodeState.Collapsing?i.action===t.Expand?(r.cancelCurrent=!0,r.actions.push(t.Expand)):i.action===t.Collapse?r.skip=!0:i.action===t.Build?(r.continueAfter=!0,r.actions.push(t.Build)):r.actions.push(i.action):u===EVUI.Modules.TreeView.TreeViewNodeState.Expanded?i.action===t.Expand?(r.skip=!0,r.actions.push(t.Expand)):i.action===t.Collapse?r.actions.push(t.Collapse):r.actions.push(i.action):u===EVUI.Modules.TreeView.TreeViewNodeState.Expanding&&(i.action===t.Expand||i.action===t.Build?(r.continueAfter=!0,r.actions.push(t.Build)):i.action===t.Collapse?(r.cancelCurrent=!0,r.actions.push(t.Collapse)):r.actions.push(i.action)),r},ur=function(n){for(var i=0,t=n.parentNodeEntry;t!=null;)i++,t=t.parentNodeEntry;return i},fr=function(n){var i;if(EVUI.Modules.Core.Utils.stringIsNullOrWhitespace(n)===!0)return null;var r=new RegExp(/\s+/g),u=n.trim().replace(r,function(n){return n!=""&&n.trim()===""?"-":""}),t="evui-tree-"+u;for(i in EVUI.Modules.TreeView.Constants)if(EVUI.Modules.TreeView.Constants[i]===t)throw Error(t+" is a reserved TreeView Constant.");return t},er=function(){(r==null||typeof r!="object")&&(r=new EVUI.Modules.TreeView.TreeViewControllerServices);(r.bindingController==null||typeof r.bindingController!="object")&&(r.bindingController=EVUI.Modules.Binding.Binder);(r.stylesheetManager==null||typeof r.stylesheetManager!="object")&&(r.stylesheetManager=EVUI.Modules.Styles.Manager)},or=function(){this.primaryAction=t.None;this.cancelCurrent=!1;this.skip=!1;this.continueAfter=!1;this.actions=[]},sr=function(){this.childNodes={};this.nodesToDispose=[];this.parentNodeEntry=null;this.reBinding=!1},hr=function(){this.treeView=null;this.treeViewId=null;this.rootNode=null;this.nodes=[];this.element=null;this.nodesChanged=!1;this.treeState=EVUI.Modules.TreeView.TreeViewState.None;this.className=null;this.rootListNode=null;this.build=ni;this.expand=ti;this.collapse=ii;this.dispose=ri;this.toggle=ui;this.getValidElement=e;this.bubblingEvents=new EVUI.Modules.EventStream.BubblingEventManager},pt=function(){this.options=new EVUI.Modules.TreeView.TreeViewOptions;this.node=null;this.nodeId=bt++;this.treeViewEntry=null;this.depth=0;this.bindingTemplate=null;this.childListName=null;this.parentNodeEntry=null;this.childNodeEntries=[];this.binding=null;this.rootElement=null;this.bindingElement=null;this.listElement=null;this.childList=null;this.childListObserver=null;this.childListBinding=null;this.childListStubs=[];this.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.None;this.previousCompletedNodeState=EVUI.Modules.TreeView.TreeViewNodeState.None;this.operation=null;this.source=null;this.bindingStub=new cr;this.continuations=[];this.eventBindings=[];this.transitionCallback=null;this.transitionTimeoutID=-1;this.transitionSelector=null;this.bindingTemplateChanged=!1;this.childListChanged=!1;this.optionsChanged=!1;this.expanded=!1;this.expandNode=h;this.collapseNode=c;this.toggleNode=a;this.buildNode=l;this.dispose=f;this.bubblingEvents=new EVUI.Modules.EventStream.BubblingEventManager},cr=function(){this.nodeId=-1;this.depth=-1;this.ordinal=-1},nt=function(){this.operationSession=null;this.callback=null},t={None:"none",Expand:"expand",Collapse:"collapse",Build:"build",Toggle:"toggle",Dispose:"dispose"},tt=function(){this.operationId=kt++;this.isContinuation=!1;this.callback=null;this.action=t.None;this.nodeEntry=null;this.eventStream=null;this.buildArgs=null;this.expandCollapseArgs=null;this.canceled=!1;this.continuation=null;this.callbackStack=[];this.context={}},wt=function(){this.handler=null;this.element=null;this.eventName=null};er();wi()};EVUI.Modules.TreeView.TreeView=function(n){if(n==null)throw Error("Object expected.");var i=this,t=n;this.id=null;Object.defineProperty(this,"id",{get:function(){return t.treeViewId},configurable:!1,enumerable:!0});this.element=null;Object.defineProperty(this,"element",{get:function(){return t.element},set:function(n){if(n==null){t.element=null;return}t.element=t.getValidElement(n)},configurable:!1,enumerable:!0});this.rootListElement=null;Object.defineProperty(this,"rootListElement",{get:function(){return t.rootListElement},configurable:!1,enumerable:!0});this.rootNode=null;Object.defineProperty(this,"rootNode",{get:function(){return t.rootNode!=null?t.rootNode.node:null},configurable:!1,enumerable:!0});this.getNodes=function(){var r=[],u=t.nodes.length,n;for(r.push(i.rootNode),n=0;n<u;n++)r.push(t.nodes[n].node);return r};this.expandNode=function(n,i,r){t.expand(t,n,i,r)};this.collapseNode=function(n,i,r){t.collapse(t,n,i,r)};this.buildNode=function(n,i,r){t.build(t,n,i,r)};this.toggleNode=function(n,i,r){t.toggle(t,n,i,r)};this.expandNodeAsync=function(n,t){return new Promise(function(r){i.expandNode(n,t,function(){r()})})};this.collapseNodeAsync=function(n,t){return new Promise(function(r){i.collapseNode(n,t,function(){r()})})};this.buildNodeAsync=function(n,t){return new Promise(function(r){i.buildNode(n,t,function(){r()})})};this.toggleNodeAsync=function(n,t){return new Promise(function(r){i.toggleNode(n,t,function(){r()})})};this.disposeNode=function(t){n.dispose(n,t)};this.build=function(t,i){n.build(n,n.rootNode,t,i)};this.buildAsync=function(n){return new Promise(function(t){return i.build(n,function(){t()})})};this.dispose=function(){n.dispose(n,null)};this.onExpand=null;this.onExpanded=null;this.onBuild=null;this.onBuildChildren=null;this.onChildrenBuilt=null;this.onBuilt=null;this.onCollapse=null;this.onCollapsed=null;this.addEventListener=function(n,i,r){return EVUI.Modules.Core.Utils.isObject(r)===!1&&(r=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),r.eventType=EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent,t.bubblingEvents.addEventListener(n,i,r)};this.removeEventListener=function(n,i){return t.bubblingEvents.removeEventListener(n,i)}};EVUI.Modules.TreeView.TreeView.prototype.expandAll=function(n,t){var i,e;typeof n=="function"&&(t=n,n=null);typeof t!="function"&&(t=function(){});var r=0,u=this.getNodes(),f=u.length;for(i=0;i<f;i++)e=u[i],e.expand(n,function(){r++;r===f&&t()})};EVUI.Modules.TreeView.TreeView.prototype.expandAllAsync=function(n){return new Promise(function(t){this.expandAll(n,function(){t()})})};EVUI.Modules.TreeView.TreeView.prototype.collapseAll=function(n,t){var i,e;typeof n=="function"&&(t=n,n=null);typeof t!="function"&&(t=function(){});var r=0,u=this.getNodes(),f=u.length;for(i=0;i<f;i++)e=u[i],e.collapse(n,function(){r++;r===f&&t()})};EVUI.Modules.TreeView.TreeView.prototype.collapseAllAsync=function(n){return new Promise(function(t){this.collapseAll(n,function(){t()})})};EVUI.Modules.TreeView.TreeView.prototype.getNode=function(n,t){for(var r,e,i=null,f=this.getNodes(),o=typeof n=="function",s=f.length,u=0;u<s;u++)if(r=f[u],o===!0){if(e=n(r),e===!0)if(t===!0)i==null&&(i=[]),i.push(r);else{i=r;break}}else if(r.id===n)if(t===!0)i==null&&(i=[]),i.push(r);else{i=r;break}return i};EVUI.Modules.TreeView.TreeViewNode=function(n){if(n==null)throw Error("Object expected.");var t=n,i=this;this.id=null;Object.defineProperty(this,"id",{get:function(){return t.nodeId},enumerable:!0,configurable:!1});this.element=null;Object.defineProperty(this,"element",{get:function(){return t.rootElement},enumerable:!0,configurable:!1});this.source=null;Object.defineProperty(this,"source",{get:function(){return t.source},set:function(n){if(n!=null&&typeof n!="object")throw Error("source must be an object.");t.source=n},enumerable:!0,configurable:!1});this.bindingTemplate=null;Object.defineProperty(this,"bindingTemplate",{get:function(){return t.bindingTemplate},set:function(n){t.bindingTemplate=n},configurable:!1,enumerable:!0});this.childListName=null;this.parentNode=null;Object.defineProperty(this,"parentNode",{get:function(){return t.parentNodeEntry==null?null:t.parentNodeEntry.node},configurable:!1,enumerable:!0});this.treeView=null;Object.defineProperty(this,"treeView",{get:function(){return t.treeViewEntry.treeView},configurable:!1,enumerable:!0});this.depth=0;Object.defineProperty(this,"depth",{get:function(){return t.depth},configurable:!1,enumerable:!0});this.options=null;Object.defineProperty(this,"options",{get:function(){return t.options},set:function(n){if(n==null||typeof n!="object")throw Error("options must be an object.");t.options=EVUI.Modules.Core.Utils.instanceOf(n,EVUI.Modules.TreeView.TreeViewOptions)===!1?EVUI.Modules.Core.Utils.shallowExtend(n,new EVUI.Modules.TreeView.TreeViewOptions):n;t.optionsChanged=!0},configurable:!1,enumerable:!0});this.optionsMode=EVUI.Modules.TreeView.TreeViewOptionsShareMode.TreeShared;this.nodeState=EVUI.Modules.TreeView.TreeViewNodeState.None;Object.defineProperty(this,"nodeState",{get:function(){return t.nodeState},configurable:!1,enumerable:!0});this.expanded=!1;Object.defineProperty(this,"expanded",{get:function(){return t.expanded},configurable:!1,enumerable:!0});this.isVisible=!1;Object.defineProperty(this,"isVisible",{get:function(){if(t.rootElement==null)return!1;var n=t.parentNodeEntry;if(n==null)return t.options.noTopNode===!0?!1:!0;while(n!=null){if(n.expanded===!1)return!1;n=n.parentNodeEntry}return!0},configurable:!1,enumerable:!0});this.getChildNodes=function(){for(var i=[],r=t.childNodeEntries.length,n=0;n<r;n++)i.push(t.childNodeEntries[n].node);return i};this.expand=function(n,i){return t.expandNode(t,n,i)};this.expandAsync=function(n){return new Promise(function(t){return i.expand(n,function(){t()})})};this.collapse=function(n,i){return t.collapseNode(t,n,i)};this.collapseAsync=function(n){return new Promise(function(t){i.collapse(n,function(){t()})})};this.build=function(n,i){return t.buildNode(t,n,i)};this.buildAsync=function(n){return new Promise(function(t){i.build(n,function(){t()})})};this.onExpand=null;this.onExpanded=null;this.onBuild=null;this.onBuildChildren=null;this.onChildrenBuilt=null;this.onBuilt=null;this.onCollapse=null;this.onCollapsed=null;this.addEventListener=function(n,i,r){return EVUI.Modules.Core.Utils.isObject(r)===!1&&(r=new EVUI.Modules.EventStream.EventStreamEventListenerOptions),r.eventType=EVUI.Modules.EventStream.EventStreamEventType.GlobalEvent,t.bubblingEvents.addEventListener(n,i,r)};this.removeEventListener=function(n,i){return t.bubblingEvents.removeEventListener(n,i)}};EVUI.Modules.TreeView.TreeViewOptions=function(){this.listElementType=EVUI.Modules.TreeView.TreeViewListElementType.Unordered;this.bindingType=EVUI.Modules.TreeView.TreeViewListBindingType.ListBound;this.expandTransition=null;this.collapseTransition=null;this.lazy=!0;this.expandMode=EVUI.Modules.TreeView.TreeViewNodeBuildMode.Update;this.noTopNode=!1;this.autoToggle=!0};EVUI.Modules.TreeView.AddTreeViewArgs=function(){this.id=null;this.element=null;this.bindingTemplate=null;this.source=null;this.childListName=null;this.options=null;this.optionsMode=EVUI.Modules.TreeView.TreeViewOptionsShareMode.TreeShared;this.onExpand=null;this.onExpanded=null;this.onBuild=null;this.onBuildChildren=null;this.onChildrenBuilt=null;this.onBuilt=null;this.onCollapse=null;this.onCollapsed=null};EVUI.Modules.TreeView.AddTreeViewNodeArgs=function(){this.bindingTemplate=null;this.source=null;this.childListName=null;this.options=null;this.optionsMode=EVUI.Modules.TreeView.TreeViewOptionsShareMode.TreeShared;this.onExpand=null;this.onExpanded=null;this.onBuild=null;this.onBuildChildren=null;this.onChildrenBuilt=null;this.onBuilt=null;this.onCollapse=null;this.onCollapsed=null};EVUI.Modules.TreeView.BuildTreeViewNodeArgs=function(){this.bindingTemplate=null;this.source=null;this.childListName=null;this.buildMode=EVUI.Modules.TreeView.TreeViewNodeBuildMode.Update;this.options=null;this.optionsMode=EVUI.Modules.TreeView.TreeViewOptionsShareMode.TreeShared;this.recursive=!1;this.context={}};EVUI.Modules.TreeView.ExpandCollapseTreeViewNodeArgs=function(){this.recursive=!1;this.transition=null;this.buildArgs=null;this.context={}};EVUI.Modules.TreeView.TreeViewNodeTransition=function(){this.css=null;this.keyframes=null;this.duration=0};EVUI.Modules.TreeView.TreeViewEventArgs=function(n){var t=n;this.treeView=null;Object.defineProperty(this,"treeView",{get:function(){return t.treeViewEntry.treeView},configurable:!1,enumerable:!0});this.node=null;Object.defineProperty(this,"node",{get:function(){return t.node},configurable:!1,enumerable:!0});this.eventName=null;this.eventType=null;this.pause=function(){};this.resume=function(){};this.cancel=function(){};this.stopPropagation=function(){};this.context={}};EVUI.Modules.TreeView.TreeViewControllerServices=function(){this.bindingController=null;this.stylesheetManager=null};EVUI.Modules.TreeView.TreeViewListElementType={Unordered:"ul",Ordered:"ol"};Object.freeze(EVUI.Modules.TreeView.TreeViewListElementType);EVUI.Modules.TreeView.TreeViewListBindingType={ListBound:"bound"};Object.freeze(EVUI.Modules.TreeView.TreeViewListBindingType);EVUI.Modules.TreeView.TreeViewNodeBuildMode={Manual:"manual",Rebuild:"rebuild",Update:"update"};Object.freeze(EVUI.Modules.TreeView.TreeViewNodeBuildMode);EVUI.Modules.TreeView.TreeViewOptionsShareMode={TreeShared:"tree",PeerNodeShared:"peers",Cloned:"cloned"};Object.freeze(EVUI.Modules.TreeView.TreeViewOptionsShareMode);EVUI.Modules.TreeView.TreeViewNodeState={None:"none",Collapsed:"collapsed",Collapsing:"collapsing",Expanded:"expanded",Expanding:"expanding",Building:"building",Disposed:"disposed"};Object.freeze(EVUI.Modules.TreeView.TreeViewNodeState);EVUI.Modules.TreeView.TreeViewState={None:"none",Ready:"ready",Disposed:"disposed"};Object.freeze(EVUI.Modules.TreeView.TreeViewState);EVUI.Modules.TreeView.Manager=null,function(){var n=null,t=EVUI.Modules.TreeView.TreeViewController;Object.defineProperty(EVUI.Modules.TreeView,"Manager",{get:function(){return n==null&&(n=new t),n},configurable:!1,enumerable:!0})}();delete $evui.treeViews;$evui.treeViews=null;Object.defineProperty($evui,"treeViews",{get:function(){return EVUI.Modules.TreeView.Manager}});EVUI.Constructors.TreeView=EVUI.Modules.TreeView.TreeViewController;Object.freeze(EVUI.Modules.TreeView);$evui.addTreeView=function(n,t){return $evui.treeViews.addTreeView(n,t)};$evui.getTreeView=function(n,t){return $evui.treeViews.getTreeView(n,t)};$evui.removeTreeView=function(n,t){return $evui.treeViews.removeTreeView(n,t)};Object.freeze(EVUI.Modules.TreeView)